<!DOCTYPE html>
<html class=" js csstransforms3d csstransitions" lang="en-US"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><script id="twitter-wjs" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/widgets.js"></script><script id="twitcount_plugins" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/twitcount.js"></script><script type="text/javascript" async="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/publishertag.js"></script><script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/ats.js"></script><script type="text/javascript" async="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/c.js"></script><script async="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/wrap.js"></script><script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/cafemedia.js"></script><script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/config.js"></script><script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/beacon.js"></script><script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/gpt.js"></script><script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/prebid.js"></script><script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/form"></script><script type="text/javascript" async="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/analytics.js"></script><script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/track_002"></script><script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/track"></script><script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/show"></script><meta charset="UTF-8"><script type="text/javascript" async="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/client.js"></script><script src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/adthrive.js"></script><script type="text/javascript" async="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/9556588.js"></script><script async="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/ads.js"></script><script type="text/javascript">if(navigator.userAgent.match(/MSIE|Internet Explorer/i)||navigator.userAgent.match(/Trident\/7\..*?rv:11/i)){var href=document.location.href;if(!href.match(/[?&]nowprocket/)){if(href.indexOf("?")==-1){if(href.indexOf("#")==-1){document.location.href=href+"?nowprocket=1"}else{document.location.href=href.replace("#","?nowprocket=1#")}}else{if(href.indexOf("#")==-1){document.location.href=href+"&nowprocket=1"}else{document.location.href=href.replace("#","&nowprocket=1#")}}}}</script><script type="text/javascript">class RocketLazyLoadScripts{constructor(){this.triggerEvents=["keydown","mousedown","mousemove","touchmove","touchstart","touchend","wheel"],this.userEventHandler=this._triggerListener.bind(this),this.touchStartHandler=this._onTouchStart.bind(this),this.touchMoveHandler=this._onTouchMove.bind(this),this.touchEndHandler=this._onTouchEnd.bind(this),this.clickHandler=this._onClick.bind(this),this.interceptedClicks=[],window.addEventListener("pageshow",(e=>{this.persisted=e.persisted})),window.addEventListener("DOMContentLoaded",(()=>{this._preconnect3rdParties()})),this.delayedScripts={normal:[],async:[],defer:[]},this.allJQueries=[]}_addUserInteractionListener(e){document.hidden?e._triggerListener():(this.triggerEvents.forEach((t=>window.addEventListener(t,e.userEventHandler,{passive:!0}))),window.addEventListener("touchstart",e.touchStartHandler,{passive:!0}),window.addEventListener("mousedown",e.touchStartHandler),document.addEventListener("visibilitychange",e.userEventHandler))}_removeUserInteractionListener(){this.triggerEvents.forEach((e=>window.removeEventListener(e,this.userEventHandler,{passive:!0}))),document.removeEventListener("visibilitychange",this.userEventHandler)}_onTouchStart(e){"HTML"!==e.target.tagName&&(window.addEventListener("touchend",this.touchEndHandler),window.addEventListener("mouseup",this.touchEndHandler),window.addEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.addEventListener("mousemove",this.touchMoveHandler),e.target.addEventListener("click",this.clickHandler),this._renameDOMAttribute(e.target,"onclick","rocket-onclick"))}_onTouchMove(e){window.removeEventListener("touchend",this.touchEndHandler),window.removeEventListener("mouseup",this.touchEndHandler),window.removeEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.removeEventListener("mousemove",this.touchMoveHandler),e.target.removeEventListener("click",this.clickHandler),this._renameDOMAttribute(e.target,"rocket-onclick","onclick")}_onTouchEnd(e){window.removeEventListener("touchend",this.touchEndHandler),window.removeEventListener("mouseup",this.touchEndHandler),window.removeEventListener("touchmove",this.touchMoveHandler,{passive:!0}),window.removeEventListener("mousemove",this.touchMoveHandler)}_onClick(e){e.target.removeEventListener("click",this.clickHandler),this._renameDOMAttribute(e.target,"rocket-onclick","onclick"),this.interceptedClicks.push(e),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}_replayClicks(){window.removeEventListener("touchstart",this.touchStartHandler,{passive:!0}),window.removeEventListener("mousedown",this.touchStartHandler),this.interceptedClicks.forEach((e=>{e.target.dispatchEvent(new MouseEvent("click",{view:e.view,bubbles:!0,cancelable:!0}))}))}_renameDOMAttribute(e,t,n){e.hasAttribute&&e.hasAttribute(t)&&(event.target.setAttribute(n,event.target.getAttribute(t)),event.target.removeAttribute(t))}_triggerListener(){this._removeUserInteractionListener(this),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this._loadEverythingNow.bind(this)):this._loadEverythingNow()}_preconnect3rdParties(){let e=[];document.querySelectorAll("script[type=rocketlazyloadscript]").forEach((t=>{if(t.hasAttribute("src")){const n=new URL(t.src).origin;n!==location.origin&&e.push({src:n,crossOrigin:t.crossOrigin||"module"===t.getAttribute("data-rocket-type")})}})),e=[...new Map(e.map((e=>[JSON.stringify(e),e]))).values()],this._batchInjectResourceHints(e,"preconnect")}async _loadEverythingNow(){this.lastBreath=Date.now(),this._delayEventListeners(),this._delayJQueryReady(this),this._handleDocumentWrite(),this._registerAllDelayedScripts(),this._preloadAllScripts(),await this._loadScriptsFromList(this.delayedScripts.normal),await this._loadScriptsFromList(this.delayedScripts.defer),await this._loadScriptsFromList(this.delayedScripts.async);try{await this._triggerDOMContentLoaded(),await this._triggerWindowLoad()}catch(e){}window.dispatchEvent(new Event("rocket-allScriptsLoaded")),this._replayClicks()}_registerAllDelayedScripts(){document.querySelectorAll("script[type=rocketlazyloadscript]").forEach((e=>{e.hasAttribute("src")?e.hasAttribute("async")&&!1!==e.async?this.delayedScripts.async.push(e):e.hasAttribute("defer")&&!1!==e.defer||"module"===e.getAttribute("data-rocket-type")?this.delayedScripts.defer.push(e):this.delayedScripts.normal.push(e):this.delayedScripts.normal.push(e)}))}async _transformScript(e){return await this._littleBreath(),new Promise((t=>{const n=document.createElement("script");[...e.attributes].forEach((e=>{let t=e.nodeName;"type"!==t&&("data-rocket-type"===t&&(t="type"),n.setAttribute(t,e.nodeValue))})),e.hasAttribute("src")?(n.addEventListener("load",t),n.addEventListener("error",t)):(n.text=e.text,t());try{e.parentNode.replaceChild(n,e)}catch(e){t()}}))}async _loadScriptsFromList(e){const t=e.shift();return t?(await this._transformScript(t),this._loadScriptsFromList(e)):Promise.resolve()}_preloadAllScripts(){this._batchInjectResourceHints([...this.delayedScripts.normal,...this.delayedScripts.defer,...this.delayedScripts.async],"preload")}_batchInjectResourceHints(e,t){var n=document.createDocumentFragment();e.forEach((e=>{if(e.src){const i=document.createElement("link");i.href=e.src,i.rel=t,"preconnect"!==t&&(i.as="script"),e.getAttribute&&"module"===e.getAttribute("data-rocket-type")&&(i.crossOrigin=!0),e.crossOrigin&&(i.crossOrigin=e.crossOrigin),n.appendChild(i)}})),document.head.appendChild(n)}_delayEventListeners(){let e={};function t(t,n){!function(t){function n(n){return e[t].eventsToRewrite.indexOf(n)>=0?"rocket-"+n:n}e[t]||(e[t]={originalFunctions:{add:t.addEventListener,remove:t.removeEventListener},eventsToRewrite:[]},t.addEventListener=function(){arguments[0]=n(arguments[0]),e[t].originalFunctions.add.apply(t,arguments)},t.removeEventListener=function(){arguments[0]=n(arguments[0]),e[t].originalFunctions.remove.apply(t,arguments)})}(t),e[t].eventsToRewrite.push(n)}function n(e,t){let n=e[t];Object.defineProperty(e,t,{get:()=>n||function(){},set(i){e["rocket"+t]=n=i}})}t(document,"DOMContentLoaded"),t(window,"DOMContentLoaded"),t(window,"load"),t(window,"pageshow"),t(document,"readystatechange"),n(document,"onreadystatechange"),n(window,"onload"),n(window,"onpageshow")}_delayJQueryReady(e){let t=window.jQuery;Object.defineProperty(window,"jQuery",{get:()=>t,set(n){if(n&&n.fn&&!e.allJQueries.includes(n)){n.fn.ready=n.fn.init.prototype.ready=function(t){e.domReadyFired?t.bind(document)(n):document.addEventListener("rocket-DOMContentLoaded",(()=>t.bind(document)(n)))};const t=n.fn.on;n.fn.on=n.fn.init.prototype.on=function(){if(this[0]===window){function e(e){return e.split(" ").map((e=>"load"===e||0===e.indexOf("load.")?"rocket-jquery-load":e)).join(" ")}"string"==typeof arguments[0]||arguments[0]instanceof String?arguments[0]=e(arguments[0]):"object"==typeof arguments[0]&&Object.keys(arguments[0]).forEach((t=>{delete Object.assign(arguments[0],{[e(t)]:arguments[0][t]})[t]}))}return t.apply(this,arguments),this},e.allJQueries.push(n)}t=n}})}async _triggerDOMContentLoaded(){this.domReadyFired=!0,await this._littleBreath(),document.dispatchEvent(new Event("rocket-DOMContentLoaded")),await this._littleBreath(),window.dispatchEvent(new Event("rocket-DOMContentLoaded")),await this._littleBreath(),document.dispatchEvent(new Event("rocket-readystatechange")),await this._littleBreath(),document.rocketonreadystatechange&&document.rocketonreadystatechange()}async _triggerWindowLoad(){await this._littleBreath(),window.dispatchEvent(new Event("rocket-load")),await this._littleBreath(),window.rocketonload&&window.rocketonload(),await this._littleBreath(),this.allJQueries.forEach((e=>e(window).trigger("rocket-jquery-load"))),await this._littleBreath();const e=new Event("rocket-pageshow");e.persisted=this.persisted,window.dispatchEvent(e),await this._littleBreath(),window.rocketonpageshow&&window.rocketonpageshow({persisted:this.persisted})}_handleDocumentWrite(){const e=new Map;document.write=document.writeln=function(t){const n=document.currentScript,i=document.createRange(),r=n.parentElement;let o=e.get(n);void 0===o&&(o=n.nextSibling,e.set(n,o));const s=document.createDocumentFragment();i.setStart(s,0),s.appendChild(i.createContextualFragment(t)),r.insertBefore(s,o)}}async _littleBreath(){Date.now()-this.lastBreath>45&&(await this._requestAnimFrame(),this.lastBreath=Date.now())}async _requestAnimFrame(){return document.hidden?new Promise((e=>setTimeout(e))):new Promise((e=>requestAnimationFrame(e)))}static run(){const e=new RocketLazyLoadScripts;e._addUserInteractionListener(e)}}RocketLazyLoadScripts.run();</script>

<title>How to Identify and Diagnose GAN Failure Modes</title><link rel="stylesheet" href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/e42b3698dac4529126651f67424228f1.css" media="all" data-minify="1">

<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>
<style>
	.adthrive-ad {
		margin-top: 10px;
		margin-bottom: 10px;
		text-align: center;
		overflow-x: visible;
		clear: both;
		line-height: 0;
	}
	.adthrive-ad.adthrive-sidebar.adthrive-sidebar-9.adthrive-sticky {
top: 3rem
}

.adthrive-content.adthrive-ad-cls {
min-height: 90px !important;
}</style>
<script type="text/javascript">
	window.adthriveCLS = {
		enabledLocations: ['Content', 'Recipe'],
		injectedSlots: [],
		injectedFromPlugin: true,
		branch: '5fc9f28',bucket: 'prod',			};
	window.adthriveCLS.siteAds = {"siteId":"5d4c8ca4693e634b2e5d98cf","siteName":"Machine Learning Mastery","betaTester":false,"targeting":[{"value":"5d4c8ca4693e634b2e5d98cf","key":"siteId"},{"value":"Machine Learning Mastery","key":"siteName"},{"value":"Prime","key":"service"},{"value":"on","key":"bidding"},{"value":["Tech"],"key":"verticals"}],"breakpoints":{"tablet":768,"desktop":1024},"adUnits":[{"sequence":null,"targeting":[{"value":["Content"],"key":"location"}],"devices":["desktop","tablet"],"name":"Content","sticky":false,"location":"Content","dynamic":{"pageSelector":"body.post-template-default","spacing":1.5,"max":9,"lazy":true,"lazyMax":30,"elementSelector":".entry > h3, .entry > h4, .entry > h2","skip":1,"classNames":[],"position":"beforebegin","every":1,"enabled":true},"adSizes":[[468,60],[728,90],[728,250]],"priority":199,"autosize":true},{"sequence":null,"targeting":[{"value":["Content"],"key":"location"}],"devices":["phone"],"name":"Content","sticky":false,"location":"Content","dynamic":{"pageSelector":"body.post-template-default","spacing":1.5,"max":9,"lazy":true,"lazyMax":30,"elementSelector":".entry > h3, .entry > h4, .entry > h2","skip":1,"classNames":[],"position":"beforebegin","every":1,"enabled":true},"adSizes":[[250,250],[300,50],[300,250],[300,300],[320,50],[320,100]],"priority":199,"autosize":true},{"sequence":1,"targeting":[{"value":["Below Post"],"key":"location"}],"devices":["desktop","tablet","phone"],"name":"Below_Post_1","sticky":false,"location":"Below Post","dynamic":{"pageSelector":"","spacing":0,"max":0,"lazy":true,"lazyMax":1,"elementSelector":".crp_related  ","skip":0,"classNames":[],"position":"beforebegin","every":1,"enabled":true},"adSizes":[[728,90],[336,280],[320,50],[468,60],[250,250],[1,1],[320,100],[300,250],[970,250],[728,250]],"priority":99,"autosize":true}],"videoPlayers":{"contextual":{"autoplayCollapsibleEnabled":false,"overrideEmbedLocation":false,"defaultPlayerType":"static"},"videoEmbed":"div","footerSelector":"","players":[{"devices":["desktop","mobile"],"description":"","id":4062751,"title":"Stationary related player - desktop and mobile","type":"stationaryRelated","enabled":false,"playerId":null},{"pageSelector":"","devices":["desktop"],"description":"","elementSelector":"","skip":0,"id":4062752,"position":"afterend","title":"Sticky related player - desktop","type":"stickyRelated","enabled":false,"playerId":null},{"pageSelector":"","devices":["mobile"],"mobileLocation":"top-right","description":"","elementSelector":"","skip":0,"id":4062753,"position":"afterend","title":"Sticky related player - mobile","type":"stickyRelated","enabled":false,"playerId":null},{"pageSelector":"","devices":["desktop"],"description":"","skip":0,"title":"","type":"stickyPlaylist","enabled":false,"footerSelector":"","elementSelector":"","id":4062754,"position":"afterend","saveVideoCloseState":false,"shuffle":true},{"pageSelector":"","devices":["mobile"],"mobileLocation":"top-right","description":"","skip":0,"title":"","type":"stickyPlaylist","enabled":false,"footerSelector":"","elementSelector":"","id":4062755,"position":"afterend","saveVideoCloseState":false,"shuffle":true},{"pageSelector":"","devices":["desktop"],"description":"","elementSelector":"","skip":0,"id":4062756,"position":"afterend","title":"","type":"sekindo","enabled":false},{"pageSelector":"","devices":["mobile"],"description":"","elementSelector":"","skip":0,"id":4062757,"position":"afterend","title":"","type":"sekindo","enabled":false}]},"adTypes":{"nativeMobileRecipe":true,"expandableFooter":false,"nativeDesktopSidebar":true,"nativeDesktopContent":true,"outstreamDesktop":false,"interscroller":false,"miniscroller":true,"nativeDesktopRecipe":true,"outstreamMobile":true,"animatedFooter":true,"nativeMobileContent":true},"adOptions":{"theTradeDesk":true,"verizon":true,"undertone":true,"concert":false,"footerCloseButton":true,"teads":true,"pmp":true,"districtM":true,"thirtyThreeAcross":true,"sharethrough":true,"removeVideoTitleWrapper":false,"pubMatic":true,"roundel":true,"infiniteScroll":false,"yahoossp":true,"sonobi":true,"yieldmo":true,"footerSelector":"","amazonUAM":false,"gamMCMEnabled":true,"gamMCMChildNetworkCode":"22523581566","stickyContainerAds":false,"rubiconMediaMath":true,"rubicon":true,"conversant":false,"deepIntent":true,"openx":true,"mobileHeaderHeight":1,"unruly":true,"mediaGrid":true,"bRealTime":true,"gumgum":true,"comscoreFooter":false,"desktopInterstitial":false,"footerCloseButtonDesktop":true,"isAutoOptimized":false,"comscoreTAL":true,"brightroll":true,"targetaff":false,"tripleLiftMobile":true,"advancePlaylistOptions":{"playlistPlayer":{"enabled":true},"relatedPlayer":{"enabled":true,"applyToFirst":true}},"kargo":true,"liveRampATS":true,"footerCloseButtonMobile":true,"allowSmallerAdSizes":true,"comscore":null,"mobileInterstitial":false,"tripleLift":true,"sensitiveCategories":["conl","gamv"],"liveRamp":true,"mobileInterstitialBlockedPageSelectors":"","adthriveEmailIdentity":true,"nativo":true,"criteo":true,"infiniteScrollOptions":{"selector":"","heightThreshold":0},"clsOptimizedAds":true,"colossus":true,"verticals":["Tech"],"inImage":false,"advancePlaylist":true,"delayLoading":true,"tripleLiftDesktop":false,"inImageZone":null,"appNexus":false,"liveRampId":"","infiniteScrollRefresh":false,"indexExchange":true,"stickyOutstream":{"mobile":{"enabled":false},"desktop":{"enabled":false},"allowForPageWithStickyPlayer":{"enabled":false}}},"video":{"partners":{"roundel":true,"yahoossp":true,"oneVideo":true,"criteo":true,"mediaGrid":true,"gumgum":true,"telaria":true,"colossus":true,"districtM":true,"amazonUAM":true,"kargo":true,"thirtyThreeAcross":true,"stickyOutstream":{"mobile":{"enabled":false},"desktop":{"enabled":false},"blockedPageSelectors":"","allowForPageWithStickyPlayer":{"enabled":false}},"sharethrough":true,"rubicon":true,"appNexus":true,"conversant":false,"tripleLift":true,"openx":true,"pubMatic":true,"spotx":true,"indexExchange":true}},"adDensityLayout":{"mobile":{"adDensity":0.22,"onePerViewport":false},"pageOverrides":[{"mobile":{"adDensity":0.22,"onePerViewport":false},"pageSelector":"body.post-template-default","desktop":{"adDensity":0.22,"onePerViewport":false}}],"desktop":{"adDensity":0.22,"onePerViewport":false}},"adDensityEnabled":true};</script>

<script type="text/javascript">
(function(w, d) {
	w.adthrive = w.adthrive || {};
	w.adthrive.cmd = w.adthrive.cmd || [];
	w.adthrive.plugin = 'adthrive-ads-2.1.1';
	w.adthrive.host = 'ads.adthrive.com';
	w.adthrive.integration = 'plugin';

	var commitParam = (w.adthriveCLS && w.adthriveCLS.bucket !== 'prod' && w.adthriveCLS.branch) ? '&commit=' + w.adthriveCLS.branch : '';

	var s = d.createElement('script');
	s.async = true;
	s.referrerpolicy='no-referrer-when-downgrade';
	s.src = 'https://' + w.adthrive.host + '/sites/5d4c8ca4693e634b2e5d98cf/ads.min.js?referrer=' + w.encodeURIComponent(w.location.href) + commitParam + '&cb=' + (Math.floor(Math.random() * 100) + 1) + '';
	var n = d.getElementsByTagName('script')[0];
	n.parentNode.insertBefore(s, n);
})(window, document);
</script>

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

	<!-- This site is optimized with the Yoast SEO plugin v19.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>How to Identify and Diagnose GAN Failure Modes</title>
	<link rel="canonical" href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a_004.html">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="How to Identify and Diagnose GAN Failure Modes">
	<meta property="og:description" content="How to Identify Unstable Models When Training Generative Adversarial Networks. GANs are difficult to train. The reason they are difficult to train is that both the generator model and the discriminator model are trained simultaneously in a zero sum game. This means that improvements to one model come at the expense of the other model. […]">
	<meta property="og:url" content="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/">
	<meta property="og:site_name" content="Machine Learning Mastery">
	<meta property="article:publisher" content="https://www.facebook.com/MachineLearningMastery/">
	<meta property="article:author" content="https://www.facebook.com/MachineLearningMastery/">
	<meta property="article:published_time" content="2019-07-07T19:00:03+00:00">
	<meta property="article:modified_time" content="2021-01-20T21:04:55+00:00">
	<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2019/07/Line-Plots-of-Loss-and-Accuracy-for-a-Generative-Adversarial-Network-with-Mode-Collapse.png">
	<meta property="og:image:width" content="640">
	<meta property="og:image:height" content="480">
	<meta property="og:image:type" content="image/png">
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Jason Brownlee">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="40 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://machinelearningmastery.com/#organization","name":"Machine Learning Mastery","url":"https://machinelearningmastery.com/","sameAs":["https://www.linkedin.com/company/machine-learning-mastery","https://www.facebook.com/MachineLearningMastery/","https://twitter.com/TeachTheMachine"],"logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://machinelearningmastery.com/#/schema/logo/image/","url":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","width":512,"height":512,"caption":"Machine Learning Mastery"},"image":{"@id":"https://machinelearningmastery.com/#/schema/logo/image/"}},{"@type":"WebSite","@id":"https://machinelearningmastery.com/#website","url":"https://machinelearningmastery.com/","name":"Machine Learning Mastery","description":"Making developers awesome at machine learning","publisher":{"@id":"https://machinelearningmastery.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://machinelearningmastery.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#primaryimage","url":"https://machinelearningmastery.com/wp-content/uploads/2019/07/Line-Plots-of-Loss-and-Accuracy-for-a-Generative-Adversarial-Network-with-Mode-Collapse.png","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2019/07/Line-Plots-of-Loss-and-Accuracy-for-a-Generative-Adversarial-Network-with-Mode-Collapse.png","width":640,"height":480,"caption":"Line Plots of Loss and Accuracy for a Generative Adversarial Network With Mode Collapse"},{"@type":"WebPage","@id":"https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#webpage","url":"https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/","name":"How to Identify and Diagnose GAN Failure Modes","isPartOf":{"@id":"https://machinelearningmastery.com/#website"},"primaryImageOfPage":{"@id":"https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#primaryimage"},"datePublished":"2019-07-07T19:00:03+00:00","dateModified":"2021-01-20T21:04:55+00:00","breadcrumb":{"@id":"https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/"]}]},{"@type":"BreadcrumbList","@id":"https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://machinelearningmastery.com/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://machinelearningmastery.com/blog/"},{"@type":"ListItem","position":3,"name":"How to Identify and Diagnose GAN Failure Modes"}]},{"@type":"Article","@id":"https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#article","isPartOf":{"@id":"https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#webpage"},"author":{"@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8"},"headline":"How to Identify and Diagnose GAN Failure Modes","datePublished":"2019-07-07T19:00:03+00:00","dateModified":"2021-01-20T21:04:55+00:00","mainEntityOfPage":{"@id":"https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#webpage"},"wordCount":4085,"commentCount":105,"publisher":{"@id":"https://machinelearningmastery.com/#organization"},"image":{"@id":"https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#primaryimage"},"thumbnailUrl":"https://machinelearningmastery.com/wp-content/uploads/2019/07/Line-Plots-of-Loss-and-Accuracy-for-a-Generative-Adversarial-Network-with-Mode-Collapse.png","articleSection":["Generative Adversarial Networks"],"inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#respond"]}]},{"@type":"Person","@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8","name":"Jason Brownlee","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://machinelearningmastery.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=96&d=mm&r=g","caption":"Jason Brownlee"},"description":"Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.","sameAs":["http://MachineLearningMastery.com","https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/teachthemachine"],"url":"https://machinelearningmastery.com/author/jasonb/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="https://cdn.jsdelivr.net/">
<link rel="dns-prefetch" href="https://ads.adthrive.com/">
<link rel="dns-prefetch" href="https://www.google-analytics.com/">
<link rel="dns-prefetch" href="https://loadeu.exelator.com/">
<link rel="dns-prefetch" href="https://sync.crwdcntrl.net/">
<link rel="dns-prefetch" href="https://gdpr-wrapper.privacymanager.io/">
<link rel="dns-prefetch" href="https://securepubads.g.doubleclick.net/">
<link rel="dns-prefetch" href="https://gdpr.privacymanager.io/">
<link rel="dns-prefetch" href="https://sb.scorecardresearch.com/">
<link rel="dns-prefetch" href="https://confiant-integrations.global.ssl.fastly.net/">

<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Feed" href="https://feeds.feedburner.com/MachineLearningMastery">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Comments Feed" href="https://machinelearningmastery.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » How to Identify and Diagnose GAN Failure Modes Comments Feed" href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/feed/">
<!-- machinelearningmastery.com is managing ads with Advanced Ads 1.34.0 – https://wpadvancedads.com/ --><!--noptimize--><script id="machi-ready" type="text/javascript">
			window.advanced_ads_ready=function(e,a){a=a||"complete";var d=function(e){return"interactive"===a?"loading"!==e:"complete"===e};d(document.readyState)?e():document.addEventListener("readystatechange",(function(a){d(a.target.readyState)&&e()}),{once:"interactive"===a})},window.advanced_ads_ready_queue=window.advanced_ads_ready_queue||[];		</script>
		<!--/noptimize--><style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<style type="text/css">
@media only screen and (min-width: 980px) {
body.two-col-left-1070 #main-sidebar-container { width: 100%; }
body.two-col-left-1070 #main-sidebar-container #sidebar { width: 28.385%; }
body.two-col-left-1070 #main-sidebar-container #main { width: 68.385%; }
}
</style>




<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>




<!--[if lt IE 9]>
<link href="https://machinelearningmastery.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 1070px; max-width: 1070px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 1070px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/jquery.js" id="jquery-core-js"></script>
<script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/jquery-migrate.js" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.27","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/urvanov_syntax_highlighter.js" id="urvanov_syntax_highlighter_js-js" defer="defer"></script>
<script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/frontend-blocks.js" id="ssb-blocks-front-js-js" defer="defer"></script>
<script type="text/javascript" id="ssb-front-js-js-extra">
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"59b93417d1"};
/* ]]> */
</script>
<script data-minify="1" type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/front.js" id="ssb-front-js-js" defer="defer"></script>
<script type="text/javascript" id="advanced-ads-advanced-js-js-extra">
/* <![CDATA[ */
var advads_options = {"blog_id":"1","privacy":{"enabled":false,"state":"not_needed"}};
/* ]]> */
</script>
<script data-minify="1" type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/32.js" id="advanced-ads-advanced-js-js"></script>
<script type="text/javascript" id="advanced_ads_pro/visitor_conditions-js-extra">
/* <![CDATA[ */
var advanced_ads_pro_visitor_conditions = {"referrer_cookie_name":"advanced_ads_pro_visitor_referrer","referrer_exdays":"365","page_impr_cookie_name":"advanced_ads_page_impressions","page_impr_exdays":"3650"};
/* ]]> */
</script>
<script data-minify="1" type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/770.js" id="advanced_ads_pro/visitor_conditions-js"></script>
<script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/third-party.js" id="third-party-js" defer="defer"></script>
<script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/modernizr.js" id="modernizr-js" defer="defer"></script>
<script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/general.js" id="general-js" defer="defer"></script>

<!-- Adjust the website width -->
<style type="text/css">
	.col-full, #wrapper { max-width: 1070px !important; }
</style>

<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/"><link rel="alternate" type="application/json" href="https://machinelearningmastery.com/wp-json/wp/v2/posts/8173"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://machinelearningmastery.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://machinelearningmastery.com/?p=8173">
<link rel="alternate" type="application/json+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fpractical-guide-to-gan-failure-modes%2F">
<link rel="alternate" type="text/xml+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fpractical-guide-to-gan-failure-modes%2F&amp;format=xml">
<style type="text/css">.crp_title {
    font-size: medium;
}
.group.portfolio-img img {
    height: auto;
    padding: 3px;
	  border: 0px solid #fff;
    background: rgba(255,255,255,.7);
}
.crp_related ul li {
    background: #fff;
    padding: 3px;
    margin: 0 0 1em;
    width: 100%;
    box-sizing: border-box;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-shadow: 0 0px 0px 0 rgb(0 0 0 / 18%);
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    border: 0px solid #fff;
    animation: wzslideup .8s ease-out,wzfadein 1s ease-out;
    -webkit-animation: wzslideup .8s ease-out,wzfadein 1s ease-out;
    -moz-animation: wzslideup .8s ease-out,wzfadein 1s ease;
    font-size: 1em;
    text-align: center;
    display: inline-block;
}</style> <style media="screen">

		.simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
	  margin: ;
	}
		 /*inline margin*/
	
	
	
	
	
	
			 .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
		 margin: ;
	 }

			 /*margin-digbar*/

	
	
	
	
	
	
	
</style>

<!-- Open Graph Meta Tags generated by Simple Social Buttons 4.0.1 -->
<meta property="og:title" content="How to Identify and Diagnose GAN Failure Modes - Machine Learning Mastery">
<meta property="og:description" content="How to Identify Unstable Models When Training Generative Adversarial Networks.
GANs are difficult to train.

The reason they are difficult to train is that both the generator model and the discriminator model are trained simultaneously in a zero sum game. This means that improvements to one model come at the expense of the other model.

The goal of training two models involves finding">
<meta property="og:url" content="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/">
<meta property="og:site_name" content="Machine Learning Mastery">
<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2019/07/Line-Plots-of-Loss-and-Accuracy-for-a-Generative-Adversarial-Network-with-Mode-Collapse.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:description" content="How to Identify Unstable Models When Training Generative Adversarial Networks.
GANs are difficult to train.

The reason they are difficult to train is that both the generator model and the discriminator model are trained simultaneously in a zero sum game. This means that improvements to one model come at the expense of the other model.

The goal of training two models involves finding">
<meta name="twitter:title" content="How to Identify and Diagnose GAN Failure Modes - Machine Learning Mastery">
<meta property="twitter:image" content="https://machinelearningmastery.com/wp-content/uploads/2019/07/Line-Plots-of-Loss-and-Accuracy-for-a-Generative-Adversarial-Network-with-Mode-Collapse.png">
    
    <script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<style id="wplmi-inline-css" type="text/css"> span.wplmi-user-avatar { width: 16px;display: inline-block !important;flex-shrink: 0; } img.wplmi-elementor-avatar { border-radius: 100%;margin-right: 3px; } 

</style>

<link rel="preload" as="font" href="https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/fonts/fontawesome-webfont.woff2?v=4.5.0" crossorigin=""><script type="text/javascript">
		var advadsCfpQueue = [];
		var advadsCfpAd = function( adID ){
			if ( 'undefined' == typeof advadsProCfp ) { advadsCfpQueue.push( adID ) } else { advadsProCfp.addElement( adID ) }
		};
		</script>
		
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 15px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#eeeeee!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#84abc7!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#84abc7;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Custom Favicon -->
<link rel="shortcut icon" href="https://machinelearningmastery.com/wp-content/uploads/2019/09/icon-16x16.png">
<!-- Options Panel Custom CSS -->
<style type="text/css">
#logo img {
   max-width: 100%;
   height: auto;
}
</style>


<!-- Woo Shortcodes CSS -->


<!-- Custom Stylesheet -->


<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21">
<meta name="generator" content="WooFramework 6.2.9">
<script type="text/javascript">
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-44039733-3', 'auto',{'allowLinker': true });
ga('require', 'linker');
ga('linker:autoLink',['samcart.com']);
ga('send', 'pageview');
</script>
<script async="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/analytics.js" type="text/javascript"></script>		<script type="text/javascript">
			if ( typeof advadsGATracking === 'undefined' ) {
				window.advadsGATracking = {
					delayedAds: {},
					deferedAds: {}
				};
			}
		</script>
		<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32">
<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-180x180.png">
<meta name="msapplication-TileImage" content="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-270x270.png">
<script id="cls-disable-ads-5fc9f28" type="text/javascript">var cls_disable_ads=function(t){"use strict";var e=function(t){var e=window.location.href;return t.some((function(t){return new RegExp(t,"i").test(e)}))},i=function(){function t(t){this.adthrive=t,this.all=!1,this.content=!1,this.recipe=!1,this.video=!1,this.locations=new Set,this.reasons=new Set,(this.urlHasEmail(window.location.href)||this.urlHasEmail(window.document.referrer))&&(this.all=!0,this.reasons.add("all_email"));try{this.checkCommandQueue(),null!==document.querySelector(".tag-novideo")&&(this.video=!0,this.locations.add("Video"),this.reasons.add("video_tag"))}catch(t){}}return t.prototype.checkCommandQueue=function(){var t=this;this.adthrive&&this.adthrive.cmd&&this.adthrive.cmd.forEach((function(e){var i=e.toString(),a=t.extractAPICall(i,"disableAds");a&&t.disableAllAds(t.extractPatterns(a));var n=t.extractAPICall(i,"disableContentAds");n&&t.disableContentAds(t.extractPatterns(n));var s=t.extractAPICall(i,"disablePlaylistPlayers");s&&t.disablePlaylistPlayers(t.extractPatterns(s))}))},t.prototype.extractPatterns=function(t){var e=t.match(/\'(.*?)\'/g);if(null!==e)return e.map((function(t){return t.replace(/'/g,"")}))},t.prototype.extractAPICall=function(t,e){var i=new RegExp(e+"\\((.*?)\\)","g"),a=t.match(i);return null!==a&&a[0]},t.prototype.disableAllAds=function(t){t&&!e(t)||(this.all=!0,this.reasons.add("all_page"))},t.prototype.disableContentAds=function(t){t&&!e(t)||(this.content=!0,this.recipe=!0,this.locations.add("Content"),this.locations.add("Recipe"),this.reasons.add("content_plugin"))},t.prototype.disablePlaylistPlayers=function(t){t&&!e(t)||(this.video=!0,this.locations.add("Video"),this.reasons.add("video_page"))},t.prototype.urlHasEmail=function(t){if(!t)return!1;return null!==/([A-Z0-9._%+-]+(@|%(25)*40)[A-Z0-9.-]+\.[A-Z]{2,})/i.exec(t)},t}(),a=window.adthriveCLS;return a&&(a.disableAds=new i(window.adthrive)),t.ClsDisableAds=i,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
</script>		<style type="text/css" id="wp-custom-css">
			.display-posts-listing.image-left .listing-item {
	overflow: hidden; 
	margin-bottom: 30px;
	width: 100%;
}

.display-posts-listing.image-left .image {
	float: left;
	margin: 0 10px 0 0;
}

.display-posts-listing.image-left .attachment-thumbnail {
	height: auto; 
	width: auto; 
	max-width: 50px; 
	max-height: 50px;
	border-radius: 50%;
}

.display-posts-listing.image-left .title {
	display: block;
}

.display-posts-listing.image-left .excerpt-dash { 
	display: none; 
}

.display-posts-listing.image-left {
	margin: 0 0 40px 0;
}		</style>
		<noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player, [data-lazy-src]{display:none !important;}</style></noscript>
	
	
<link href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/urvanov_syntax_highlighter.js" rel="preload" as="script"><link href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/frontend-blocks.js" rel="preload" as="script"><link href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/front.js" rel="preload" as="script"><link href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/third-party.js" rel="preload" as="script"><link href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/modernizr.js" rel="preload" as="script"><link href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/general.js" rel="preload" as="script"><link href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/comment-reply.js" rel="preload" as="script"><link href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/tex-chtml.js" rel="preload" as="script"><link href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/frontend.js" rel="preload" as="script"><link href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/embed.js" rel="preload" as="script"><link href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/embed.js" rel="preload" as="script"><script>!function(t){function e(){var e=!1;try{var o=t.location.search,n="xpdebug";e=e||o.match(new RegExp("[&?]"+n)),e=e||t.localStorage&&null!==t.localStorage.getItem(n),e&&t.localStorage&&console.log("[BABCommon][isDebug] "+n+"="+t.localStorage.getItem(n))}catch(i){}return!!e}function o(){t.__purposefulCheck||s(!1)}function n(){s(!0)}function i(){"undefined"!=typeof t.document.body&&t.document.body?blockAdBlock.check():document.addEventListener("DOMContentLoaded",function(){blockAdBlock.check()},!1)}function a(){function e(){o||(o=!0,blockAdBlock.check())}var o=!1;if("undefined"!=typeof t.document.body&&t.document.body)e(),blockAdBlock._log("coba","bae");else{var n=t.MutationObserver||t.WebKitMutationObserver||t.MozMutationObserver;if(n){var i=new n(function(){t.document.body&&(i.disconnect(),e(),blockAdBlock._log("coba","mo"))});i.observe(document.documentElement,{childList:!0,subtree:!0})}else{var a=function(){"undefined"!=typeof t.document.body&&t.document.body?(e(),blockAdBlock._log("coba","st")):setTimeout(a,5)};a()}document.addEventListener("DOMContentLoaded",function(){e(),blockAdBlock._log("coba","dcl")},!1)}}function c(e){t.__purposefulCheck=null;var i=0,a=function(a){var c=document.createElement("img"),d=!0;setTimeout(function(){if(d){d=!1,t.__purposefulCheck=!1;try{document.body.removeChild(c)}catch(e){}}},1e3),c.onerror=function(){d=!1,c.onerror=null;try{document.body.removeChild(c)}catch(o){}++i>=e.length&&(t.__purposefulCheck=!0,n())},c.onload=function(){d=!1,c.onload=null;try{document.body.removeChild(c)}catch(e){}t.__purposefulCheck=!1,o()},c.style.display="none",c.src=e[a],document.body.appendChild(c)},c=function(){for(var t in e)a(t)};"undefined"!=typeof t.document.body&&t.document.body?c():document.addEventListener("DOMContentLoaded",function(){c()},!1)}var d=function(e){var o=this;o._options={checkOnLoad:!1,resetOnEnd:!1,loopCheckTime:50,loopMaxNumber:5,baitClass:"pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links ad ad01",baitStyle:"width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;",debug:!1},o._var={bait:null,checking:!1,loop:null,loopNumber:0,event:{detected:[],notDetected:[]}},"undefined"!=typeof e&&o.setOption(e);var n=function(){setTimeout(function(){o._options.checkOnLoad===!0&&(o._log("onload->eventCallback","A check loading is launched"),null===o._var.bait&&o._creatBait(),setTimeout(function(){o.check()},1))},1)};"undefined"!=typeof t.addEventListener?t.addEventListener("load",n,!1):t.attachEvent("onload",n)};d.prototype._options=null,d.prototype._var=null,d.prototype._log=function(t,e){this._options.debug&&console.log("[BAB]["+t+"] "+e)},d.prototype.setOption=function(t,e){if("undefined"!=typeof e){var o=t;t={},t[o]=e}for(var n in t)this._options[n]=t[n],this._options.debug&&this._log("setOption",'The option "'+n+'" was assigned to "'+t[n]+'"');return this},d.prototype._creatBait=function(){var e=document.createElement("div");this._options.baitId&&e.setAttribute("id",this._options.baitId),e.setAttribute("class",this._options.baitClass),e.setAttribute("style",this._options.baitStyle),this._var.bait=t.document.body.appendChild(e),this._var.bait.offsetParent,this._var.bait.offsetHeight,this._var.bait.offsetLeft,this._var.bait.offsetTop,this._var.bait.offsetWidth,this._var.bait.clientHeight,this._var.bait.clientWidth,this._log("_creatBait","Bait has been created")},d.prototype._destroyBait=function(){t.document.body.removeChild(this._var.bait),this._var.bait=null,this._log("_destroyBait","Bait has been removed")},d.prototype.check=function(t){if("undefined"==typeof t&&(t=!0),this._options.debug&&this._log("check","An audit was requested "+(t===!0?"with a":"without")+" loop"),this._var.checking===!0)return this._log("check","A check was canceled because there is already an ongoing"),!1;this._var.checking=!0,null===this._var.bait&&this._creatBait();var e=this;return this._var.loopNumber=0,t===!0&&(this._var.loop=setInterval(function(){e._checkBait(t)},this._options.loopCheckTime)),setTimeout(function(){e._checkBait(t)},1),this._log("check","A check is in progress ..."),!0},d.prototype._checkBait=function(e){function o(t,e){e&&(n=!0,i._log("cc",t))}var n=!1,i=this;null===i._var.bait&&i._creatBait(),o("aba",null!==t.document.body.getAttribute("abp")),o("bop",null===i._var.bait.offsetParent),o("boh",0==i._var.bait.offsetHeight),o("bol",0==i._var.bait.offsetLeft),o("bot",0==i._var.bait.offsetTop),o("bow",0==i._var.bait.offsetWidth),o("bch",0==i._var.bait.clientHeight),o("bcw",0==i._var.bait.clientWidth),o("hid","undefined"!=typeof t.getComputedStyle&&!i._isComputedStyleMessedUp(t.document.body)&&i._isComputedStyleMessedUp(i._var.bait)),i._options.debug&&i._log("_checkBait","A check ("+(i._var.loopNumber+1)+"/"+i._options.loopMaxNumber+" ~"+(1+i._var.loopNumber*i._options.loopCheckTime)+"ms) was conducted and detection is "+(n?"positive":"negative")),e===!0&&(i._var.loopNumber++,i._var.loopNumber>=i._options.loopMaxNumber&&i._stopLoop()),n?(i._stopLoop(),i._destroyBait(),i.emitEvent(!0),e===!0&&(i._var.checking=!1)):(null===i._var.loop||e===!1)&&(i._destroyBait(),i.emitEvent(!1),e===!0&&(i._var.checking=!1))},d.prototype._isComputedStyleMessedUp=function(e){var o=t.getComputedStyle(e,null);return o&&("none"===o.getPropertyValue("display")||"hidden"===o.getPropertyValue("visibility"))},d.prototype._stopLoop=function(){clearInterval(this._var.loop),this._var.loop=null,this._var.loopNumber=0,this._log("_stopLoop","A loop has been stopped")},d.prototype.emitEvent=function(t){this._options.debug&&this._log("emitEvent","An event with a "+(t===!0?"positive":"negative")+" detection was called");var e=t===!0?this._var.event.detected:this._var.event.notDetected;for(var o in e)this._options.debug&&this._log("emitEvent","Call function "+(parseInt(o)+1)+"/"+e.length),e.hasOwnProperty(o)&&e[o]();return this._options.resetOnEnd===!0&&this.clearEvent(),this},d.prototype.clearEvent=function(){this._var.event.detected=[],this._var.event.notDetected=[],this._log("clearEvent","The event list has been cleared")},d.prototype.on=function(t,e){return this._var.event[t===!0?"detected":"notDetected"].push(e),this._options.debug&&this._log("on",'A type of event "'+(t===!0?"detected":"notDetected")+'" was added'),this},d.prototype.onDetected=function(t){return this.on(!0,t)},d.prototype.onNotDetected=function(t){return this.on(!1,t)},t.BlockAdBlock=d,"undefined"==typeof t.blockAdBlock&&(t.blockAdBlock=new d({checkOnLoad:!1,resetOnEnd:!0,debug:e()}));var s=function(t){var e=new Date;e.setTime(e.getTime()+3e5),document.cookie="__adblocker="+(t?"true":"false")+"; expires="+e.toUTCString()+"; path=/"};"undefined"==typeof blockAdBlock?n():(blockAdBlock.onDetected(n),blockAdBlock.onNotDetected(o)),t.document.location.host.match(/businessinsider.com/i)?(blockAdBlock.setOption({checkOnLoad:!1,baitClass:"subnav-container ad ad01",baitStyle:"visibility:visible; display:block; width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;"}),i()):t.document.location.host.match(/abril\.com\.br/i)?c(["https://abrilveja.files.wordpress.com/2016/10/300x250_benvino.jpeg","https://px.moatads.com/pixel.gif"]):t.document.location.host.match(/cnbc\.com/i)?(blockAdBlock.setOption({checkOnLoad:!1,baitClass:"sponsored ad ad01"}),i()):t.document.location.host.match(/pcwelt\.de/i)?(blockAdBlock.setOption({checkOnLoad:!1,baitClass:"amazonteaser ad ad01"}),i()):t.document.location.host.match(/therealdeal\.com/i)?a():i()}(window);</script><style type="text/css">.adthrive-ad{clear:both;line-height:0;margin-bottom:10px;margin-top:10px;overflow-x:visible;text-align:center}.jw-flag-small-player #next-stay-container{margin:0}.jw-flag-small-player #next-video,.jw-flag-small-player #stay-video{height:30px;line-height:30px;width:75px}#next-stay-container{bottom:25%;margin:12px;position:absolute;right:0}.video-box-shadow{box-shadow:0 0 10px rgba(0,0,0,.5)}#next-video,#stay-video{background-color:#333;color:#fff;cursor:pointer;height:40px;line-height:40px;margin:10px;opacity:.9;text-align:center;width:100px}#next-video{box-shadow:inset 0 0 0 0 #333;transition:box-shadow 5s linear}#next-stay-container.loaded #next-video{box-shadow:inset 100px 0 0 0 red}.adthrive-ad-cls{align-items:center;display:flex;flex-wrap:wrap;justify-content:center}.adthrive-ad-cls>div,.adthrive-ad-cls>iframe{flex-basis:100%}.adthrive-interstitial{margin-bottom:0;margin-top:0}.adthrive-native-recipe{display:inline-block}.adthrive-stuck.adthrive-sticky.adthrive-header,.adthrive-stuck.adthrive-sticky.adthrive-sidebar{position:fixed;top:0;z-index:9999}.adthrive-stuck.adthrive-header{margin-top:0}.adthrive-sticky.adthrive-footer{background-color:hsla(0,0%,100%,.8);border-top:2px solid hsla(0,0%,88%,.8);bottom:0;left:0;margin:0;overflow:hidden;position:fixed;text-align:center;width:100%;z-index:99999}.adthrive-sticky.adthrive-footer>.adthrive-close{background:#fff;border:1px solid #b2b2b2;border-radius:20px;color:#b2b2b2;cursor:pointer;display:inline-block;font-family:arial,sans-serif;font-size:20px;line-height:20px;padding:0 5px;position:absolute;right:5px;top:5px}.adthrive-device-desktop .adthrive-sticky.adthrive-footer>.adthrive-close{right:10px;top:10px}#_inv_voicefive___{display:none}.adthrive-ccpa-link,.adthrive-footer-message,.adthrive-privacy-preferences{margin-top:5px;text-align:center}.adthrive-ccpa-link,.adthrive-ccpa-link span,.adthrive-footer-message span,.adthrive-privacy-preferences a{color:#b2b2b2;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;font-size:13px}.adthrive-ccpa-link a{cursor:pointer;text-decoration:underline}.adthrive-device-phone .adthrive-footer-message{margin-bottom:60px}.adthrive-footer-message{margin-bottom:100px}.adthrive-footer-message>span{border-top:1px solid #b2b2b2;padding-top:5px;text-transform:uppercase}.adthrive-collapse-player{border-bottom:1px solid #dbdbdb;border-top:1px solid #dbdbdb;margin-left:auto;margin-right:auto;padding:8px!important;width:90%}.adthrive-player-position.adthrive-collapse-float{position:fixed;width:300px;z-index:2147483644}h3.adthrive-player-title{margin:10px 0}.adthrive-player-position.adthrive-collapse-float.adthrive-collapse-right{right:5px;top:0}.adthrive-player-position.adthrive-collapse-float.adthrive-collapse-bottom-right{bottom:100px;right:5px}.adthrive-player-position.adthrive-collapse-float.adthrive-collapse-bottom-left{bottom:100px;left:5px}.adthrive-player-position.adthrive-collapse-float>.adthrive-player-title{display:none}.adthrive-player-position.adthrive-collapse-sticky{padding-bottom:20px;padding-top:20px;position:fixed;z-index:9999}.adthrive-player-position.adthrive-collapse-sticky>.adthrive-player-title{display:none}.adthrive-player-position.adthrive-collapse-mobile{position:fixed;width:300px;z-index:99998}.adthrive-collapse-mobile-background{background-color:#000;left:0;position:fixed;top:0;z-index:99990}.adthrive-top-collapse-close{left:-30px;position:fixed;top:5px;z-index:1}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-medium,.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-small{width:272px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center{left:50%;padding-bottom:5px;padding-top:5px;top:0!important;transform:translateX(-50%)}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-right{right:10px;top:26px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-left{left:5px;top:26px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-bottom-left{bottom:52px;left:5px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-bottom-right{bottom:52px;right:10px}.adthrive-player-position.adthrive-collapse-mobile>.adthrive-player-title{display:none}.adthrive-sekindo-mobile-center{display:flex;flex-direction:row;justify-content:center;text-align:center}.adthrive-wrapper-close{align-items:center;color:#fff;font-size:36px;height:36px;justify-content:center;margin-left:auto;margin-right:0;min-width:36px}.adthrive-wrapper-float-close{cursor:pointer;display:none;float:right;margin-bottom:5px}.adthrive-wrapper-bar{background-color:#595959;border-top-left-radius:5px;border-top-right-radius:5px;display:none;font-family:Arial,Helvetica,sans-serif;height:36px}.adthrive-video-title{color:#fff;font-size:13px;font-weight:700;text-decoration:none}.adthrive-wrapper-title-wrapper{align-items:center;display:inline-flex;justify-content:center;margin-left:10px;margin-right:10px;min-width:0}.adthrive-video-text-cutoff{color:#fff;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.adthrive-wrapper-title-wrapper>a>svg,.adthrive-wrapper-title-wrapper>div>svg{fill:#fff;margin-right:5px;vertical-align:middle}.adthrive-wrapper-title-wrapper>a{text-decoration:none}.adthrive-sticky-outstream{display:none;overflow:hidden;padding-top:20px;position:fixed;z-index:2147483644}.adthrive-instream-close{pointer-events:all}.adthrive-instream-close.adthrive-float-left{float:left}.adthrive-top-left-outer{height:78px;left:-30px;position:absolute;top:-55px;width:78px}.adthrive-top-left-outer>svg{bottom:30px;left:30px;position:absolute}.adthrive-top-left-inner{position:absolute;top:0}.adthrive-top-left-inner-wrapper.adthrive-wrapper-float-close,.adthrive-top-left-inner.adthrive-wrapper-float-close{background:rgba(0,0,0,.5);color:#fff;padding:2px;pointer-events:none;width:100%;z-index:99}.adthrive-top-left-inner-wrapper.adthrive-wrapper-float-close{position:absolute;top:36px}.adthrive-sticky-outstream>.adthrive-wrapper-float-close{position:absolute;right:1px;top:32px}.adthrive-sticky-outstream>.adthrive-wrapper-float-close.adthrive-wrapper-close-outside-left{left:2px}.adthrive-wrapper-close-bkgd-50>#adthrive-sticky-outstream-close{padding:2px 0 0 2px;pointer-events:all}.adthrive-sticky-outstream>.adthrive-wrapper-float-close.adthrive-wrapper-close-bkgd-50{background:rgba(0,0,0,.5);color:#fff;left:0;padding:2px;pointer-events:none;top:52px}.adthrive-sticky-outstream.adthrive-sticky-outstream-mobile{bottom:52px;right:10px}.adthrive-sticky-outstream.adthrive-sticky-outstream-desktop{bottom:100px;right:5px}.adthrive-sticky-outstream.adthrive-sticky-outstream-active{display:block}.adthrive-video-stickyoutstream div:first-of-type{margin:-1px}</style><style type="text/css">
  /* === Form-Specific Styles === */
  /* stylelint-disable */

  #drip-2211 .drip-content,
  #drip-2211 .drip-header {
    background: rgb(116,174,203) !important;
    background: rgba(116,174,203,0.90) !important;
  }

  #drip-2211 .drip-content h3 {
    color: #333333 !important;
    font-size: 21px !important;
  }

  #drip-2211 .drip-submit-button {
    background-color: #333333 !important;
    font-size: 12px !important;
  }

  #drip-2211 .drip-submit-button:hover {
    background-color: #191919 !important;
  }

  #drip-2211 .drip-submit-button:active {
    background-color: #000000 !important;
  }

  #drip-2211 .drip-submit-button:disabled {
    background-color: #808080 !important;
  }

  #drip-2211 dl dt,
  #drip-2211 .drip-content .drip-description,
  #drip-2211 .drip-content .classic--checkbox,
  #drip-2211 .drip-errors {
    font-size: 13px !important;
  }

  #drip-2211 .drip-text-field,
  #drip-2211 .drip-radio-buttons,
  #drip-2211 .drip-dropdown-select {
    font-size: 14px !important;
  }

  /* === Reset styles === */

  .drip-tab h1,
  .drip-tab h2,
  .drip-tab h3,
  .drip-tab dl,
  .drip-tab dt,
  .drip-tab dd,
  .drip-tab p,
  .drip-tab a,
  .drip-tab .drip-text-field,
  .drip-tab .drip-radio-buttons,
  .drip-tab .drip-text-field:focus,
  .drip-tab .drip-submit-button {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    float: none;
    width: auto;
    background-image: none;
    letter-spacing: 0;
    -webkit-box-shadow: none;
       -moz-box-shadow: none;
            box-shadow: none;
    -webkit-text-shadow: none !important;
       -moz-text-shadow: none !important;
            text-shadow: none !important;
  }

  .drip-tab a {
    text-decoration: none;
  }

  .drip-tab :focus {
    outline: 0;
  }

  /* === Clearfix === */

  .drip-clearfix:after {
    visibility: hidden;
    display: block;
    font-size: 0;
    content: " ";
    clear: both;
    height: 0;
  }
  * html .drip-clearfix             { zoom: 1; } /* IE6 */
  *:first-child+html .drip-clearfix { zoom: 1; } /* IE7 */

  /* === Main Container === */

  .drip-tab-container * {
    box-sizing: content-box;
  }

  /* === Content === */

  .drip-tab .drip-content {
    margin: 0;
    padding: 5px;
    width: 330px;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
       -moz-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
            box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  }

  .drip-tab.bottom .drip-content {
    bottom: -800px;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom.left .drip-content {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-content {
    right: 40px;
  }

  .drip-tab.image-left .drip-content,
  .drip-tab.image-right .drip-content {
    width: 510px;
  }

  .drip-tab.side .drip-content {
    top: 10%;
  }

  .drip-tab.side.right .drip-content {
    right: -550px;
    -webkit-border-radius: 8px 0 0 8px;
       -moz-border-radius: 8px 0 0 8px;
            border-radius: 8px 0 0 8px;
    -webkit-transition: right 200ms ease-in;
       -moz-transition: right 200ms ease-in;
         -o-transition: right 200ms ease-in;
            transition: right 200ms ease-in;
  }

  .drip-tab.side.left .drip-content {
    left: -550px;
    -webkit-border-radius: 0 8px 8px 0;
       -moz-border-radius: 0 8px 8px 0;
            border-radius: 0 8px 8px 0;
    -webkit-transition: left 200ms ease-in;
       -moz-transition: left 200ms ease-in;
         -o-transition: left 200ms ease-in;
            transition: left 200ms ease-in;
  }

  .drip-tab.mobile .drip-content {
    width: 100% !important;
    bottom: -800px;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.drip-scrollable .drip-content {
    overflow-y: scroll;
  }

  /* === Header === */

  .drip-tab .drip-header {
    margin: 0;
    padding: 0;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
       -moz-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
            box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
  }

  .drip-tab.bottom .drip-header {
    width: 330px;
    bottom: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom .drip-header.drip-hidden {
    bottom: -800px;
  }

  .drip-tab.bottom.left .drip-header {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-header {
    right: 40px;
  }

  .drip-tab.bottom.image-left .drip-header,
  .drip-tab.bottom.image-right .drip-header {
    width: 510px;
  }

  .drip-tab.side .drip-header {
    width: 330px;
    top: 10%;
  }

  .drip-tab.side.right .drip-header {
    right: -100px;
    -webkit-transition: right 400ms ease-in;
       -moz-transition: right 400ms ease-in;
         -o-transition: right 400ms ease-in;
            transition: right 400ms ease-in;
    -webkit-transform: rotate(-90deg) !important;
       -moz-transform: rotate(-90deg) !important;
        -ms-transform: rotate(-90deg) !important;
         -o-transform: rotate(-90deg) !important;
            transform: rotate(-90deg) !important;
    -webkit-transform-origin: right center;
       -moz-transform-origin: right center;
         -o-transform-origin: right center;
            transform-origin: right center;
  }

  .drip-tab.side.right .drip-header.drip-hidden {
    right: -100px;
  }

  .drip-tab.side.left .drip-header {
    left: -100px;
    -webkit-transition: left 400ms ease-in;
       -moz-transition: left 400ms ease-in;
         -o-transition: left 400ms ease-in;
            transition: left 400ms ease-in;
    -webkit-transform: rotate(90deg) !important;
       -moz-transform: rotate(90deg) !important;
        -ms-transform: rotate(90deg) !important;
         -o-transform: rotate(90deg) !important;
            transform: rotate(90deg) !important;
    -webkit-transform-origin: left center;
       -moz-transform-origin: left center;
         -o-transform-origin: left center;
            transform-origin: left center;
  }

  .drip-tab.side.left .drip-header.drip-hidden {
    left: -100px;
  }

  .drip-tab.mobile .drip-header {
    width: 100% !important;
    bottom: 0;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.mobile .drip-header.drip-hidden {
    bottom: -300px;
  }

  /* === Header Toggle === */

  .drip-tab .drip-toggle {
    display: block;
    text-decoration: none;
    padding: 10px 50px 10px 20px; /* extra padding for the arrow */
  }

  /* === Teaser === */

  .drip-tab .drip-header h2 {
    display: block;
    margin: 0 !important;
    padding: 0 !important;
    border: 0 !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #fff !important;
    clear: none !important;
    letter-spacing: 0 !important;
    width: auto !important;
  }

  /* === Arrows === */

  .drip-tab .drip-header span.drip-arrow {
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    top: 17px;
    right: 32px;
  }

  /* === Panel === */

  .drip-tab .drip-content > div.drip-panel {
    padding: 15px 15px 12px;
    background-color: #fff;
    -webkit-border-radius: 6px;
       -moz-border-radius: 6px;
            border-radius: 6px;
  }

  /* === Content Headings & Paragraphs === */

  .drip-tab .drip-content h3 {
    display: block;
    margin: 0 20px 0 0 !important;
    padding: 0 0 15px 0 !important;
    line-height: 1.4 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #4477bd !important;
    clear: none !important;
  }

  .drip-tab .drip-content .drip-description {
    margin: 0;
    padding: 0 0 20px 0;
    line-height: 1.6;
    text-align: left;
  }

  .drip-tab.image-left .drip-content .drip-description {
    margin-left: 170px;
  }

  .drip-tab.image-right .drip-content .drip-description {
    margin-right: 170px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content .drip-description {
      margin-left: 0; /* 120px; */
    }

    .drip-tab.image-right .drip-content .drip-description {
      margin-right: 0; /* 120px; */
    }
  }

  .drip-tab .drip-content .drip-description a {
    text-decoration: underline;
  }

  .drip-tab .drip-content .drip-description em {
    font-style: italic;
  }

  .drip-tab .drip-content .drip-description ul,
  .drip-tab .drip-content .drip-description ol {
    list-style-position: outside;
    margin: 8px 0 8px 30px;
  }

  .drip-tab .drip-content .drip-description ul li
  .drip-tab .drip-content .drip-description ol li {
    padding: 0;
  }

  .drip-tab .drip-content img.drip-image {
    margin-bottom: 20px;
  }

  .drip-tab.image-left .drip-content img.drip-image {
    float: left;
    width: 150px;
  }

  .drip-tab.image-right .drip-content img.drip-image {
    float: right;
    width: 150px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content img.drip-image {
      margin-right: 20px;
      width: 100px;
    }

    .drip-tab.image-right .drip-content img.drip-image {
      margin-left: 20px;
      width: 100px;
    }
  }

  .drip-tab .drip-content a.drip-close {
    font-family: Arial, Helvetica, sans-serif;
    margin: -1px 0 0 0;
    float: right;
    font-size: 28px;
    line-height: 15px;
    font-weight: normal;
    color: #333;
    opacity: 0.4;
  }

  .drip-tab .drip-content a.drip-close:hover {
    text-decoration: none;
    cursor: pointer;
    opacity: 0.6;
  }

  /* === Content Subscribe Form === */

  .drip-tab form {
    margin: 0 !important;
    padding: 0 !important;
  }

  .drip-tab dl {
    display: block;
    margin: 0;
    padding: 0;
  }

  .drip-tab dl dt {
    display: block;
    padding: 0 0 5px 0;
    font-weight: bold;
  }

  .drip-tab dl.no-labels dt.label-for-type-text,
  .drip-tab dl.no-labels dt.label-for-type-dropdown,
  .drip-tab dl.no-labels dt.label-for-type-email {
    display: none;
  }

  .drip-tab dl dd {
    display: block;
    padding: 0 0 10px 0;
  }

  .drip-lightbox input {
    box-sizing: border-box;
  }

  .drip-tab .drip-date-field,
  .drip-tab .drip-text-field {
    margin: 0 !important;
    height: 34px !important;
    width: 100% !important;
    color: #333 !important;
    background-color: #fff !important;
    border: 1px solid #c4c4c4 !important;
    -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
       -moz-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
            box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
    -webkit-box-sizing: border-box !important;
       -moz-box-sizing: border-box !important;
        -ms-box-sizing: border-box !important;
            box-sizing: border-box !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
  }

  .drip-tab .drip-text-field,
  .drip-tab .drip-dropdown-select select {
    padding: 6px !important;
  }

  .drip-tab .drip-text-field::-webkit-input-placeholder { /* WebKit browsers */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field::-moz-placeholder { /* Mozilla Firefox 19+ */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-ms-input-placeholder { /* Internet Explorer 10+ */
    color: #999999 !important;
  }

  .drip-tab .drip-text-field:focus {
    border-color: #a4a4a4 !important;
    outline: 0;
    background-image: none;
    background-color: #fff !important;
  }

  .drip-tab.mobile .drip-text-field {
    font-size: 16px;
  }

  .drip-tab .drip-errors:not(:empty) {
    padding: 5px 0 0 0;
    font-weight: normal;
    color: red;
  }

  /* RADIOS */

  .drip-tab .drip-radio-buttons,
  .drip-tab .drip-radio-buttons * {
    box-sizing: border-box;
  }
  .drip-tab .drip-radio-buttons h4 {
    font-family: inherit;
    font-weight: bold;
    font-size: 15px;
    margin: 0 0 3px;
    padding: 0;
  }

  .drip-tab .drip-radio-button {
    width: 100%;
    display: block;
    position: relative;
    margin-bottom: 6px;
  }

  .drip-tab .drip-radio-button input[type="radio"] {
    height: 0;
    width: 0;
    opacity: 0;
    position: absolute;
    top: 0;
    left: 0;
    display: inline-block;
    border: none;
    padding: 0;
    margin: 0;
  }

  .drip-tab .drip-radio-button label {
    font-size: 15px;
    padding-left: 30px;
    color: #262626;
    white-space: normal;
    word-break: normal;
    cursor: pointer;
  }

  .drip-tab .drip-radio-button label:before {
    content: "";
    display: block;
    background: #f5f5f5;
    width: 18px;
    height: 18px;
    position: absolute;
    top: 50%;
    left: 0;
    transform: translateY(-50%);
    border-radius: 9px;
    border: 1px solid #cccccc;
    box-sizing: border-box;
    padding: 1px;
    transition: background 300ms ease-out, border-color 300ms, border-width 300ms ease-in;
  }
  .drip-tab .drip-radio-button label:hover:before {
    border-color: #000000;
  }

  .drip-tab .drip-radio-button input[type="radio"]:checked ~ label:before {
    background-color: #ffffff;
    border: 5px solid #000000;
  }

  /* DROPDOWNS */

  /* stylelint-disable */

.drip-tab .drip-dropdown-select h4 {
  font-family: inherit;
  font-weight: bold;
  font-size: 15px;
  margin: 0 0 3px;
  padding: 0;
}

.drip-tab .drip-dropdown-select select {
  display: block;
  box-shadow: none;
  position: relative;
  border: 1px solid #A8ACB9;
  outline: none;
  border-radius: 3px;
  line-height: inherit;
  font-family: inherit;
  color: #262626;
  transition: border-color 300ms;
  width: 100%;
  max-width: 100%; /* useful when width is set to anything other than 100% */
  box-sizing: border-box;

  -moz-appearance: none;
  -webkit-appearance: none;
  appearance: none;
  background-color: #fff;
  /* note: bg image below uses 2 urls. The first is an svg data uri for the arrow
    icon, and the second is the gradient. for the icon, if you want to change the
    color, be sure to use `%23` instead of `#`, since it's a url. You can also
    swap in a different svg icon or an external image reference
  */
  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23262626%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'),
    linear-gradient(to bottom, #ffffff 0%, #ffffff 100%);
  background-repeat: no-repeat, repeat;
  /* arrow icon position (1em from the right, 50% vertical) , then gradient position*/
  background-position: right 12px top 50%, 0 0;
  /* icon size, then gradient */
  background-size: 12px auto, 100%;
}

/* Hide arrow icon in IE browsers */
.drip-tab .drip-dropdown-select select::-ms-expand {
  display: none;
}

/* Hover style */
.drip-tab .drip-dropdown-select select:hover {
  border-color: #888;
}

/* Focus style */
.drip-tab .drip-dropdown-select select:focus {
  border-color: #A8ACB9;
  /* It'd be nice to use -webkit-focus-ring-color here but it doesn't work on box-shadow */
  /* box-shadow: 0 0 1px 3px rgba(59, 153, 252, .7);
  box-shadow: 0 0 0 3px -moz-mac-focusring;
  color: #222; */
  outline: none;
}

/* Set options to normal weight */
.drip-tab .drip-dropdown-select select option {
  font-weight:normal;
}

/* Support for rtl text, explicit support for Arabic and Hebrew */
*[dir="rtl"] .drip-tab .drip-dropdown-select select,
:root:lang(ar) .drip-tab .drip-dropdown-select select,
:root:lang(iw) .drip-tab .drip-dropdown-select select {
  background-position: left 12px top 50%, 0 0;
  padding: .6em .8em .5em 1.4em;
}

/* Disabled styles */
.drip-tab .drip-dropdown-select select:disabled,
.drip-tab .drip-dropdown-select select[aria-disabled=true] {
  color: graytext;
  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22graytext%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'),
    linear-gradient(to bottom, #ffffff 0%,#e5e5e5 100%);
}
.drip-tab .drip-dropdown-select select:disabled:hover,
.drip-tab .drip-dropdown-select select[aria-disabled=true] {
  border-color: #aaa;
}

/* stylelint-enable */


  /* SUBMIT BUTTON */

  .drip-tab .drip-submit-button {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
    padding: 3px 12px !important;
    color: #ffffff !important;
    font-weight: bold !important;
    line-height: 1.6 !important;
    border: 0 !important;
    -webkit-border-radius: 15px !important;
       -moz-border-radius: 15px !important;
            border-radius: 15px !important;
    cursor: pointer !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
    height: auto;
  }

  .drip-tab .drip-submit-button:hover {
    background-image: none !important;
  }

  .drip-tab .drip-submit-button:active {
    background-image: none !important;
  }

  /* checkbox */
  .drip-tab .classic--checkbox.hidden {
    margin-bottom: -8px;
    display: none;
  }

  .drip-tab .classic--checkbox input[type="checkbox"] {
    display: inline-block;
    width: auto;
  }

  /* telephone input */
  /* stylelint-disable */

.drip-tab .iti + .zenput--checkbox {
  margin-top: 10px;
}

.drip-tab .iti {
  position: relative;
  display: block;
}

.drip-tab .iti * {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
}

.drip-tab .iti__hide {
  display: none;
}

.drip-tab .iti__v-hide {
  visibility: hidden;
}

.drip-tab .iti input,
.drip-tab .iti input[type=text],
.drip-tab .iti input[type=tel] {
  position: relative;
  z-index: 0;
  width: 100%;
  padding: 0 0 0 36px;
  margin: 0 !important;
}

  .drip-tab .iti input,
  .drip-tab .iti input[type=text],
  .drip-tab .iti input[type=tel] {
    height: 34px;
    border: 1px solid #c4c4c4 !important;
    border-radius: 4px !important;
    box-shadow: inset 0 0 3px rgba(0, 0, 0, 0.18) !important;
  }

.drip-tab .iti__flag-container {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  padding: 1px;
}

.drip-tab .iti__selected-flag {
  z-index: 1;
  position: relative;
  display: flex;
  align-items: center;
  height: 100%;
  padding: 0 6px 0 8px;
}

.drip-tab .iti__arrow {
  margin-left: 6px;
  width: 0;
  height: 0;
  border-left: 3px solid transparent;
  border-right: 3px solid transparent;
  border-top: 4px solid #555;
}

.drip-tab .iti__arrow--up {
  border-top: none;
  border-bottom: 4px solid #555;
}

.drip-tab .iti__country-list {
  position: absolute;
  z-index: 2;
  list-style: none;
  text-align: left;
  padding: 0;
  margin: 0 0 0 -1px;
  box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.2);
  background-color: white;
  border: 1px solid #CCC;
  white-space: nowrap;
  max-height: 200px;
  width: 320px;
  overflow-y: scroll;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}

.drip-tab .iti__country-list--dropup {
  bottom: 100%;
  margin-bottom: -1px;
}

@media (max-width: 500px) {
  .drip-tab .iti__country-list {
    white-space: normal;
  }
}

.drip-tab .iti__flag-box {
  display: inline-block;
  width: 20px;
}

.drip-tab .iti__divider {
  padding-bottom: 5px;
  margin-bottom: 5px;
  border-bottom: 1px solid #CCC;
}

.drip-tab .iti__country {
  padding: 5px 10px;
  outline: none;
}

.drip-tab .iti__dial-code {
  color: #999;
}

.drip-tab .iti__country.iti__highlight {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti__flag-box,
.drip-tab .iti__country-name,
.drip-tab .iti__dial-code {
  vertical-align: middle;
}

.drip-tab .iti__flag-box,
.drip-tab .iti__country-name {
  margin-right: 6px;
}

.drip-tab .iti--allow-dropdown input,
.drip-tab .iti--allow-dropdown input[type=text],
.drip-tab .iti--allow-dropdown input[type=tel],
.drip-tab .iti--separate-dial-code input,
.drip-tab .iti--separate-dial-code input[type=text],
.drip-tab .iti--separate-dial-code input[type=tel] {
  padding-right: 6px;
  padding-left: 52px;
  margin-left: 0;
}

.drip-tab .iti--allow-dropdown .iti__flag-container,
.drip-tab .iti--separate-dial-code .iti__flag-container {
  right: auto;
  left: 0;
}

.drip-tab .iti--allow-dropdown .iti__flag-container:hover {
  cursor: pointer;
}

.drip-tab .iti--allow-dropdown .iti__flag-container:hover .iti__selected-flag {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti--allow-dropdown input[disabled]+.iti__flag-container:hover,
.drip-tab .iti--allow-dropdown input[readonly]+.iti__flag-container:hover {
  cursor: default;
}

.drip-tab .iti--allow-dropdown input[disabled]+.iti__flag-container:hover .iti__selected-flag,
.drip-tab .iti--allow-dropdown input[readonly]+.iti__flag-container:hover .iti__selected-flag {
  background-color: transparent;
}

.drip-tab .iti--separate-dial-code .iti__selected-flag {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti--separate-dial-code .iti__selected-dial-code {
  margin-left: 6px;
}

.drip-tab .iti--container {
  position: absolute;
  top: -1000px;
  left: -1000px;
  z-index: 1060;
  padding: 1px;
}

.drip-tab .iti--container:hover {
  cursor: pointer;
}

.iti-mobile .drip-tab  .iti--container {
  top: 30px;
  bottom: 30px;
  left: 30px;
  right: 30px;
  position: fixed;
}

.iti-mobile .drip-tab .iti__country-list {
  max-height: 100%;
  width: 100%;
}

.iti-mobile .drip-tab .iti__country {
  padding: 10px 10px;
  line-height: 1.5em;
}

.drip-tab .sms-subtext {
  margin-top: .75em;
  font-size: .75em;
  line-height: 1.4;
  display: inline-block;
}

.drip-tab .sms-subtext a {
  text-decoration: underline;
  cursor: pointer;
}

.drip-tab .iti__flag {
  width: 20px;
}

.drip-tab .iti__flag.iti__be {
  width: 18px;
}

.drip-tab .iti__flag.iti__ch {
  width: 15px;
}

.drip-tab .iti__flag.iti__mc {
  width: 19px;
}

.drip-tab .iti__flag.iti__ne {
  width: 18px;
}

.drip-tab .iti__flag.iti__np {
  width: 13px;
}

.drip-tab .iti__flag.iti__va {
  width: 15px;
}

@media (-webkit-min-device-pixel-ratio: 2),
(min-resolution: 192dpi) {
  .drip-tab .iti__flag {
    background-size: 5652px 15px;
  }
}

.drip-tab .iti__flag.iti__ac {
    height: 10px;
    background-position: 0px 0px;
  }

.drip-tab .iti__flag.iti__ad {
    height: 14px;
    background-position: -22px 0px;
  }

.drip-tab .iti__flag.iti__ae {
    height: 10px;
    background-position: -44px 0px;
  }

.drip-tab .iti__flag.iti__af {
    height: 14px;
    background-position: -66px 0px;
  }

.drip-tab .iti__flag.iti__ag {
    height: 14px;
    background-position: -88px 0px;
  }

.drip-tab .iti__flag.iti__ai {
    height: 10px;
    background-position: -110px 0px;
  }

.drip-tab .iti__flag.iti__al {
    height: 15px;
    background-position: -132px 0px;
  }

.drip-tab .iti__flag.iti__am {
    height: 10px;
    background-position: -154px 0px;
  }

.drip-tab .iti__flag.iti__ao {
    height: 14px;
    background-position: -176px 0px;
  }

.drip-tab .iti__flag.iti__aq {
    height: 14px;
    background-position: -198px 0px;
  }

.drip-tab .iti__flag.iti__ar {
    height: 13px;
    background-position: -220px 0px;
  }

.drip-tab .iti__flag.iti__as {
    height: 10px;
    background-position: -242px 0px;
  }

.drip-tab .iti__flag.iti__at {
    height: 14px;
    background-position: -264px 0px;
  }

.drip-tab .iti__flag.iti__au {
    height: 10px;
    background-position: -286px 0px;
  }

.drip-tab .iti__flag.iti__aw {
    height: 14px;
    background-position: -308px 0px;
  }

.drip-tab .iti__flag.iti__ax {
    height: 13px;
    background-position: -330px 0px;
  }

.drip-tab .iti__flag.iti__az {
    height: 10px;
    background-position: -352px 0px;
  }

.drip-tab .iti__flag.iti__ba {
    height: 10px;
    background-position: -374px 0px;
  }

.drip-tab .iti__flag.iti__bb {
    height: 14px;
    background-position: -396px 0px;
  }

.drip-tab .iti__flag.iti__bd {
    height: 12px;
    background-position: -418px 0px;
  }

.drip-tab .iti__flag.iti__be {
    height: 15px;
    background-position: -440px 0px;
  }

.drip-tab .iti__flag.iti__bf {
    height: 14px;
    background-position: -460px 0px;
  }

.drip-tab .iti__flag.iti__bg {
    height: 12px;
    background-position: -482px 0px;
  }

.drip-tab .iti__flag.iti__bh {
    height: 12px;
    background-position: -504px 0px;
  }

.drip-tab .iti__flag.iti__bi {
    height: 12px;
    background-position: -526px 0px;
  }

.drip-tab .iti__flag.iti__bj {
    height: 14px;
    background-position: -548px 0px;
  }

.drip-tab .iti__flag.iti__bl {
    height: 14px;
    background-position: -570px 0px;
  }

.drip-tab .iti__flag.iti__bm {
    height: 10px;
    background-position: -592px 0px;
  }

.drip-tab .iti__flag.iti__bn {
    height: 10px;
    background-position: -614px 0px;
  }

.drip-tab .iti__flag.iti__bo {
    height: 14px;
    background-position: -636px 0px;
  }

.drip-tab .iti__flag.iti__bq {
    height: 14px;
    background-position: -658px 0px;
  }

.drip-tab .iti__flag.iti__br {
    height: 14px;
    background-position: -680px 0px;
  }

.drip-tab .iti__flag.iti__bs {
    height: 10px;
    background-position: -702px 0px;
  }

.drip-tab .iti__flag.iti__bt {
    height: 14px;
    background-position: -724px 0px;
  }

.drip-tab .iti__flag.iti__bv {
    height: 15px;
    background-position: -746px 0px;
  }

.drip-tab .iti__flag.iti__bw {
    height: 14px;
    background-position: -768px 0px;
  }

.drip-tab .iti__flag.iti__by {
    height: 10px;
    background-position: -790px 0px;
  }

.drip-tab .iti__flag.iti__bz {
    height: 14px;
    background-position: -812px 0px;
  }

.drip-tab .iti__flag.iti__ca {
    height: 10px;
    background-position: -834px 0px;
  }

.drip-tab .iti__flag.iti__cc {
    height: 10px;
    background-position: -856px 0px;
  }

.drip-tab .iti__flag.iti__cd {
    height: 15px;
    background-position: -878px 0px;
  }

.drip-tab .iti__flag.iti__cf {
    height: 14px;
    background-position: -900px 0px;
  }

.drip-tab .iti__flag.iti__cg {
    height: 14px;
    background-position: -922px 0px;
  }

.drip-tab .iti__flag.iti__ch {
    height: 15px;
    background-position: -944px 0px;
  }

.drip-tab .iti__flag.iti__ci {
    height: 14px;
    background-position: -961px 0px;
  }

.drip-tab .iti__flag.iti__ck {
    height: 10px;
    background-position: -983px 0px;
  }

.drip-tab .iti__flag.iti__cl {
    height: 14px;
    background-position: -1005px 0px;
  }

.drip-tab .iti__flag.iti__cm {
    height: 14px;
    background-position: -1027px 0px;
  }

.drip-tab .iti__flag.iti__cn {
    height: 14px;
    background-position: -1049px 0px;
  }

.drip-tab .iti__flag.iti__co {
    height: 14px;
    background-position: -1071px 0px;
  }

.drip-tab .iti__flag.iti__cp {
    height: 14px;
    background-position: -1093px 0px;
  }

.drip-tab .iti__flag.iti__cr {
    height: 12px;
    background-position: -1115px 0px;
  }

.drip-tab .iti__flag.iti__cu {
    height: 10px;
    background-position: -1137px 0px;
  }

.drip-tab .iti__flag.iti__cv {
    height: 12px;
    background-position: -1159px 0px;
  }

.drip-tab .iti__flag.iti__cw {
    height: 14px;
    background-position: -1181px 0px;
  }

.drip-tab .iti__flag.iti__cx {
    height: 10px;
    background-position: -1203px 0px;
  }

.drip-tab .iti__flag.iti__cy {
    height: 14px;
    background-position: -1225px 0px;
  }

.drip-tab .iti__flag.iti__cz {
    height: 14px;
    background-position: -1247px 0px;
  }

.drip-tab .iti__flag.iti__de {
    height: 12px;
    background-position: -1269px 0px;
  }

.drip-tab .iti__flag.iti__dg {
    height: 10px;
    background-position: -1291px 0px;
  }

.drip-tab .iti__flag.iti__dj {
    height: 14px;
    background-position: -1313px 0px;
  }

.drip-tab .iti__flag.iti__dk {
    height: 15px;
    background-position: -1335px 0px;
  }

.drip-tab .iti__flag.iti__dm {
    height: 10px;
    background-position: -1357px 0px;
  }

.drip-tab .iti__flag.iti__do {
    height: 14px;
    background-position: -1379px 0px;
  }

.drip-tab .iti__flag.iti__dz {
    height: 14px;
    background-position: -1401px 0px;
  }

.drip-tab .iti__flag.iti__ea {
    height: 14px;
    background-position: -1423px 0px;
  }

.drip-tab .iti__flag.iti__ec {
    height: 14px;
    background-position: -1445px 0px;
  }

.drip-tab .iti__flag.iti__ee {
    height: 13px;
    background-position: -1467px 0px;
  }

.drip-tab .iti__flag.iti__eg {
    height: 14px;
    background-position: -1489px 0px;
  }

.drip-tab .iti__flag.iti__eh {
    height: 10px;
    background-position: -1511px 0px;
  }

.drip-tab .iti__flag.iti__er {
    height: 10px;
    background-position: -1533px 0px;
  }

.drip-tab .iti__flag.iti__es {
    height: 14px;
    background-position: -1555px 0px;
  }

.drip-tab .iti__flag.iti__et {
    height: 10px;
    background-position: -1577px 0px;
  }

.drip-tab .iti__flag.iti__eu {
    height: 14px;
    background-position: -1599px 0px;
  }

.drip-tab .iti__flag.iti__fi {
    height: 12px;
    background-position: -1621px 0px;
  }

.drip-tab .iti__flag.iti__fj {
    height: 10px;
    background-position: -1643px 0px;
  }

.drip-tab .iti__flag.iti__fk {
    height: 10px;
    background-position: -1665px 0px;
  }

.drip-tab .iti__flag.iti__fm {
    height: 11px;
    background-position: -1687px 0px;
  }

.drip-tab .iti__flag.iti__fo {
    height: 15px;
    background-position: -1709px 0px;
  }

.drip-tab .iti__flag.iti__fr {
    height: 14px;
    background-position: -1731px 0px;
  }

.drip-tab .iti__flag.iti__ga {
    height: 15px;
    background-position: -1753px 0px;
  }

.drip-tab .iti__flag.iti__gb {
    height: 10px;
    background-position: -1775px 0px;
  }

.drip-tab .iti__flag.iti__gd {
    height: 12px;
    background-position: -1797px 0px;
  }

.drip-tab .iti__flag.iti__ge {
    height: 14px;
    background-position: -1819px 0px;
  }

.drip-tab .iti__flag.iti__gf {
    height: 14px;
    background-position: -1841px 0px;
  }

.drip-tab .iti__flag.iti__gg {
    height: 14px;
    background-position: -1863px 0px;
  }

.drip-tab .iti__flag.iti__gh {
    height: 14px;
    background-position: -1885px 0px;
  }

.drip-tab .iti__flag.iti__gi {
    height: 10px;
    background-position: -1907px 0px;
  }

.drip-tab .iti__flag.iti__gl {
    height: 14px;
    background-position: -1929px 0px;
  }

.drip-tab .iti__flag.iti__gm {
    height: 14px;
    background-position: -1951px 0px;
  }

.drip-tab .iti__flag.iti__gn {
    height: 14px;
    background-position: -1973px 0px;
  }

.drip-tab .iti__flag.iti__gp {
    height: 14px;
    background-position: -1995px 0px;
  }

.drip-tab .iti__flag.iti__gq {
    height: 14px;
    background-position: -2017px 0px;
  }

.drip-tab .iti__flag.iti__gr {
    height: 14px;
    background-position: -2039px 0px;
  }

.drip-tab .iti__flag.iti__gs {
    height: 10px;
    background-position: -2061px 0px;
  }

.drip-tab .iti__flag.iti__gt {
    height: 13px;
    background-position: -2083px 0px;
  }

.drip-tab .iti__flag.iti__gu {
    height: 11px;
    background-position: -2105px 0px;
  }

.drip-tab .iti__flag.iti__gw {
    height: 10px;
    background-position: -2127px 0px;
  }

.drip-tab .iti__flag.iti__gy {
    height: 12px;
    background-position: -2149px 0px;
  }

.drip-tab .iti__flag.iti__hk {
    height: 14px;
    background-position: -2171px 0px;
  }

.drip-tab .iti__flag.iti__hm {
    height: 10px;
    background-position: -2193px 0px;
  }

.drip-tab .iti__flag.iti__hn {
    height: 10px;
    background-position: -2215px 0px;
  }

.drip-tab .iti__flag.iti__hr {
    height: 10px;
    background-position: -2237px 0px;
  }

.drip-tab .iti__flag.iti__ht {
    height: 12px;
    background-position: -2259px 0px;
  }

.drip-tab .iti__flag.iti__hu {
    height: 10px;
    background-position: -2281px 0px;
  }

.drip-tab .iti__flag.iti__ic {
    height: 14px;
    background-position: -2303px 0px;
  }

.drip-tab .iti__flag.iti__id {
    height: 14px;
    background-position: -2325px 0px;
  }

.drip-tab .iti__flag.iti__ie {
    height: 10px;
    background-position: -2347px 0px;
  }

.drip-tab .iti__flag.iti__il {
    height: 15px;
    background-position: -2369px 0px;
  }

.drip-tab .iti__flag.iti__im {
    height: 10px;
    background-position: -2391px 0px;
  }

.drip-tab .iti__flag.iti__in {
    height: 14px;
    background-position: -2413px 0px;
  }

.drip-tab .iti__flag.iti__io {
    height: 10px;
    background-position: -2435px 0px;
  }

.drip-tab .iti__flag.iti__iq {
    height: 14px;
    background-position: -2457px 0px;
  }

.drip-tab .iti__flag.iti__ir {
    height: 12px;
    background-position: -2479px 0px;
  }

.drip-tab .iti__flag.iti__is {
    height: 15px;
    background-position: -2501px 0px;
  }

.drip-tab .iti__flag.iti__it {
    height: 14px;
    background-position: -2523px 0px;
  }

.drip-tab .iti__flag.iti__je {
    height: 12px;
    background-position: -2545px 0px;
  }

.drip-tab .iti__flag.iti__jm {
    height: 10px;
    background-position: -2567px 0px;
  }

.drip-tab .iti__flag.iti__jo {
    height: 10px;
    background-position: -2589px 0px;
  }

.drip-tab .iti__flag.iti__jp {
    height: 14px;
    background-position: -2611px 0px;
  }

.drip-tab .iti__flag.iti__ke {
    height: 14px;
    background-position: -2633px 0px;
  }

.drip-tab .iti__flag.iti__kg {
    height: 12px;
    background-position: -2655px 0px;
  }

.drip-tab .iti__flag.iti__kh {
    height: 13px;
    background-position: -2677px 0px;
  }

.drip-tab .iti__flag.iti__ki {
    height: 10px;
    background-position: -2699px 0px;
  }

.drip-tab .iti__flag.iti__km {
    height: 12px;
    background-position: -2721px 0px;
  }

.drip-tab .iti__flag.iti__kn {
    height: 14px;
    background-position: -2743px 0px;
  }

.drip-tab .iti__flag.iti__kp {
    height: 10px;
    background-position: -2765px 0px;
  }

.drip-tab .iti__flag.iti__kr {
    height: 14px;
    background-position: -2787px 0px;
  }

.drip-tab .iti__flag.iti__kw {
    height: 10px;
    background-position: -2809px 0px;
  }

.drip-tab .iti__flag.iti__ky {
    height: 10px;
    background-position: -2831px 0px;
  }

.drip-tab .iti__flag.iti__kz {
    height: 10px;
    background-position: -2853px 0px;
  }

.drip-tab .iti__flag.iti__la {
    height: 14px;
    background-position: -2875px 0px;
  }

.drip-tab .iti__flag.iti__lb {
    height: 14px;
    background-position: -2897px 0px;
  }

.drip-tab .iti__flag.iti__lc {
    height: 10px;
    background-position: -2919px 0px;
  }

.drip-tab .iti__flag.iti__li {
    height: 12px;
    background-position: -2941px 0px;
  }

.drip-tab .iti__flag.iti__lk {
    height: 10px;
    background-position: -2963px 0px;
  }

.drip-tab .iti__flag.iti__lr {
    height: 11px;
    background-position: -2985px 0px;
  }

.drip-tab .iti__flag.iti__ls {
    height: 14px;
    background-position: -3007px 0px;
  }

.drip-tab .iti__flag.iti__lt {
    height: 12px;
    background-position: -3029px 0px;
  }

.drip-tab .iti__flag.iti__lu {
    height: 12px;
    background-position: -3051px 0px;
  }

.drip-tab .iti__flag.iti__lv {
    height: 10px;
    background-position: -3073px 0px;
  }

.drip-tab .iti__flag.iti__ly {
    height: 10px;
    background-position: -3095px 0px;
  }

.drip-tab .iti__flag.iti__ma {
    height: 14px;
    background-position: -3117px 0px;
  }

.drip-tab .iti__flag.iti__mc {
    height: 15px;
    background-position: -3139px 0px;
  }

.drip-tab .iti__flag.iti__md {
    height: 10px;
    background-position: -3160px 0px;
  }

.drip-tab .iti__flag.iti__me {
    height: 10px;
    background-position: -3182px 0px;
  }

.drip-tab .iti__flag.iti__mf {
    height: 14px;
    background-position: -3204px 0px;
  }

.drip-tab .iti__flag.iti__mg {
    height: 14px;
    background-position: -3226px 0px;
  }

.drip-tab .iti__flag.iti__mh {
    height: 11px;
    background-position: -3248px 0px;
  }

.drip-tab .iti__flag.iti__mk {
    height: 10px;
    background-position: -3270px 0px;
  }

.drip-tab .iti__flag.iti__ml {
    height: 14px;
    background-position: -3292px 0px;
  }

.drip-tab .iti__flag.iti__mm {
    height: 14px;
    background-position: -3314px 0px;
  }

.drip-tab .iti__flag.iti__mn {
    height: 10px;
    background-position: -3336px 0px;
  }

.drip-tab .iti__flag.iti__mo {
    height: 14px;
    background-position: -3358px 0px;
  }

.drip-tab .iti__flag.iti__mp {
    height: 10px;
    background-position: -3380px 0px;
  }

.drip-tab .iti__flag.iti__mq {
    height: 14px;
    background-position: -3402px 0px;
  }

.drip-tab .iti__flag.iti__mr {
    height: 14px;
    background-position: -3424px 0px;
  }

.drip-tab .iti__flag.iti__ms {
    height: 10px;
    background-position: -3446px 0px;
  }

.drip-tab .iti__flag.iti__mt {
    height: 14px;
    background-position: -3468px 0px;
  }

.drip-tab .iti__flag.iti__mu {
    height: 14px;
    background-position: -3490px 0px;
  }

.drip-tab .iti__flag.iti__mv {
    height: 14px;
    background-position: -3512px 0px;
  }

.drip-tab .iti__flag.iti__mw {
    height: 14px;
    background-position: -3534px 0px;
  }

.drip-tab .iti__flag.iti__mx {
    height: 12px;
    background-position: -3556px 0px;
  }

.drip-tab .iti__flag.iti__my {
    height: 10px;
    background-position: -3578px 0px;
  }

.drip-tab .iti__flag.iti__mz {
    height: 14px;
    background-position: -3600px 0px;
  }

.drip-tab .iti__flag.iti__na {
    height: 14px;
    background-position: -3622px 0px;
  }

.drip-tab .iti__flag.iti__nc {
    height: 10px;
    background-position: -3644px 0px;
  }

.drip-tab .iti__flag.iti__ne {
    height: 15px;
    background-position: -3666px 0px;
  }

.drip-tab .iti__flag.iti__nf {
    height: 10px;
    background-position: -3686px 0px;
  }

.drip-tab .iti__flag.iti__ng {
    height: 10px;
    background-position: -3708px 0px;
  }

.drip-tab .iti__flag.iti__ni {
    height: 12px;
    background-position: -3730px 0px;
  }

.drip-tab .iti__flag.iti__nl {
    height: 14px;
    background-position: -3752px 0px;
  }

.drip-tab .iti__flag.iti__no {
    height: 15px;
    background-position: -3774px 0px;
  }

.drip-tab .iti__flag.iti__np {
    height: 15px;
    background-position: -3796px 0px;
  }

.drip-tab .iti__flag.iti__nr {
    height: 10px;
    background-position: -3811px 0px;
  }

.drip-tab .iti__flag.iti__nu {
    height: 10px;
    background-position: -3833px 0px;
  }

.drip-tab .iti__flag.iti__nz {
    height: 10px;
    background-position: -3855px 0px;
  }

.drip-tab .iti__flag.iti__om {
    height: 10px;
    background-position: -3877px 0px;
  }

.drip-tab .iti__flag.iti__pa {
    height: 14px;
    background-position: -3899px 0px;
  }

.drip-tab .iti__flag.iti__pe {
    height: 14px;
    background-position: -3921px 0px;
  }

.drip-tab .iti__flag.iti__pf {
    height: 14px;
    background-position: -3943px 0px;
  }

.drip-tab .iti__flag.iti__pg {
    height: 15px;
    background-position: -3965px 0px;
  }

.drip-tab .iti__flag.iti__ph {
    height: 10px;
    background-position: -3987px 0px;
  }

.drip-tab .iti__flag.iti__pk {
    height: 14px;
    background-position: -4009px 0px;
  }

.drip-tab .iti__flag.iti__pl {
    height: 13px;
    background-position: -4031px 0px;
  }

.drip-tab .iti__flag.iti__pm {
    height: 14px;
    background-position: -4053px 0px;
  }

.drip-tab .iti__flag.iti__pn {
    height: 10px;
    background-position: -4075px 0px;
  }

.drip-tab .iti__flag.iti__pr {
    height: 14px;
    background-position: -4097px 0px;
  }

.drip-tab .iti__flag.iti__ps {
    height: 10px;
    background-position: -4119px 0px;
  }

.drip-tab .iti__flag.iti__pt {
    height: 14px;
    background-position: -4141px 0px;
  }

.drip-tab .iti__flag.iti__pw {
    height: 13px;
    background-position: -4163px 0px;
  }

.drip-tab .iti__flag.iti__py {
    height: 11px;
    background-position: -4185px 0px;
  }

.drip-tab .iti__flag.iti__qa {
    height: 8px;
    background-position: -4207px 0px;
  }

.drip-tab .iti__flag.iti__re {
    height: 14px;
    background-position: -4229px 0px;
  }

.drip-tab .iti__flag.iti__ro {
    height: 14px;
    background-position: -4251px 0px;
  }

.drip-tab .iti__flag.iti__rs {
    height: 14px;
    background-position: -4273px 0px;
  }

.drip-tab .iti__flag.iti__ru {
    height: 14px;
    background-position: -4295px 0px;
  }

.drip-tab .iti__flag.iti__rw {
    height: 14px;
    background-position: -4317px 0px;
  }

.drip-tab .iti__flag.iti__sa {
    height: 14px;
    background-position: -4339px 0px;
  }

.drip-tab .iti__flag.iti__sb {
    height: 10px;
    background-position: -4361px 0px;
  }

.drip-tab .iti__flag.iti__sc {
    height: 10px;
    background-position: -4383px 0px;
  }

.drip-tab .iti__flag.iti__sd {
    height: 10px;
    background-position: -4405px 0px;
  }

.drip-tab .iti__flag.iti__se {
    height: 13px;
    background-position: -4427px 0px;
  }

.drip-tab .iti__flag.iti__sg {
    height: 14px;
    background-position: -4449px 0px;
  }

.drip-tab .iti__flag.iti__sh {
    height: 10px;
    background-position: -4471px 0px;
  }

.drip-tab .iti__flag.iti__si {
    height: 10px;
    background-position: -4493px 0px;
  }

.drip-tab .iti__flag.iti__sj {
    height: 15px;
    background-position: -4515px 0px;
  }

.drip-tab .iti__flag.iti__sk {
    height: 14px;
    background-position: -4537px 0px;
  }

.drip-tab .iti__flag.iti__sl {
    height: 14px;
    background-position: -4559px 0px;
  }

.drip-tab .iti__flag.iti__sm {
    height: 15px;
    background-position: -4581px 0px;
  }

.drip-tab .iti__flag.iti__sn {
    height: 14px;
    background-position: -4603px 0px;
  }

.drip-tab .iti__flag.iti__so {
    height: 14px;
    background-position: -4625px 0px;
  }

.drip-tab .iti__flag.iti__sr {
    height: 14px;
    background-position: -4647px 0px;
  }

.drip-tab .iti__flag.iti__ss {
    height: 10px;
    background-position: -4669px 0px;
  }

.drip-tab .iti__flag.iti__st {
    height: 10px;
    background-position: -4691px 0px;
  }

.drip-tab .iti__flag.iti__sv {
    height: 12px;
    background-position: -4713px 0px;
  }

.drip-tab .iti__flag.iti__sx {
    height: 14px;
    background-position: -4735px 0px;
  }

.drip-tab .iti__flag.iti__sy {
    height: 14px;
    background-position: -4757px 0px;
  }

.drip-tab .iti__flag.iti__sz {
    height: 14px;
    background-position: -4779px 0px;
  }

.drip-tab .iti__flag.iti__ta {
    height: 10px;
    background-position: -4801px 0px;
  }

.drip-tab .iti__flag.iti__tc {
    height: 10px;
    background-position: -4823px 0px;
  }

.drip-tab .iti__flag.iti__td {
    height: 14px;
    background-position: -4845px 0px;
  }

.drip-tab .iti__flag.iti__tf {
    height: 14px;
    background-position: -4867px 0px;
  }

.drip-tab .iti__flag.iti__tg {
    height: 13px;
    background-position: -4889px 0px;
  }

.drip-tab .iti__flag.iti__th {
    height: 14px;
    background-position: -4911px 0px;
  }

.drip-tab .iti__flag.iti__tj {
    height: 10px;
    background-position: -4933px 0px;
  }

.drip-tab .iti__flag.iti__tk {
    height: 10px;
    background-position: -4955px 0px;
  }

.drip-tab .iti__flag.iti__tl {
    height: 10px;
    background-position: -4977px 0px;
  }

.drip-tab .iti__flag.iti__tm {
    height: 14px;
    background-position: -4999px 0px;
  }

.drip-tab .iti__flag.iti__tn {
    height: 14px;
    background-position: -5021px 0px;
  }

.drip-tab .iti__flag.iti__to {
    height: 10px;
    background-position: -5043px 0px;
  }

.drip-tab .iti__flag.iti__tr {
    height: 14px;
    background-position: -5065px 0px;
  }

.drip-tab .iti__flag.iti__tt {
    height: 12px;
    background-position: -5087px 0px;
  }

.drip-tab .iti__flag.iti__tv {
    height: 10px;
    background-position: -5109px 0px;
  }

.drip-tab .iti__flag.iti__tw {
    height: 14px;
    background-position: -5131px 0px;
  }

.drip-tab .iti__flag.iti__tz {
    height: 14px;
    background-position: -5153px 0px;
  }

.drip-tab .iti__flag.iti__ua {
    height: 14px;
    background-position: -5175px 0px;
  }

.drip-tab .iti__flag.iti__ug {
    height: 14px;
    background-position: -5197px 0px;
  }

.drip-tab .iti__flag.iti__um {
    height: 11px;
    background-position: -5219px 0px;
  }

.drip-tab .iti__flag.iti__un {
    height: 14px;
    background-position: -5241px 0px;
  }

.drip-tab .iti__flag.iti__us {
    height: 11px;
    background-position: -5263px 0px;
  }

.drip-tab .iti__flag.iti__uy {
    height: 14px;
    background-position: -5285px 0px;
  }

.drip-tab .iti__flag.iti__uz {
    height: 10px;
    background-position: -5307px 0px;
  }

.drip-tab .iti__flag.iti__va {
    height: 15px;
    background-position: -5329px 0px;
  }

.drip-tab .iti__flag.iti__vc {
    height: 14px;
    background-position: -5346px 0px;
  }

.drip-tab .iti__flag.iti__ve {
    height: 14px;
    background-position: -5368px 0px;
  }

.drip-tab .iti__flag.iti__vg {
    height: 10px;
    background-position: -5390px 0px;
  }

.drip-tab .iti__flag.iti__vi {
    height: 14px;
    background-position: -5412px 0px;
  }

.drip-tab .iti__flag.iti__vn {
    height: 14px;
    background-position: -5434px 0px;
  }

.drip-tab .iti__flag.iti__vu {
    height: 12px;
    background-position: -5456px 0px;
  }

.drip-tab .iti__flag.iti__wf {
    height: 14px;
    background-position: -5478px 0px;
  }

.drip-tab .iti__flag.iti__ws {
    height: 10px;
    background-position: -5500px 0px;
  }

.drip-tab .iti__flag.iti__xk {
    height: 15px;
    background-position: -5522px 0px;
  }

.drip-tab .iti__flag.iti__ye {
    height: 14px;
    background-position: -5544px 0px;
  }

.drip-tab .iti__flag.iti__yt {
    height: 14px;
    background-position: -5566px 0px;
  }

.drip-tab .iti__flag.iti__za {
    height: 14px;
    background-position: -5588px 0px;
  }

.drip-tab .iti__flag.iti__zm {
    height: 14px;
    background-position: -5610px 0px;
  }

.drip-tab .iti__flag.iti__zw {
    height: 10px;
    background-position: -5632px 0px;
  }

.drip-tab .iti__flag {
    height: 15px;
    box-shadow: 0px 0px 1px 0px #888;
    background-image: url("flags.png");
    background-repeat: no-repeat;
    background-position: 20px 0;
  }

.drip-tab .iti__flag.iti__np {
  background-color: transparent;
}

.drip-tab .iti__flag {
  background-image: url("https://d14jnfavjicsbe.cloudfront.net/images/client/flags.png");
}

@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .drip-tab .iti__flag {
    background-image: url("https://d14jnfavjicsbe.cloudfront.net/images/client/flags@2x.png");
  }
}

/* stylelint-enable */


  /* preview settings */
  body.after-submit-preview .drip-panel:not(.drip-success) {
    display: none !important;
  }
  body.after-submit-preview .drip-success {
    display: block !important;
  }

  /* stylelint-enable */

</style><style type="text/css">.CtxtMenu_InfoClose {  top:.2em; right:.2em;}
.CtxtMenu_InfoContent {  overflow:auto; text-align:left; font-size:80%;  padding:.4em .6em; border:1px inset; margin:1em 0px;  max-height:20em; max-width:30em; background-color:#EEEEEE;  white-space:normal;}
.CtxtMenu_Info.CtxtMenu_MousePost {outline:none;}
.CtxtMenu_Info {  position:fixed; left:50%; width:auto; text-align:center;  border:3px outset; padding:1em 2em; background-color:#DDDDDD;  color:black;  cursor:default; font-family:message-box; font-size:120%;  font-style:normal; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 15px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius:15px;               /* Safari and Chrome */  -moz-border-radius:15px;                  /* Firefox */  -khtml-border-radius:15px;                /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */  filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */}
</style><style type="text/css">.CtxtMenu_MenuClose {  position:absolute;  cursor:pointer;  display:inline-block;  border:2px solid #AAA;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  font-family: "Courier New", Courier;  font-size:24px;  color:#F0F0F0}
.CtxtMenu_MenuClose span {  display:block; background-color:#AAA; border:1.5px solid;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  line-height:0;  padding:8px 0 6px     /* may need to be browser-specific */}
.CtxtMenu_MenuClose:hover {  color:white!important;  border:2px solid #CCC!important}
.CtxtMenu_MenuClose:hover span {  background-color:#CCC!important}
.CtxtMenu_MenuClose:hover:focus {  outline:none}
</style><style type="text/css">.CtxtMenu_Menu {  position:absolute;  background-color:white;  color:black;  width:auto; padding:5px 0px;  border:1px solid #CCCCCC; margin:0; cursor:default;  font: menu; text-align:left; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 5px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius: 5px;             /* Safari and Chrome */  -moz-border-radius: 5px;                /* Firefox */  -khtml-border-radius: 5px;              /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */}
.CtxtMenu_MenuItem {  padding: 1px 2em;  background:transparent;}
.CtxtMenu_MenuArrow {  position:absolute; right:.5em; padding-top:.25em; color:#666666;  font-family: null; font-size: .75em}
.CtxtMenu_MenuActive .CtxtMenu_MenuArrow {color:white}
.CtxtMenu_MenuArrow.CtxtMenu_RTL {left:.5em; right:auto}
.CtxtMenu_MenuCheck {  position:absolute; left:.7em;  font-family: null}
.CtxtMenu_MenuCheck.CtxtMenu_RTL { right:.7em; left:auto }
.CtxtMenu_MenuRadioCheck {  position:absolute; left: .7em;}
.CtxtMenu_MenuRadioCheck.CtxtMenu_RTL {  right: .7em; left:auto}
.CtxtMenu_MenuInputBox {  padding-left: 1em; right:.5em; color:#666666;  font-family: null;}
.CtxtMenu_MenuInputBox.CtxtMenu_RTL {  left: .1em;}
.CtxtMenu_MenuComboBox {  left:.1em; padding-bottom:.5em;}
.CtxtMenu_MenuSlider {  left: .1em;}
.CtxtMenu_SliderValue {  position:absolute; right:.1em; padding-top:.25em; color:#333333;  font-size: .75em}
.CtxtMenu_SliderBar {  outline: none; background: #d3d3d3}
.CtxtMenu_MenuLabel {  padding: 1px 2em 3px 1.33em;  font-style:italic}
.CtxtMenu_MenuRule {  border-top: 1px solid #DDDDDD;  margin: 4px 3px;}
.CtxtMenu_MenuDisabled {  color:GrayText}
.CtxtMenu_MenuActive {  background-color: #606872;  color: white;}
.CtxtMenu_MenuDisabled:focus {  background-color: #E8E8E8}
.CtxtMenu_MenuLabel:focus {  background-color: #E8E8E8}
.CtxtMenu_ContextMenu:focus {  outline:none}
.CtxtMenu_ContextMenu .CtxtMenu_MenuItem:focus {  outline:none}
.CtxtMenu_SelectionMenu {  position:relative; float:left;  border-bottom: none; -webkit-box-shadow:none; -webkit-border-radius:0px; }
.CtxtMenu_SelectionItem {  padding-right: 1em;}
.CtxtMenu_Selection {  right: 40%; width:50%; }
.CtxtMenu_SelectionBox {  padding: 0em; max-height:20em; max-width: none;  background-color:#FFFFFF;}
.CtxtMenu_SelectionDivider {  clear: both; border-top: 2px solid #000000;}
.CtxtMenu_Menu .CtxtMenu_MenuClose {  top:-10px; left:-10px}
</style><style id="MJX-CHTML-styles">
mjx-container[jax="CHTML"] {
  line-height: 0;
}

mjx-container [space="1"] {
  margin-left: .111em;
}

mjx-container [space="2"] {
  margin-left: .167em;
}

mjx-container [space="3"] {
  margin-left: .222em;
}

mjx-container [space="4"] {
  margin-left: .278em;
}

mjx-container [space="5"] {
  margin-left: .333em;
}

mjx-container [rspace="1"] {
  margin-right: .111em;
}

mjx-container [rspace="2"] {
  margin-right: .167em;
}

mjx-container [rspace="3"] {
  margin-right: .222em;
}

mjx-container [rspace="4"] {
  margin-right: .278em;
}

mjx-container [rspace="5"] {
  margin-right: .333em;
}

mjx-container [size="s"] {
  font-size: 70.7%;
}

mjx-container [size="ss"] {
  font-size: 50%;
}

mjx-container [size="Tn"] {
  font-size: 60%;
}

mjx-container [size="sm"] {
  font-size: 85%;
}

mjx-container [size="lg"] {
  font-size: 120%;
}

mjx-container [size="Lg"] {
  font-size: 144%;
}

mjx-container [size="LG"] {
  font-size: 173%;
}

mjx-container [size="hg"] {
  font-size: 207%;
}

mjx-container [size="HG"] {
  font-size: 249%;
}

mjx-container [width="full"] {
  width: 100%;
}

mjx-box {
  display: inline-block;
}

mjx-block {
  display: block;
}

mjx-itable {
  display: inline-table;
}

mjx-row {
  display: table-row;
}

mjx-row > * {
  display: table-cell;
}

mjx-mtext {
  display: inline-block;
}

mjx-mstyle {
  display: inline-block;
}

mjx-merror {
  display: inline-block;
  color: red;
  background-color: yellow;
}

mjx-mphantom {
  visibility: hidden;
}

_::-webkit-full-page-media, _:future, :root mjx-container {
  will-change: opacity;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-c::before {
  display: block;
  width: 0;
}

.MJX-TEX {
  font-family: MJXZERO, MJXTEX;
}

.TEX-B {
  font-family: MJXZERO, MJXTEX-B;
}

.TEX-I {
  font-family: MJXZERO, MJXTEX-I;
}

.TEX-MI {
  font-family: MJXZERO, MJXTEX-MI;
}

.TEX-BI {
  font-family: MJXZERO, MJXTEX-BI;
}

.TEX-S1 {
  font-family: MJXZERO, MJXTEX-S1;
}

.TEX-S2 {
  font-family: MJXZERO, MJXTEX-S2;
}

.TEX-S3 {
  font-family: MJXZERO, MJXTEX-S3;
}

.TEX-S4 {
  font-family: MJXZERO, MJXTEX-S4;
}

.TEX-A {
  font-family: MJXZERO, MJXTEX-A;
}

.TEX-C {
  font-family: MJXZERO, MJXTEX-C;
}

.TEX-CB {
  font-family: MJXZERO, MJXTEX-CB;
}

.TEX-FR {
  font-family: MJXZERO, MJXTEX-FR;
}

.TEX-FRB {
  font-family: MJXZERO, MJXTEX-FRB;
}

.TEX-SS {
  font-family: MJXZERO, MJXTEX-SS;
}

.TEX-SSB {
  font-family: MJXZERO, MJXTEX-SSB;
}

.TEX-SSI {
  font-family: MJXZERO, MJXTEX-SSI;
}

.TEX-SC {
  font-family: MJXZERO, MJXTEX-SC;
}

.TEX-T {
  font-family: MJXZERO, MJXTEX-T;
}

.TEX-V {
  font-family: MJXZERO, MJXTEX-V;
}

.TEX-VB {
  font-family: MJXZERO, MJXTEX-VB;
}

mjx-stretchy-v mjx-c, mjx-stretchy-h mjx-c {
  font-family: MJXZERO, MJXTEX-S1, MJXTEX-S4, MJXTEX, MJXTEX-A ! important;
}

@font-face /* 0 */ {
  font-family: MJXZERO;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff");
}

@font-face /* 1 */ {
  font-family: MJXTEX;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff");
}

@font-face /* 2 */ {
  font-family: MJXTEX-B;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff");
}

@font-face /* 3 */ {
  font-family: MJXTEX-I;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff");
}

@font-face /* 4 */ {
  font-family: MJXTEX-MI;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff");
}

@font-face /* 5 */ {
  font-family: MJXTEX-BI;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff");
}

@font-face /* 6 */ {
  font-family: MJXTEX-S1;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff");
}

@font-face /* 7 */ {
  font-family: MJXTEX-S2;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff");
}

@font-face /* 8 */ {
  font-family: MJXTEX-S3;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff");
}

@font-face /* 9 */ {
  font-family: MJXTEX-S4;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff");
}

@font-face /* 10 */ {
  font-family: MJXTEX-A;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff");
}

@font-face /* 11 */ {
  font-family: MJXTEX-C;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff");
}

@font-face /* 12 */ {
  font-family: MJXTEX-CB;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff");
}

@font-face /* 13 */ {
  font-family: MJXTEX-FR;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff");
}

@font-face /* 14 */ {
  font-family: MJXTEX-FRB;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff");
}

@font-face /* 15 */ {
  font-family: MJXTEX-SS;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff");
}

@font-face /* 16 */ {
  font-family: MJXTEX-SSB;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff");
}

@font-face /* 17 */ {
  font-family: MJXTEX-SSI;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff");
}

@font-face /* 18 */ {
  font-family: MJXTEX-SC;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff");
}

@font-face /* 19 */ {
  font-family: MJXTEX-T;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff");
}

@font-face /* 20 */ {
  font-family: MJXTEX-V;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff");
}

@font-face /* 21 */ {
  font-family: MJXTEX-VB;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/npm/mathjax@3/es5/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff");
}
</style><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><meta http-equiv="origin-trial" content="AzoawhTRDevLR66Y6MROu167EDncFPBvcKOaQispTo9ouEt5LvcBjnRFqiAByRT+2cDHG1Yj4dXwpLeIhc98/gIAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjYxMjk5MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A6+nc62kbJgC46ypOwRsNW6RkDn2x7tgRh0wp7jb3DtFF7oEhu1hhm4rdZHZ6zXvnKZLlYcBlQUImC4d3kKihAcAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjYxMjk5MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><meta http-equiv="origin-trial" content="A/9La288e7MDEU2ifusFnMg1C2Ij6uoa/Z/ylwJIXSsWfK37oESIPbxbt4IU86OGqDEPnNVruUiMjfKo65H/CQwAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjYxMjk5MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ=="><script src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/pubads_impl_2022061501.js" async=""></script><link rel="stylesheet" type="text/css" href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/ads.css"><link rel="stylesheet" type="text/css" href="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/twitcount.css" media="all"><link rel="prefetch" href="https://machinelearningmastery.com/how-to-develop-a-generative-adversarial-network-for-a-1-dimensional-function-from-scratch-in-keras/"><link rel="prefetch" href="https://machinelearningmastery.com/cyclegan-tutorial-with-keras/"></head>
<body class="post-template-default single single-post postid-8173 single-format-standard chrome alt-style-default two-col-left width-1070 two-col-left-1070 aa-prefix-machi- adthrive-device-desktop">
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Header_smaller_text_better-1.webp" alt="Machine Learning Mastery" width="480" height="80"></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="custom_html-32" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: right;">
<script src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/embed.js" async="" defer="defer"></script> <a href="" data-leadbox-popup="Hu8QegaSVPUonXe7k9JFu6" data-leadbox-domain="machinelearningmastery.lpages.co">Click to Take the FREE GANs Crash-Course</a> 
</div></div></div><div id="search-4" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="https://machinelearningmastery.com/">
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (!window.__cfRLUnblockHandlers) return false; if (this.value == 'Search...') {this.value = '';}" onblur="if (!window.__cfRLUnblockHandlers) return false; if (this.value == '') {this.value = 'Search...';}">
		<input type="hidden" name="post_type" value="post">
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="https://machinelearningmastery.com/" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-6503" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Get Started</a></li>
<li id="menu-item-6501" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li id="menu-item-6506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506 parent"><a href="#">Topics</a>
<ul class="sub-menu">
	<li id="menu-item-6508" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (keras)</a></li>
	<li id="menu-item-7921" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7921"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Computer Vision</a></li>
	<li id="menu-item-6509" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Neural Net Time Series</a></li>
	<li id="menu-item-6515" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">NLP (Text)</a></li>
	<li id="menu-item-8576" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-8576"><a href="https://machinelearningmastery.com/category/generative-adversarial-networks/">GANs</a></li>
	<li id="menu-item-6511" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
	<li id="menu-item-7106" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7106"><a href="https://machinelearningmastery.com/category/better-deep-learning/">Better Deep Learning</a></li>
	<li id="menu-item-13302" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-13302"><a href="https://machinelearningmastery.com/category/calculus/">Calculus</a></li>
	<li id="menu-item-6512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Intro to Algorithms</a></li>
	<li id="menu-item-6507" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms</a></li>
	<li id="menu-item-6520" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Intro to Time Series</a></li>
	<li id="menu-item-6516" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
	<li id="menu-item-11055" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-11055"><a href="https://machinelearningmastery.com/category/ensemble-learning/">Ensemble Learning</a></li>
	<li id="menu-item-9966" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9966"><a href="https://machinelearningmastery.com/category/imbalanced-classification/">Imbalanced Learning</a></li>
	<li id="menu-item-10674" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10674"><a href="https://machinelearningmastery.com/category/data-preparation/">Data Preparation</a></li>
	<li id="menu-item-6517" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
	<li id="menu-item-6522" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
	<li id="menu-item-6510" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
	<li id="menu-item-6519" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistics</a></li>
	<li id="menu-item-12825" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-12825"><a href="https://machinelearningmastery.com/category/optimization/">Optimization</a></li>
	<li id="menu-item-8989" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8989"><a href="https://machinelearningmastery.com/category/probability/">Probability</a></li>
	<li id="menu-item-6523" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
	<li id="menu-item-13672" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-13672"><a href="https://machinelearningmastery.com/category/python-for-machine-learning/">Python for Machine Learning</a></li>
</ul>
</li>
<li id="menu-item-6502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502"><a href="https://machinelearningmastery.com/products/">EBooks</a></li>
<li id="menu-item-6500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li id="menu-item-6504" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li id="menu-item-6505" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="#top" class="nav-close"><span>Return to Content</span></a>

</nav>

<!--	<div style="width:100%; min-height:100px; padding-top:10px; padding-bottom:50px; float:center;"> -->
	<!--</div>-->
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-8173 post type-post status-publish format-standard has-post-thumbnail hentry category-generative-adversarial-networks">
	
	<header>
	<h1 class="title entry-title">How to Identify and Diagnose GAN Failure Modes</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2019-07-08T05:00:03+1000">July 8, 2019</abbr>  <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/generative-adversarial-networks/" title="View all items in Generative Adversarial Networks">Generative Adversarial Networks</a></span>  </div>
	<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-8173 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Identify+and+Diagnose+GAN+Failure+Modes&amp;url=https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Identify+and+Diagnose+GAN+Failure+Modes&amp;url=https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<p id="last-modified-info">Last Updated on January 21, 2021</p>
<h4 style="text-align: center;">How to Identify Unstable Models When Training Generative Adversarial Networks.</h4>
<p><a href="https://machinelearningmastery.com/generative-adversarial-network-loss-functions/">GANs</a> are difficult to train.</p>
<p>The reason they are difficult to train is that both the generator 
model and the discriminator model are trained simultaneously in a zero 
sum game. This means that improvements to one model come at the expense 
of the other model.</p>
<p>The goal of training two models involves finding a point of equilibrium between the two competing concerns.</p>
<p>It also means that every time the parameters of one of the models are
 updated, the nature of the optimization problem that is being solved is
 changed. This has the effect of creating a dynamic system. In neural 
network terms, the technical challenge of training two competing neural 
networks at the same time is that they can fail to converge.</p>
<p>It is important to develop an intuition for both the normal 
convergence of a GAN model and unusual convergence of GAN models, 
sometimes called failure modes.</p>
<p>In this tutorial, we will first develop a stable GAN model for a 
simple image generation task in order to establish what normal 
convergence looks like and what to expect more generally.</p>
<p>We will then impair the GAN models in different ways and explore a 
range of failure modes that you may encounter when training GAN models. 
These scenarios will help you to develop an intuition for what to look 
for or expect when a GAN model is failing to train, and ideas for what 
you could do about it.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to identify a stable GAN training process from the generator and discriminator loss over time.</li>
<li>How to identify a mode collapse by reviewing both learning curves and generated images.</li>
<li>How to identify a convergence failure by reviewing learning curves of generator and discriminator loss over time.</li>
</ul>
<p><strong>Kick-start your project</strong> with my new book <a href="https://machinelearningmastery.com/generative_adversarial_networks/">Generative Adversarial Networks with Python</a>, including <em>step-by-step tutorials</em> and the <em>Python source code</em> files for all examples.</p>
<p>Let’s get started.</p>
<ul>
<li><strong>Updated Aug/2020</strong>: Corrected label on line plot.</li>
<li><strong>Updated Jan/2021</strong>: Updated so layer freezing works with batch norm.</li>
<li><strong>Updated Jan/2021</strong>: Simplified model architecture to ensure we see failures.</li>
</ul>
<div id="attachment_8183" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8183" class="size-full wp-image-8183" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/A-Practical-Guide-to-Generative-Adversarial-Network-Failure-.jpg" alt="A Practical Guide to Generative Adversarial Network Failure Modes" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/A-Practical-Guide-to-Generative-Adversarial-Network-Failure-.jpg 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/A-Practical-Guide-to-Generative-Adversarial-Network-Fail_002.jpg 300w" sizes="(max-width: 640px) 100vw, 640px" width="640" height="357"><p id="caption-attachment-8183" class="wp-caption-text">A Practical Guide to Generative Adversarial Network Failure Modes<br>Photo by <a href="https://www.flickr.com/photos/58515256@N07/24791307810">Jason Heavner</a>, some rights reserved.</p></div>
<div id="AdThrive_Content_1_desktop" class="adthrive-ad adthrive-content adthrive-content-1 adthrive-ad-cls" style="min-height: 250px;" data-google-query-id="CM-8yOPgvvgCFckGaAgdk7UJcQ"><div id="google_ads_iframe_/18190176,22523581566/AdThrive_Content_1/5d4c8ca4693e634b2e5d98cf_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/18190176,22523581566/AdThrive_Content_1/5d4c8ca4693e634b2e5d98cf_0" name="google_ads_iframe_/18190176,22523581566/AdThrive_Content_1/5d4c8ca4693e634b2e5d98cf_0" title="3rd party ad content" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" role="region" aria-label="Advertisement" tabindex="0" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="4" data-load-complete="true" width="728" height="250" frameborder="0"></iframe></div></div><h2>Tutorial Overview</h2>
<p>This tutorial is divided into three parts; they are:</p>
<ol>
<li>How To Identify a Stable Generative Adversarial Network</li>
<li>How To Identify a Mode Collapse in a Generative Adversarial Network</li>
<li>How To Identify Convergence Failure in a Generative Adversarial Network</li>
</ol>
<h2>How To Train a Stable Generative Adversarial Network</h2>
<p>In this section, we will train a stable GAN to generate images of a handwritten digit.</p>
<p>Specifically, we will use the digit ‘8’ from the MNIST handwritten digit dataset.</p>
<p>The results of this model will establish both a stable GAN that can 
be used for later experimentation and a profile for what generated 
images and learning curves look like for a stable GAN training process.</p>
<p>The first step is to define the models.</p>
<p>The discriminator model takes as input one 28×28 grayscale image and 
outputs a binary prediction as to whether the image is real (<em>class=1</em>) or fake (<em>class=0</em>). It is implemented as a modest convolutional neural network using best practices for GAN design such as using the <a href="https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/">LeakyReLU activation function</a> with a slope of 0.2,&nbsp;a <a href="https://machinelearningmastery.com/padding-and-stride-for-convolutional-neural-networks/">2×2 stride to downsample</a>, and the <a href="https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/">adam version of stochastic gradient descent</a> with a learning rate of 0.0002 and a momentum of 0.5</p>
<p>The <em>define_discriminator()</em> function below implements this, 
defining and compiling the discriminator model and returning it. The 
input shape of the image is parameterized as a default function argument
 to make it clear.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fc4988422090" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># define the standalone discriminator model
def define_discriminator(in_shape=(28,28,1)):
	# weight initialization
	init = RandomNormal(stddev=0.02)
	# define model
	model = Sequential()
	# downsample to 14x14
	model.add(Conv2D(64, (4,4), strides=(2,2), padding='same', kernel_initializer=init, input_shape=in_shape))
	model.add(LeakyReLU(alpha=0.2))
	# downsample to 7x7
	model.add(Conv2D(64, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# classifier
	model.add(Flatten())
	model.add(Dense(1, activation='sigmoid'))
	# compile model
	opt = Adam(lr=0.0002, beta_1=0.5)
	model.compile(loss='binary_crossentropy', optimizer=opt, metrics=['accuracy'])
	return model</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fc4988422090-19">19</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-1"><span class="crayon-p"># define the standalone discriminator model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-2"><span class="crayon-e">def </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-v">in_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-3"><span class="crayon-h">	</span><span class="crayon-p"># weight initialization</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-4"><span class="crayon-h">	</span><span class="crayon-v">init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomNormal</span><span class="crayon-sy">(</span><span class="crayon-v">stddev</span><span class="crayon-o">=</span><span class="crayon-cn">0.02</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-5"><span class="crayon-h">	</span><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-7"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 14x14</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-8"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-v">in_shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-9"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-10"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 7x7</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-12"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-13"><span class="crayon-h">	</span><span class="crayon-p"># classifier</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-14"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-15"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-16"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-17"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.0002</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta_1</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-18"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fc4988422090-19"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>The generator model takes as input a point in the latent 
space and outputs a single 28×28 grayscale image. This is achieved by 
using a fully connected layer to interpret the point in the latent space
 and provide sufficient activations that can be reshaped into many 
copies (in this case, 128) of a low-resolution version of the output 
image (e.g. 7×7). This is then upsampled two times, doubling the size 
and quadrupling the area of the activations each time using transpose 
convolutional layers. The model uses best practices such as the 
LeakyReLU activation, a kernel size that is a factor of the stride size,
 and a hyperbolic tangent (tanh) activation function in the output 
layer.</p>
<div class="woo-sc-hr"></div>
<center>
<h3>Want to Develop GANs from Scratch?</h3>
<p>Take my free 7-day email crash course now (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><script src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/embed.js" async="" defer="defer"></script> <button data-leadbox-popup="gccVwqnxKjFwG4uJPQpXwM" data-leadbox-domain="machinelearningmastery.lpages.co" style="background: rgb(255, 215, 18);border-color: rgb(255, 215, 18);border-radius: 20px;color: #FFFFFF;display: inline-block;vertical-align: middle;padding: 16px 32px;min-width: 192px;border: 1px solid rgb(255, 215, 18);font-size: 1rem;font-family: Helvetica, Arial, sans-serif;text-align: center;outline: 0;line-height: 1;cursor: pointer;-webkit-transition: background 0.3s, color 0.3s, border 0.3s;transition: background 0.3s, color 0.3s, border 0.3s;  box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.6);">Download Your FREE Mini-Course</button> 
</p>
</center>
<div class="woo-sc-hr"></div>
<p>The <em>define_generator()</em> function below defines the generator 
model, but intentionally does not compile it as it is not trained 
directly, then returns the model. The size of the latent space is 
parameterized as a function argument.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fca972200511" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># define the standalone generator model
def define_generator(latent_dim):
	# weight initialization
	init = RandomNormal(stddev=0.02)
	# define model
	model = Sequential()
	# foundation for 7x7 image
	n_nodes = 128 * 7 * 7
	model.add(Dense(n_nodes, kernel_initializer=init, input_dim=latent_dim))
	model.add(LeakyReLU(alpha=0.2))
	model.add(Reshape((7, 7, 128)))
	# upsample to 14x14
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# upsample to 28x28
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# output 28x28x1
	model.add(Conv2D(1, (7,7), activation='tanh', padding='same', kernel_initializer=init))
	return model</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fca972200511-20">20</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-1"><span class="crayon-p"># define the standalone generator model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-2"><span class="crayon-e">def </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-3"><span class="crayon-h">	</span><span class="crayon-p"># weight initialization</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-4"><span class="crayon-h">	</span><span class="crayon-v">init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomNormal</span><span class="crayon-sy">(</span><span class="crayon-v">stddev</span><span class="crayon-o">=</span><span class="crayon-cn">0.02</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-5"><span class="crayon-h">	</span><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-7"><span class="crayon-h">	</span><span class="crayon-p"># foundation for 7x7 image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-8"><span class="crayon-h">	</span><span class="crayon-v">n_nodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-9"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">n_nodes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-10"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-12"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 14x14</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-13"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-14"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-15"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 28x28</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-16"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-17"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-18"><span class="crayon-h">	</span><span class="crayon-p"># output 28x28x1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-19"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'tanh'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fca972200511-20"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Next, a GAN model can be defined that combines both the 
generator model and the discriminator model into one larger model. This 
larger model will be used to train the model weights in the generator, 
using the output and error calculated by the discriminator model. The 
discriminator model is trained separately, and as such, the model 
weights are marked as not trainable in this larger GAN model to ensure 
that only the weights of the generator model are updated. This change to
 the trainability of the discriminator weights only has an effect when 
training the combined GAN model, not when training the discriminator 
standalone.</p>
<p>This larger GAN model takes as input a point in the latent space, 
uses the generator model to generate an image, which is fed as input to 
the discriminator model, then output or classified as real or fake.</p>
<p>The <em>define_gan()</em> function below implements this, taking the already defined generator and discriminator models as input.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fcc300479789" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># define the combined generator and discriminator model, for updating the generator
def define_gan(generator, discriminator):
	# make weights in the discriminator not trainable
	discriminator.trainable = False
	# connect them
	model = Sequential()
	# add generator
	model.add(generator)
	# add the discriminator
	model.add(discriminator)
	# compile model
	opt = Adam(lr=0.0002, beta_1=0.5)
	model.compile(loss='binary_crossentropy', optimizer=opt)
	return model</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcc300479789-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-1"><span class="crayon-p"># define the combined generator and discriminator model, for updating the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-2"><span class="crayon-e">def </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-3"><span class="crayon-h">	</span><span class="crayon-p"># make weights in the discriminator not trainable</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-4"><span class="crayon-h">	</span><span class="crayon-v">discriminator</span><span class="crayon-sy">.</span><span class="crayon-v">trainable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-5"><span class="crayon-h">	</span><span class="crayon-p"># connect them</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-6"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-7"><span class="crayon-h">	</span><span class="crayon-p"># add generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-8"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-9"><span class="crayon-h">	</span><span class="crayon-p"># add the discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-10"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-11"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-12"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.0002</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta_1</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-13"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcc300479789-14"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Now that we have defined the GAN model, we need to train it. But, before we can train the model, we require input data.</p>
<p>The first step is to load and scale the MNIST dataset. The whole dataset is loaded via a call to the <em>load_data()</em>
 Keras function, then a subset of the images are selected (about 5,000) 
that belong to class 8, e.g. are a handwritten depiction of the number 
eight. Then the pixel values must be scaled to the range [-1,1] to match
 the output of the generator model.</p>
<p>The <em>load_real_samples()</em> function below implements this, returning the loaded and scaled subset of the MNIST training dataset ready for modeling.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fcd131728188" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># load mnist images
def load_real_samples():
	# load dataset
	(trainX, trainy), (_, _) = load_data()
	# expand to 3d, e.g. add channels
	X = expand_dims(trainX, axis=-1)
	# select all of the examples for a given class
	selected_ix = trainy == 8
	X = X[selected_ix]
	# convert from ints to floats
	X = X.astype('float32')
	# scale from [0,255] to [-1,1]
	X = (X - 127.5) / 127.5
	return X</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcd131728188-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-1"><span class="crayon-p"># load mnist images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-2"><span class="crayon-e">def </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-3"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-4"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-5"><span class="crayon-h">	</span><span class="crayon-p"># expand to 3d, e.g. add channels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-6"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-7"><span class="crayon-h">	</span><span class="crayon-p"># select all of the examples for a given class</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-8"><span class="crayon-h">	</span><span class="crayon-v">selected_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-9"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">selected_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-10"><span class="crayon-h">	</span><span class="crayon-p"># convert from ints to floats</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-11"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-12"><span class="crayon-h">	</span><span class="crayon-p"># scale from [0,255] to [-1,1]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-13"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcd131728188-14"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We will require one (or a half) batch of real images from the
 dataset each update to the GAN model. A simple way to achieve this is 
to select a random sample of images from the dataset each time.</p>
<p>The <em>generate_real_samples()</em> function below implements this, 
taking the prepared dataset as an argument, selecting and returning a 
random sample of face images, and their corresponding class label for 
the discriminator, specifically class=1 indicating that they are real 
images.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fcf847310160" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># select real samples
def generate_real_samples(dataset, n_samples):
	# choose random instances
	ix = randint(0, dataset.shape[0], n_samples)
	# select images
	X = dataset[ix]
	# generate class labels
	y = ones((n_samples, 1))
	return X, y</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcf847310160-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcf847310160-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcf847310160-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcf847310160-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcf847310160-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcf847310160-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcf847310160-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fcf847310160-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fcf847310160-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcf847310160-1"><span class="crayon-p"># select real samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcf847310160-2"><span class="crayon-e">def </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcf847310160-3"><span class="crayon-h">	</span><span class="crayon-p"># choose random instances</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcf847310160-4"><span class="crayon-h">	</span><span class="crayon-v">ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randint</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcf847310160-5"><span class="crayon-h">	</span><span class="crayon-p"># select images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcf847310160-6"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcf847310160-7"><span class="crayon-h">	</span><span class="crayon-p"># generate class labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fcf847310160-8"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fcf847310160-9"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Next, we need inputs for the generator model. These are random points from the latent space, specifically <a href="https://machinelearningmastery.com/how-to-generate-random-numbers-in-python/">Gaussian distributed random variables</a>.</p>
<p>The <em>generate_latent_points()</em> function implements this, 
taking the size of the latent space as an argument and the number of 
points required, and returning them as a batch of input samples for the 
generator model.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fd0158900747" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># generate points in latent space as input for the generator
def generate_latent_points(latent_dim, n_samples):
	# generate points in the latent space
	x_input = randn(latent_dim * n_samples)
	# reshape into a batch of inputs for the network
	x_input = x_input.reshape(n_samples, latent_dim)
	return x_input</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd0158900747-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd0158900747-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd0158900747-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd0158900747-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd0158900747-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd0158900747-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd0158900747-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd0158900747-1"><span class="crayon-p"># generate points in latent space as input for the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd0158900747-2"><span class="crayon-e">def </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd0158900747-3"><span class="crayon-h">	</span><span class="crayon-p"># generate points in the latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd0158900747-4"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-e ">latent_dim *</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd0158900747-5"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a batch of inputs for the network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd0158900747-6"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd0158900747-7"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Next, we need to use the points in the latent space as input to the generator in order to generate new images.</p>
<p>The <em>generate_fake_samples()</em> function below implements this, 
taking the generator model and size of the latent space as arguments, 
then generating points in the latent space and using them as input to 
the generator model. The function returns the generated images and their
 corresponding class label for the discriminator model, specifically 
class=0 to indicate they are fake or generated.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fd1270212595" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># use the generator to generate n fake examples, with class labels
def generate_fake_samples(generator, latent_dim, n_samples):
	# generate points in latent space
	x_input = generate_latent_points(latent_dim, n_samples)
	# predict outputs
	X = generator.predict(x_input)
	# create class labels
	y = zeros((n_samples, 1))
	return X, y</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd1270212595-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd1270212595-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd1270212595-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd1270212595-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd1270212595-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd1270212595-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd1270212595-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd1270212595-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd1270212595-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd1270212595-1"><span class="crayon-p"># use the generator to generate n fake examples, with class labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd1270212595-2"><span class="crayon-e">def </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd1270212595-3"><span class="crayon-h">	</span><span class="crayon-p"># generate points in latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd1270212595-4"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd1270212595-5"><span class="crayon-h">	</span><span class="crayon-p"># predict outputs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd1270212595-6"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">generator</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd1270212595-7"><span class="crayon-h">	</span><span class="crayon-p"># create class labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd1270212595-8"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd1270212595-9"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We need to record the performance of the model. Perhaps the 
most reliable way to evaluate the performance of a GAN is to use the 
generator to generate images, and then review and subjectively evaluate 
them.</p>
<p>The <em>summarize_performance()</em> function below takes the 
generator model at a given point during training and uses it to generate
 100 images in a 10×10 grid that are then plotted and saved to file. The
 model is also saved to file at this time, in case we would like to use 
it later to generate more images.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fd2751539525" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># generate samples and save as a plot and save the model
def summarize_performance(step, g_model, latent_dim, n_samples=100):
	# prepare fake examples
	X, _ = generate_fake_samples(g_model, latent_dim, n_samples)
	# scale from [-1,1] to [0,1]
	X = (X + 1) / 2.0
	# plot images
	for i in range(10 * 10):
		# define subplot
		pyplot.subplot(10, 10, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(X[i, :, :, 0], cmap='gray_r')
	# save plot to file
	pyplot.savefig('results_baseline/generated_plot_%03d.png' % (step+1))
	pyplot.close()
	# save the generator model
	g_model.save('results_baseline/model_%03d.h5' % (step+1))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd2751539525-19">19</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-1"><span class="crayon-p"># generate samples and save as a plot and save the model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-2"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-3"><span class="crayon-h">	</span><span class="crayon-p"># prepare fake examples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-4"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-5"><span class="crayon-h">	</span><span class="crayon-p"># scale from [-1,1] to [0,1]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-6"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-7"><span class="crayon-h">	</span><span class="crayon-p"># plot images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-8"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-9"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-10"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-11"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-12"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-13"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-14"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-s">'gray_r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-15"><span class="crayon-h">	</span><span class="crayon-p"># save plot to file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-16"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'results_baseline/generated_plot_%03d.png'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-17"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-18"><span class="crayon-h">	</span><span class="crayon-p"># save the generator model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd2751539525-19"><span class="crayon-h">	</span><span class="crayon-v">g_model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">'results_baseline/model_%03d.h5'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>In addition to image quality, it is a good idea to keep track of the loss and accuracy of the model over time.</p>
<p>The loss and classification accuracy for the discriminator for real 
and fake samples can be tracked for each model update, as can the loss 
for the generator for each update. These can then be used to create line
 plots of loss and accuracy at the end of the training run.</p>
<p>The <em>plot_history()</em> function below implements this and saves the results to file.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fd3334361652" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># create a line plot of loss for the gan and save to file
def plot_history(d1_hist, d2_hist, g_hist, a1_hist, a2_hist):
	# plot loss
	pyplot.subplot(2, 1, 1)
	pyplot.plot(d1_hist, label='d-real')
	pyplot.plot(d2_hist, label='d-fake')
	pyplot.plot(g_hist, label='gen')
	pyplot.legend()
	# plot discriminator accuracy
	pyplot.subplot(2, 1, 2)
	pyplot.plot(a1_hist, label='acc-real')
	pyplot.plot(a2_hist, label='acc-fake')
	pyplot.legend()
	# save plot to file
	pyplot.savefig('results_baseline/plot_line_plot_loss.png')
	pyplot.close()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd3334361652-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-1"><span class="crayon-p"># create a line plot of loss for the gan and save to file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-2"><span class="crayon-e">def </span><span class="crayon-e">plot_history</span><span class="crayon-sy">(</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2_hist</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-3"><span class="crayon-h">	</span><span class="crayon-p"># plot loss</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-4"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-5"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'d-real'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-6"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'d-fake'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-7"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'gen'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-8"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-9"><span class="crayon-h">	</span><span class="crayon-p"># plot discriminator accuracy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-10"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-11"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'acc-real'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-12"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">a2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'acc-fake'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-13"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-14"><span class="crayon-h">	</span><span class="crayon-p"># save plot to file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-15"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'results_baseline/plot_line_plot_loss.png'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd3334361652-16"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We are now ready to fit the GAN model.</p>
<p>The model is fit for 10 training epochs, which is arbitrary, as the 
model begins generating plausible number-8 digits after perhaps the 
first few epochs. A batch size of 128 samples is used, and each training
 epoch involves 5,851/128 or about 45 batches of real and fake samples 
and updates to the model. The model is therefore trained for 10 epochs 
of 45 batches, or 450 iterations.</p>
<p>First, the discriminator model is updated for a half batch of real 
samples, then a half batch of fake samples, together forming one batch 
of weight updates. The generator is then updated via the composite GAN 
model. Importantly, the class label is set to 1, or real, for the fake 
samples. This has the effect of updating the generator toward getting 
better at generating real samples on the next batch.</p>
<p>The <em>train()</em> function below implements this, taking the 
defined models, dataset, and size of the latent dimension as arguments 
and parameterizing the number of epochs and batch size with default 
arguments. The generator model is saved at the end of training.</p>
<p>The performance of the discriminator and generator models is reported
 each iteration. Sample images are generated and saved every epoch, and 
line plots of model performance are created and saved at the end of the 
run.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fd4681662570" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># train the generator and discriminator
def train(g_model, d_model, gan_model, dataset, latent_dim, n_epochs=10, n_batch=128):
	# calculate the number of batches per epoch
	bat_per_epo = int(dataset.shape[0] / n_batch)
	# calculate the total iterations based on batch and epoch
	n_steps = bat_per_epo * n_epochs
	# calculate the number of samples in half a batch
	half_batch = int(n_batch / 2)
	# prepare lists for storing stats each iteration
	d1_hist, d2_hist, g_hist, a1_hist, a2_hist = list(), list(), list(), list(), list()
	# manually enumerate epochs
	for i in range(n_steps):
		# get randomly selected 'real' samples
		X_real, y_real = generate_real_samples(dataset, half_batch)
		# update discriminator model weights
		d_loss1, d_acc1 = d_model.train_on_batch(X_real, y_real)
		# generate 'fake' examples
		X_fake, y_fake = generate_fake_samples(g_model, latent_dim, half_batch)
		# update discriminator model weights
		d_loss2, d_acc2 = d_model.train_on_batch(X_fake, y_fake)
		# prepare points in latent space as input for the generator
		X_gan = generate_latent_points(latent_dim, n_batch)
		# create inverted labels for the fake samples
		y_gan = ones((n_batch, 1))
		# update the generator via the discriminator's error
		g_loss = gan_model.train_on_batch(X_gan, y_gan)
		# summarize loss on this batch
		print('&gt;%d, d1=%.3f, d2=%.3f g=%.3f, a1=%d, a2=%d' %
			(i+1, d_loss1, d_loss2, g_loss, int(100*d_acc1), int(100*d_acc2)))
		# record history
		d1_hist.append(d_loss1)
		d2_hist.append(d_loss2)
		g_hist.append(g_loss)
		a1_hist.append(d_acc1)
		a2_hist.append(d_acc2)
		# evaluate the model performance every 'epoch'
		if (i+1) % bat_per_epo == 0:
			summarize_performance(i, g_model, latent_dim)
	plot_history(d1_hist, d2_hist, g_hist, a1_hist, a2_hist)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd4681662570-39">39</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-1"><span class="crayon-p"># train the generator and discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-2"><span class="crayon-e">def </span><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-o">=</span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-3"><span class="crayon-h">	</span><span class="crayon-p"># calculate the number of batches per epoch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-4"><span class="crayon-h">	</span><span class="crayon-v">bat_per_epo</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-5"><span class="crayon-h">	</span><span class="crayon-p"># calculate the total iterations based on batch and epoch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-6"><span class="crayon-h">	</span><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">bat_per_epo *</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">_</span>epochs</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-7"><span class="crayon-h">	</span><span class="crayon-p"># calculate the number of samples in half a batch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-8"><span class="crayon-h">	</span><span class="crayon-v">half_batch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-9"><span class="crayon-h">	</span><span class="crayon-p"># prepare lists for storing stats each iteration</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-10"><span class="crayon-h">	</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2_hist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-11"><span class="crayon-h">	</span><span class="crayon-p"># manually enumerate epochs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-12"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-13"><span class="crayon-h">		</span><span class="crayon-p"># get randomly selected 'real' samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-14"><span class="crayon-h">		</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-15"><span class="crayon-h">		</span><span class="crayon-p"># update discriminator model weights</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-16"><span class="crayon-h">		</span><span class="crayon-v">d_loss1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_acc1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-17"><span class="crayon-h">		</span><span class="crayon-p"># generate 'fake' examples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-18"><span class="crayon-h">		</span><span class="crayon-v">X_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-19"><span class="crayon-h">		</span><span class="crayon-p"># update discriminator model weights</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-20"><span class="crayon-h">		</span><span class="crayon-v">d_loss2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_acc2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-21"><span class="crayon-h">		</span><span class="crayon-p"># prepare points in latent space as input for the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-22"><span class="crayon-h">		</span><span class="crayon-v">X_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-23"><span class="crayon-h">		</span><span class="crayon-p"># create inverted labels for the fake samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-24"><span class="crayon-h">		</span><span class="crayon-v">y_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-25"><span class="crayon-h">		</span><span class="crayon-p"># update the generator via the discriminator's error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-26"><span class="crayon-h">		</span><span class="crayon-v">g_loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_gan</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_gan</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-27"><span class="crayon-h">		</span><span class="crayon-p"># summarize loss on this batch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-28"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%d, d1=%.3f, d2=%.3f g=%.3f, a1=%d, a2=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-29"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_loss1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_loss2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-o">*</span><span class="crayon-v">d_acc1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-o">*</span><span class="crayon-v">d_acc2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-30"><span class="crayon-h">		</span><span class="crayon-p"># record history</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-31"><span class="crayon-h">		</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_loss1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-32"><span class="crayon-h">		</span><span class="crayon-v">d2_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_loss2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-33"><span class="crayon-h">		</span><span class="crayon-v">g_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">g_loss</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-34"><span class="crayon-h">		</span><span class="crayon-v">a1_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_acc1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-35"><span class="crayon-h">		</span><span class="crayon-v">a2_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_acc2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-36"><span class="crayon-h">		</span><span class="crayon-p"># evaluate the model performance every 'epoch'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-37"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">bat_per_epo</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-38"><span class="crayon-h">			</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd4681662570-39"><span class="crayon-h">	</span><span class="crayon-e">plot_history</span><span class="crayon-sy">(</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2_hist</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Now that all of the functions have been defined, we can 
create the directory where images and models will be stored (in this 
case ‘<em>results_baseline</em>‘), create the models, load the dataset, and begin the training process.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fd6229022134" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># make folder for results
makedirs('results_baseline', exist_ok=True)
# size of the latent space
latent_dim = 50
# create the discriminator
discriminator = define_discriminator()
# create the generator
generator = define_generator(latent_dim)
# create the gan
gan_model = define_gan(generator, discriminator)
# load image data
dataset = load_real_samples()
print(dataset.shape)
# train model
train(generator, discriminator, gan_model, dataset, latent_dim)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd6229022134-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-1"><span class="crayon-p"># make folder for results</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-2"><span class="crayon-e">makedirs</span><span class="crayon-sy">(</span><span class="crayon-s">'results_baseline'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">exist_ok</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-3"><span class="crayon-p"># size of the latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-4"><span class="crayon-v">latent_dim</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-5"><span class="crayon-p"># create the discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-6"><span class="crayon-v">discriminator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-7"><span class="crayon-p"># create the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-8"><span class="crayon-v">generator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-9"><span class="crayon-p"># create the gan</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-10"><span class="crayon-v">gan_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-11"><span class="crayon-p"># load image data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-12"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-13"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-14"><span class="crayon-p"># train model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd6229022134-15"><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Tying all of this together, the complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fd7946982667" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># example of training a stable gan for generating a handwritten digit
from os import makedirs
from numpy import expand_dims
from numpy import zeros
from numpy import ones
from numpy.random import randn
from numpy.random import randint
from keras.datasets.mnist import load_data
from keras.optimizers import Adam
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Reshape
from keras.layers import Flatten
from keras.layers import Conv2D
from keras.layers import Conv2DTranspose
from keras.layers import LeakyReLU
from keras.initializers import RandomNormal
from matplotlib import pyplot

# define the standalone discriminator model
def define_discriminator(in_shape=(28,28,1)):
	# weight initialization
	init = RandomNormal(stddev=0.02)
	# define model
	model = Sequential()
	# downsample to 14x14
	model.add(Conv2D(64, (4,4), strides=(2,2), padding='same', kernel_initializer=init, input_shape=in_shape))
	model.add(LeakyReLU(alpha=0.2))
	# downsample to 7x7
	model.add(Conv2D(64, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# classifier
	model.add(Flatten())
	model.add(Dense(1, activation='sigmoid'))
	# compile model
	opt = Adam(lr=0.0002, beta_1=0.5)
	model.compile(loss='binary_crossentropy', optimizer=opt, metrics=['accuracy'])
	return model

# define the standalone generator model
def define_generator(latent_dim):
	# weight initialization
	init = RandomNormal(stddev=0.02)
	# define model
	model = Sequential()
	# foundation for 7x7 image
	n_nodes = 128 * 7 * 7
	model.add(Dense(n_nodes, kernel_initializer=init, input_dim=latent_dim))
	model.add(LeakyReLU(alpha=0.2))
	model.add(Reshape((7, 7, 128)))
	# upsample to 14x14
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# upsample to 28x28
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# output 28x28x1
	model.add(Conv2D(1, (7,7), activation='tanh', padding='same', kernel_initializer=init))
	return model

# define the combined generator and discriminator model, for updating the generator
def define_gan(generator, discriminator):
	# make weights in the discriminator not trainable
	discriminator.trainable = False
	# connect them
	model = Sequential()
	# add generator
	model.add(generator)
	# add the discriminator
	model.add(discriminator)
	# compile model
	opt = Adam(lr=0.0002, beta_1=0.5)
	model.compile(loss='binary_crossentropy', optimizer=opt)
	return model

# load mnist images
def load_real_samples():
	# load dataset
	(trainX, trainy), (_, _) = load_data()
	# expand to 3d, e.g. add channels
	X = expand_dims(trainX, axis=-1)
	# select all of the examples for a given class
	selected_ix = trainy == 8
	X = X[selected_ix]
	# convert from ints to floats
	X = X.astype('float32')
	# scale from [0,255] to [-1,1]
	X = (X - 127.5) / 127.5
	return X

# select real samples
def generate_real_samples(dataset, n_samples):
	# choose random instances
	ix = randint(0, dataset.shape[0], n_samples)
	# select images
	X = dataset[ix]
	# generate class labels
	y = ones((n_samples, 1))
	return X, y

# generate points in latent space as input for the generator
def generate_latent_points(latent_dim, n_samples):
	# generate points in the latent space
	x_input = randn(latent_dim * n_samples)
	# reshape into a batch of inputs for the network
	x_input = x_input.reshape(n_samples, latent_dim)
	return x_input

# use the generator to generate n fake examples, with class labels
def generate_fake_samples(generator, latent_dim, n_samples):
	# generate points in latent space
	x_input = generate_latent_points(latent_dim, n_samples)
	# predict outputs
	X = generator.predict(x_input)
	# create class labels
	y = zeros((n_samples, 1))
	return X, y

# generate samples and save as a plot and save the model
def summarize_performance(step, g_model, latent_dim, n_samples=100):
	# prepare fake examples
	X, _ = generate_fake_samples(g_model, latent_dim, n_samples)
	# scale from [-1,1] to [0,1]
	X = (X + 1) / 2.0
	# plot images
	for i in range(10 * 10):
		# define subplot
		pyplot.subplot(10, 10, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(X[i, :, :, 0], cmap='gray_r')
	# save plot to file
	pyplot.savefig('results_baseline/generated_plot_%03d.png' % (step+1))
	pyplot.close()
	# save the generator model
	g_model.save('results_baseline/model_%03d.h5' % (step+1))

# create a line plot of loss for the gan and save to file
def plot_history(d1_hist, d2_hist, g_hist, a1_hist, a2_hist):
	# plot loss
	pyplot.subplot(2, 1, 1)
	pyplot.plot(d1_hist, label='d-real')
	pyplot.plot(d2_hist, label='d-fake')
	pyplot.plot(g_hist, label='gen')
	pyplot.legend()
	# plot discriminator accuracy
	pyplot.subplot(2, 1, 2)
	pyplot.plot(a1_hist, label='acc-real')
	pyplot.plot(a2_hist, label='acc-fake')
	pyplot.legend()
	# save plot to file
	pyplot.savefig('results_baseline/plot_line_plot_loss.png')
	pyplot.close()

# train the generator and discriminator
def train(g_model, d_model, gan_model, dataset, latent_dim, n_epochs=10, n_batch=128):
	# calculate the number of batches per epoch
	bat_per_epo = int(dataset.shape[0] / n_batch)
	# calculate the total iterations based on batch and epoch
	n_steps = bat_per_epo * n_epochs
	# calculate the number of samples in half a batch
	half_batch = int(n_batch / 2)
	# prepare lists for storing stats each iteration
	d1_hist, d2_hist, g_hist, a1_hist, a2_hist = list(), list(), list(), list(), list()
	# manually enumerate epochs
	for i in range(n_steps):
		# get randomly selected 'real' samples
		X_real, y_real = generate_real_samples(dataset, half_batch)
		# update discriminator model weights
		d_loss1, d_acc1 = d_model.train_on_batch(X_real, y_real)
		# generate 'fake' examples
		X_fake, y_fake = generate_fake_samples(g_model, latent_dim, half_batch)
		# update discriminator model weights
		d_loss2, d_acc2 = d_model.train_on_batch(X_fake, y_fake)
		# prepare points in latent space as input for the generator
		X_gan = generate_latent_points(latent_dim, n_batch)
		# create inverted labels for the fake samples
		y_gan = ones((n_batch, 1))
		# update the generator via the discriminator's error
		g_loss = gan_model.train_on_batch(X_gan, y_gan)
		# summarize loss on this batch
		print('&gt;%d, d1=%.3f, d2=%.3f g=%.3f, a1=%d, a2=%d' %
			(i+1, d_loss1, d_loss2, g_loss, int(100*d_acc1), int(100*d_acc2)))
		# record history
		d1_hist.append(d_loss1)
		d2_hist.append(d_loss2)
		g_hist.append(g_loss)
		a1_hist.append(d_acc1)
		a2_hist.append(d_acc2)
		# evaluate the model performance every 'epoch'
		if (i+1) % bat_per_epo == 0:
			summarize_performance(i, g_model, latent_dim)
	plot_history(d1_hist, d2_hist, g_hist, a1_hist, a2_hist)

# make folder for results
makedirs('results_baseline', exist_ok=True)
# size of the latent space
latent_dim = 50
# create the discriminator
discriminator = define_discriminator()
# create the generator
generator = define_generator(latent_dim)
# create the gan
gan_model = define_gan(generator, discriminator)
# load image data
dataset = load_real_samples()
print(dataset.shape)
# train model
train(generator, discriminator, gan_model, dataset, latent_dim)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-112">112</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-113">113</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-114">114</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-115">115</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-116">116</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-117">117</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-118">118</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-119">119</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-120">120</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-121">121</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-122">122</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-123">123</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-124">124</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-125">125</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-126">126</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-127">127</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-128">128</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-129">129</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-130">130</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-131">131</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-132">132</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-133">133</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-134">134</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-135">135</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-136">136</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-137">137</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-138">138</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-139">139</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-140">140</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-141">141</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-142">142</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-143">143</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-144">144</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-145">145</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-146">146</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-147">147</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-148">148</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-149">149</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-150">150</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-151">151</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-152">152</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-153">153</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-154">154</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-155">155</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-156">156</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-157">157</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-158">158</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-159">159</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-160">160</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-161">161</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-162">162</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-163">163</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-164">164</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-165">165</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-166">166</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-167">167</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-168">168</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-169">169</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-170">170</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-171">171</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-172">172</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-173">173</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-174">174</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-175">175</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-176">176</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-177">177</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-178">178</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-179">179</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-180">180</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-181">181</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-182">182</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-183">183</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-184">184</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-185">185</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-186">186</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-187">187</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-188">188</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-189">189</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-190">190</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-191">191</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-192">192</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-193">193</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-194">194</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-195">195</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-196">196</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-197">197</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-198">198</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-199">199</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-200">200</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-201">201</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-202">202</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-203">203</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-204">204</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-205">205</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-206">206</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-207">207</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-208">208</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-209">209</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd7946982667-210">210</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-1"><span class="crayon-p"># example of training a stable gan for generating a handwritten digit</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">makedirs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">expand_dims</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">zeros</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-5"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">ones</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-6"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randn</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-7"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randint</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">datasets</span><span class="crayon-sy">.</span><span class="crayon-e">mnist </span><span class="crayon-e">import </span><span class="crayon-e">load_data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-e">Adam</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-11"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-12"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Reshape</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-13"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-14"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-15"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2DTranspose</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-16"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LeakyReLU</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-17"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">initializers </span><span class="crayon-e">import </span><span class="crayon-e">RandomNormal</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-18"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-i">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-20"><span class="crayon-p"># define the standalone discriminator model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-21"><span class="crayon-e">def </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-v">in_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-22"><span class="crayon-h">	</span><span class="crayon-p"># weight initialization</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-23"><span class="crayon-h">	</span><span class="crayon-v">init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomNormal</span><span class="crayon-sy">(</span><span class="crayon-v">stddev</span><span class="crayon-o">=</span><span class="crayon-cn">0.02</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-24"><span class="crayon-h">	</span><span class="crayon-p"># define model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-25"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-26"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 14x14</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-27"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-v">in_shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-28"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-29"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 7x7</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-30"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-31"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-32"><span class="crayon-h">	</span><span class="crayon-p"># classifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-33"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-34"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-35"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-36"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.0002</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta_1</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-37"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-38"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-40"><span class="crayon-p"># define the standalone generator model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-41"><span class="crayon-e">def </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-42"><span class="crayon-h">	</span><span class="crayon-p"># weight initialization</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-43"><span class="crayon-h">	</span><span class="crayon-v">init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomNormal</span><span class="crayon-sy">(</span><span class="crayon-v">stddev</span><span class="crayon-o">=</span><span class="crayon-cn">0.02</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-44"><span class="crayon-h">	</span><span class="crayon-p"># define model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-45"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-46"><span class="crayon-h">	</span><span class="crayon-p"># foundation for 7x7 image</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-47"><span class="crayon-h">	</span><span class="crayon-v">n_nodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-48"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">n_nodes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-49"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-50"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-51"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 14x14</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-52"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-53"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-54"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 28x28</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-55"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-56"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-57"><span class="crayon-h">	</span><span class="crayon-p"># output 28x28x1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-58"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'tanh'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-59"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-60">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-61"><span class="crayon-p"># define the combined generator and discriminator model, for updating the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-62"><span class="crayon-e">def </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-63"><span class="crayon-h">	</span><span class="crayon-p"># make weights in the discriminator not trainable</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-64"><span class="crayon-h">	</span><span class="crayon-v">discriminator</span><span class="crayon-sy">.</span><span class="crayon-v">trainable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-65"><span class="crayon-h">	</span><span class="crayon-p"># connect them</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-66"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-67"><span class="crayon-h">	</span><span class="crayon-p"># add generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-68"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-69"><span class="crayon-h">	</span><span class="crayon-p"># add the discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-70"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-71"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-72"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.0002</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta_1</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-73"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-74"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-75">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-76"><span class="crayon-p"># load mnist images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-77"><span class="crayon-e">def </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-78"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-79"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-80"><span class="crayon-h">	</span><span class="crayon-p"># expand to 3d, e.g. add channels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-81"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-82"><span class="crayon-h">	</span><span class="crayon-p"># select all of the examples for a given class</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-83"><span class="crayon-h">	</span><span class="crayon-v">selected_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-84"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">selected_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-85"><span class="crayon-h">	</span><span class="crayon-p"># convert from ints to floats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-86"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-87"><span class="crayon-h">	</span><span class="crayon-p"># scale from [0,255] to [-1,1]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-88"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-89"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">X</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-90">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-91"><span class="crayon-p"># select real samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-92"><span class="crayon-e">def </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-93"><span class="crayon-h">	</span><span class="crayon-p"># choose random instances</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-94"><span class="crayon-h">	</span><span class="crayon-v">ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randint</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-95"><span class="crayon-h">	</span><span class="crayon-p"># select images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-96"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-97"><span class="crayon-h">	</span><span class="crayon-p"># generate class labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-98"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-99"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-100">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-101"><span class="crayon-p"># generate points in latent space as input for the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-102"><span class="crayon-e">def </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-103"><span class="crayon-h">	</span><span class="crayon-p"># generate points in the latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-104"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-e ">latent_dim *</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-105"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a batch of inputs for the network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-106"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-107"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">_</span>input</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-108">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-109"><span class="crayon-p"># use the generator to generate n fake examples, with class labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-110"><span class="crayon-e">def </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-111"><span class="crayon-h">	</span><span class="crayon-p"># generate points in latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-112"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-113"><span class="crayon-h">	</span><span class="crayon-p"># predict outputs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-114"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">generator</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-115"><span class="crayon-h">	</span><span class="crayon-p"># create class labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-116"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-117"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-118">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-119"><span class="crayon-p"># generate samples and save as a plot and save the model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-120"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-121"><span class="crayon-h">	</span><span class="crayon-p"># prepare fake examples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-122"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-123"><span class="crayon-h">	</span><span class="crayon-p"># scale from [-1,1] to [0,1]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-124"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-125"><span class="crayon-h">	</span><span class="crayon-p"># plot images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-126"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-127"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-128"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-129"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-130"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-131"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-132"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-s">'gray_r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-133"><span class="crayon-h">	</span><span class="crayon-p"># save plot to file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-134"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'results_baseline/generated_plot_%03d.png'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-135"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-136"><span class="crayon-h">	</span><span class="crayon-p"># save the generator model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-137"><span class="crayon-h">	</span><span class="crayon-v">g_model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">'results_baseline/model_%03d.h5'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-138">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-139"><span class="crayon-p"># create a line plot of loss for the gan and save to file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-140"><span class="crayon-e">def </span><span class="crayon-e">plot_history</span><span class="crayon-sy">(</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2_hist</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-141"><span class="crayon-h">	</span><span class="crayon-p"># plot loss</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-142"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-143"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'d-real'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-144"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'d-fake'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-145"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'gen'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-146"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-147"><span class="crayon-h">	</span><span class="crayon-p"># plot discriminator accuracy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-148"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-149"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'acc-real'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-150"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">a2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'acc-fake'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-151"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-152"><span class="crayon-h">	</span><span class="crayon-p"># save plot to file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-153"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'results_baseline/plot_line_plot_loss.png'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-154"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-155">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-156"><span class="crayon-p"># train the generator and discriminator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-157"><span class="crayon-e">def </span><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-o">=</span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-158"><span class="crayon-h">	</span><span class="crayon-p"># calculate the number of batches per epoch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-159"><span class="crayon-h">	</span><span class="crayon-v">bat_per_epo</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-160"><span class="crayon-h">	</span><span class="crayon-p"># calculate the total iterations based on batch and epoch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-161"><span class="crayon-h">	</span><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">bat_per_epo *</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">_</span>epochs</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-162"><span class="crayon-h">	</span><span class="crayon-p"># calculate the number of samples in half a batch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-163"><span class="crayon-h">	</span><span class="crayon-v">half_batch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-164"><span class="crayon-h">	</span><span class="crayon-p"># prepare lists for storing stats each iteration</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-165"><span class="crayon-h">	</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2_hist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-166"><span class="crayon-h">	</span><span class="crayon-p"># manually enumerate epochs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-167"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-168"><span class="crayon-h">		</span><span class="crayon-p"># get randomly selected 'real' samples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-169"><span class="crayon-h">		</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-170"><span class="crayon-h">		</span><span class="crayon-p"># update discriminator model weights</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-171"><span class="crayon-h">		</span><span class="crayon-v">d_loss1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_acc1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-172"><span class="crayon-h">		</span><span class="crayon-p"># generate 'fake' examples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-173"><span class="crayon-h">		</span><span class="crayon-v">X_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-174"><span class="crayon-h">		</span><span class="crayon-p"># update discriminator model weights</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-175"><span class="crayon-h">		</span><span class="crayon-v">d_loss2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_acc2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-176"><span class="crayon-h">		</span><span class="crayon-p"># prepare points in latent space as input for the generator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-177"><span class="crayon-h">		</span><span class="crayon-v">X_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-178"><span class="crayon-h">		</span><span class="crayon-p"># create inverted labels for the fake samples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-179"><span class="crayon-h">		</span><span class="crayon-v">y_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-180"><span class="crayon-h">		</span><span class="crayon-p"># update the generator via the discriminator's error</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-181"><span class="crayon-h">		</span><span class="crayon-v">g_loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_gan</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_gan</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-182"><span class="crayon-h">		</span><span class="crayon-p"># summarize loss on this batch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-183"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%d, d1=%.3f, d2=%.3f g=%.3f, a1=%d, a2=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-184"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_loss1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_loss2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-o">*</span><span class="crayon-v">d_acc1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-o">*</span><span class="crayon-v">d_acc2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-185"><span class="crayon-h">		</span><span class="crayon-p"># record history</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-186"><span class="crayon-h">		</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_loss1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-187"><span class="crayon-h">		</span><span class="crayon-v">d2_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_loss2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-188"><span class="crayon-h">		</span><span class="crayon-v">g_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">g_loss</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-189"><span class="crayon-h">		</span><span class="crayon-v">a1_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_acc1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-190"><span class="crayon-h">		</span><span class="crayon-v">a2_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_acc2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-191"><span class="crayon-h">		</span><span class="crayon-p"># evaluate the model performance every 'epoch'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-192"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">bat_per_epo</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-193"><span class="crayon-h">			</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-194"><span class="crayon-h">	</span><span class="crayon-e">plot_history</span><span class="crayon-sy">(</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2_hist</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-195">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-196"><span class="crayon-p"># make folder for results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-197"><span class="crayon-e">makedirs</span><span class="crayon-sy">(</span><span class="crayon-s">'results_baseline'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">exist_ok</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-198"><span class="crayon-p"># size of the latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-199"><span class="crayon-v">latent_dim</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-200"><span class="crayon-p"># create the discriminator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-201"><span class="crayon-v">discriminator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-202"><span class="crayon-p"># create the generator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-203"><span class="crayon-v">generator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-204"><span class="crayon-p"># create the gan</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-205"><span class="crayon-v">gan_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-206"><span class="crayon-p"># load image data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-207"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-208"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-209"><span class="crayon-p"># train model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd7946982667-210"><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example is quick, taking approximately 10 minutes on modern hardware without a GPU.</p>
<p>Your specific results will vary given the stochastic nature of the 
learning algorithm. Nevertheless, the general structure of training 
should be very similar.</p>
<p>First, the loss and accuracy of the discriminator and loss for the 
generator model are reported to the console each iteration of the 
training loop.</p>
<p>This is important. A stable GAN will have a discriminator loss around
 0.5, typically between 0.5 and maybe as high as 0.7 or 0.8. The 
generator loss is typically higher and may hover around 1.0, 1.5, 2.0, 
or even higher.</p>
<p>The accuracy of the discriminator on both real and generated (fake) 
images will not be 50%, but should typically hover around 70% to 80%.</p>
<p>For both the discriminator and generator, behaviors are likely to 
start off erratic and move around a lot before the model converges to a 
stable equilibrium.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fd9486361618" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft">&gt;1, d1=0.859, d2=0.664 g=0.872, a1=37, a2=59
&gt;2, d1=0.190, d2=1.429 g=0.555, a1=100, a2=10
&gt;3, d1=0.094, d2=1.467 g=0.597, a1=100, a2=4
&gt;4, d1=0.097, d2=1.315 g=0.686, a1=100, a2=9
&gt;5, d1=0.100, d2=1.241 g=0.714, a1=100, a2=9
...
&gt;446, d1=0.593, d2=0.546 g=1.330, a1=76, a2=82
&gt;447, d1=0.551, d2=0.739 g=0.981, a1=82, a2=39
&gt;448, d1=0.628, d2=0.505 g=1.420, a1=79, a2=89
&gt;449, d1=0.641, d2=0.533 g=1.381, a1=60, a2=85
&gt;450, d1=0.550, d2=0.731 g=1.100, a1=76, a2=42</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd9486361618-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd9486361618-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd9486361618-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd9486361618-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd9486361618-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd9486361618-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd9486361618-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd9486361618-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd9486361618-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fd9486361618-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fd9486361618-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd9486361618-1">&gt;1, d1=0.859, d2=0.664 g=0.872, a1=37, a2=59</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd9486361618-2">&gt;2, d1=0.190, d2=1.429 g=0.555, a1=100, a2=10</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd9486361618-3">&gt;3, d1=0.094, d2=1.467 g=0.597, a1=100, a2=4</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd9486361618-4">&gt;4, d1=0.097, d2=1.315 g=0.686, a1=100, a2=9</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd9486361618-5">&gt;5, d1=0.100, d2=1.241 g=0.714, a1=100, a2=9</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd9486361618-6">...</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd9486361618-7">&gt;446, d1=0.593, d2=0.546 g=1.330, a1=76, a2=82</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd9486361618-8">&gt;447, d1=0.551, d2=0.739 g=0.981, a1=82, a2=39</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd9486361618-9">&gt;448, d1=0.628, d2=0.505 g=1.420, a1=79, a2=89</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fd9486361618-10">&gt;449, d1=0.641, d2=0.533 g=1.381, a1=60, a2=85</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fd9486361618-11">&gt;450, d1=0.550, d2=0.731 g=1.100, a1=76, a2=42</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Line plots for loss and accuracy are created and saved at the end of the run.</p>
<p>The figure contains two subplots. The top subplot shows line plots 
for the discriminator loss for real images (blue), discriminator loss 
for generated fake images (orange), and the generator loss for generated
 fake images (green).</p>
<p>We can see that all three losses are somewhat erratic early in the 
run before stabilizing around epoch 100 to epoch 300. Losses remain 
stable after that, although the variance increases.</p>
<p>This is an example of the normal or expected loss during training. 
Namely, discriminator loss for real and fake samples is about the same 
at or around 0.5, and loss for the generator is slightly higher between 
0.5 and 2.0. If the generator model is capable of generating plausible 
images, then the expectation is that those images would have been 
generated between epochs 100 and 300 and likely between 300 and 450 as 
well.</p>
<p>The bottom subplot shows a line plot of the discriminator accuracy on
 real (blue) and fake (orange) images during training. We see a similar 
structure as the subplot of loss, namely that accuracy starts off quite 
different between the two image types, then stabilizes between epochs 
100 to 300 at around 70% to 80%, and remains stable beyond that, 
although with increased variance.</p>
<p>The time scales (e.g. number of iterations or training epochs) for 
these patterns and absolute values will vary across problems and types 
of GAN models, although the plot provides a good baseline for what to 
expect when training a stable GAN model.</p>
<div id="attachment_8174" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8174" loading="lazy" class="size-full wp-image-8174" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Line-Plots-of-Loss-and-Accuracy-for-a-Stable-Generative-_002.png" alt="Line Plots of Loss and Accuracy for a Stable Generative Adversarial Network" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Line-Plots-of-Loss-and-Accuracy-for-a-Stable-Generative-_002.png 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Line-Plots-of-Loss-and-Accuracy-for-a-Stable-Generative-Adve.png 300w" sizes="(max-width: 640px) 100vw, 640px" width="640" height="480"><p id="caption-attachment-8174" class="wp-caption-text">Line Plots of Loss and Accuracy for a Stable Generative Adversarial Network</p></div>
<p>Finally, we can review samples of generated images. Note: we are 
generating images using a reverse grayscale color map, meaning that the 
normal white figure on a background is inverted to a black figure on a 
white background. This was done to make the generated figures easier to 
review.</p>
<p>As we might expect, samples of images generated before epoch 100 are relatively poor in quality.</p>
<div id="attachment_8175" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8175" loading="lazy" class="size-full wp-image-8175" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_010.png" alt="Sample of 100 Generated Images of a Handwritten Number 8 at Epoch 45 From a Stable GAN." srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_010.png 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_009.png 300w" sizes="(max-width: 640px) 100vw, 640px" width="640" height="480"><p id="caption-attachment-8175" class="wp-caption-text">Sample of 100 Generated Images of a Handwritten Number 8 at Epoch 45 From a Stable GAN.</p></div>
<p>Samples of images generated between epochs 100 and 300 are plausible, and perhaps the best quality.</p>
<div id="attachment_8176" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8176" loading="lazy" class="size-full wp-image-8176" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_005.png" alt="Sample of 100 Generated Images of a Handwritten Number 8 at Epoch 180 From a Stable GAN." srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_005.png 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_003.png 300w" sizes="(max-width: 640px) 100vw, 640px" width="640" height="480"><p id="caption-attachment-8176" class="wp-caption-text">Sample of 100 Generated Images of a Handwritten Number 8 at Epoch 180 From a Stable GAN.</p></div>
<p>And samples of generated images after epoch 300 remain plausible, although perhaps have more noise, e.g. background noise.</p>
<div id="attachment_8177" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8177" loading="lazy" class="size-full wp-image-8177" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_012.png" alt="Sample of 100 Generated Images of a Handwritten Number 8 at Epoch 450 From a Stable GAN." srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_012.png 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_011.png 300w" sizes="(max-width: 640px) 100vw, 640px" width="640" height="480"><p id="caption-attachment-8177" class="wp-caption-text">Sample of 100 Generated Images of a Handwritten Number 8 at Epoch 450 From a Stable GAN.</p></div>
<p>These results are important, as it highlights that the quality 
generated can and does vary across the run, even after the training 
process becomes stable.</p>
<p>More training iterations, beyond some point of training stability may or may not result in higher quality images.</p>
<p>We can summarize these observations for stable GAN training as follows:</p>
<ul>
<li>Discriminator loss on real and fake images is expected to sit around 0.5.</li>
<li>Generator loss on fake images is expected to sit between 0.5 and perhaps 2.0.</li>
<li>Discriminator accuracy on real and fake images is expected to sit around 80%.</li>
<li>Variance of generator and discriminator loss is expected to remain modest.</li>
<li>The generator is expected to produce its highest quality images during a period of stability.</li>
<li>Training stability may degenerate into periods of high-variance loss and corresponding lower quality generated images.</li>
</ul>
<p>Now that we have a stable GAN model, we can look into modifying it to produce some specific failure cases.</p>
<p>There are two failure cases that are common to see when training GAN 
models on new problems; they are mode collapse and convergence failure.</p>
<div id="AdThrive_Content_2_desktop" class="adthrive-ad adthrive-content adthrive-content-1 adthrive-ad-cls" style="min-height: 250px;" data-google-query-id="CJ6DuOPgvvgCFXIJaAgdfgAGEw"><div id="google_ads_iframe_/18190176,22523581566/AdThrive_Content_2/5d4c8ca4693e634b2e5d98cf_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/18190176,22523581566/AdThrive_Content_2/5d4c8ca4693e634b2e5d98cf_0" name="google_ads_iframe_/18190176,22523581566/AdThrive_Content_2/5d4c8ca4693e634b2e5d98cf_0" title="3rd party ad content" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" role="region" aria-label="Advertisement" tabindex="0" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="1" data-load-complete="true" width="728" height="90" frameborder="0"></iframe></div></div><h2>How To Identify a Mode Collapse in a Generative Adversarial Network</h2>
<p>A mode collapse refers to a generator model that is only capable of 
generating one or a small subset of different outcomes, or modes.</p>
<p>Here, mode refers to an output distribution, e.g. a multi-modal 
function refers to a function with more than one peak or optima. With a 
GAN generator model, a mode failure means that the vast number of points
 in the input latent space (e.g. hypersphere of 100 dimensions in many 
cases) result in one or a small subset of generated images.</p>
<blockquote><p>Mode collapse, also known as the scenario, is a problem 
that occurs when the generator learns to map several different input z 
values to the same output point.</p></blockquote>
<p>— <a href="https://arxiv.org/abs/1701.00160">NIPS 2016 Tutorial: Generative Adversarial Networks</a>, 2016.</p>
<p>A mode collapse can be identified when reviewing a large sample of 
generated images. The images will show low diversity, with the same 
identical image or same small subset of identical images repeating many 
times.</p>
<p>A mode collapse can also be identified by reviewing the line plot of 
model loss. The line plot will show oscillations in the loss over time, 
most notably in the generator model, as the generator model is updated 
and jumps from generating one mode to another model that has different 
loss.</p>
<p>We can impair our stable GAN to suffer mode collapse a number of 
ways. Perhaps the most reliable is to restrict the size of the latent 
dimension directly, forcing the model to only generate a small subset of
 plausible outputs.</p>
<p>Specifically, the ‘<em>latent_dim</em>‘ variable can be changed from 100 to 1, and the experiment re-run.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fe1128094238" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># size of the latent space
latent_dim = 1</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe1128094238-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe1128094238-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe1128094238-1"><span class="crayon-p"># size of the latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe1128094238-2"><span class="crayon-v">latent_dim</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>The full code listing is provided below for completeness.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fe2493368894" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># example of training an unstable gan for generating a handwritten digit
from os import makedirs
from numpy import expand_dims
from numpy import zeros
from numpy import ones
from numpy.random import randn
from numpy.random import randint
from keras.datasets.mnist import load_data
from keras.optimizers import Adam
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Reshape
from keras.layers import Flatten
from keras.layers import Conv2D
from keras.layers import Conv2DTranspose
from keras.layers import LeakyReLU
from keras.initializers import RandomNormal
from matplotlib import pyplot

# define the standalone discriminator model
def define_discriminator(in_shape=(28,28,1)):
	# weight initialization
	init = RandomNormal(stddev=0.02)
	# define model
	model = Sequential()
	# downsample to 14x14
	model.add(Conv2D(64, (4,4), strides=(2,2), padding='same', kernel_initializer=init, input_shape=in_shape))
	model.add(LeakyReLU(alpha=0.2))
	# downsample to 7x7
	model.add(Conv2D(64, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# classifier
	model.add(Flatten())
	model.add(Dense(1, activation='sigmoid'))
	# compile model
	opt = Adam(lr=0.0002, beta_1=0.5)
	model.compile(loss='binary_crossentropy', optimizer=opt, metrics=['accuracy'])
	return model

# define the standalone generator model
def define_generator(latent_dim):
	# weight initialization
	init = RandomNormal(stddev=0.02)
	# define model
	model = Sequential()
	# foundation for 7x7 image
	n_nodes = 128 * 7 * 7
	model.add(Dense(n_nodes, kernel_initializer=init, input_dim=latent_dim))
	model.add(LeakyReLU(alpha=0.2))
	model.add(Reshape((7, 7, 128)))
	# upsample to 14x14
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# upsample to 28x28
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# output 28x28x1
	model.add(Conv2D(1, (7,7), activation='tanh', padding='same', kernel_initializer=init))
	return model

# define the combined generator and discriminator model, for updating the generator
def define_gan(generator, discriminator):
	# make weights in the discriminator not trainable
	discriminator.trainable = False
	# connect them
	model = Sequential()
	# add generator
	model.add(generator)
	# add the discriminator
	model.add(discriminator)
	# compile model
	opt = Adam(lr=0.0002, beta_1=0.5)
	model.compile(loss='binary_crossentropy', optimizer=opt)
	return model

# load mnist images
def load_real_samples():
	# load dataset
	(trainX, trainy), (_, _) = load_data()
	# expand to 3d, e.g. add channels
	X = expand_dims(trainX, axis=-1)
	# select all of the examples for a given class
	selected_ix = trainy == 8
	X = X[selected_ix]
	# convert from ints to floats
	X = X.astype('float32')
	# scale from [0,255] to [-1,1]
	X = (X - 127.5) / 127.5
	return X

# # select real samples
def generate_real_samples(dataset, n_samples):
	# choose random instances
	ix = randint(0, dataset.shape[0], n_samples)
	# select images
	X = dataset[ix]
	# generate class labels
	y = ones((n_samples, 1))
	return X, y

# generate points in latent space as input for the generator
def generate_latent_points(latent_dim, n_samples):
	# generate points in the latent space
	x_input = randn(latent_dim * n_samples)
	# reshape into a batch of inputs for the network
	x_input = x_input.reshape(n_samples, latent_dim)
	return x_input

# use the generator to generate n fake examples, with class labels
def generate_fake_samples(generator, latent_dim, n_samples):
	# generate points in latent space
	x_input = generate_latent_points(latent_dim, n_samples)
	# predict outputs
	X = generator.predict(x_input)
	# create class labels
	y = zeros((n_samples, 1))
	return X, y

# generate samples and save as a plot and save the model
def summarize_performance(step, g_model, latent_dim, n_samples=100):
	# prepare fake examples
	X, _ = generate_fake_samples(g_model, latent_dim, n_samples)
	# scale from [-1,1] to [0,1]
	X = (X + 1) / 2.0
	# plot images
	for i in range(10 * 10):
		# define subplot
		pyplot.subplot(10, 10, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(X[i, :, :, 0], cmap='gray_r')
	# save plot to file
	pyplot.savefig('results_collapse/generated_plot_%03d.png' % (step+1))
	pyplot.close()
	# save the generator model
	g_model.save('results_collapse/model_%03d.h5' % (step+1))

# create a line plot of loss for the gan and save to file
def plot_history(d1_hist, d2_hist, g_hist, a1_hist, a2_hist):
	# plot loss
	pyplot.subplot(2, 1, 1)
	pyplot.plot(d1_hist, label='d-real')
	pyplot.plot(d2_hist, label='d-fake')
	pyplot.plot(g_hist, label='gen')
	pyplot.legend()
	# plot discriminator accuracy
	pyplot.subplot(2, 1, 2)
	pyplot.plot(a1_hist, label='acc-real')
	pyplot.plot(a2_hist, label='acc-fake')
	pyplot.legend()
	# save plot to file
	pyplot.savefig('results_collapse/plot_line_plot_loss.png')
	pyplot.close()

# train the generator and discriminator
def train(g_model, d_model, gan_model, dataset, latent_dim, n_epochs=10, n_batch=128):
	# calculate the number of batches per epoch
	bat_per_epo = int(dataset.shape[0] / n_batch)
	# calculate the total iterations based on batch and epoch
	n_steps = bat_per_epo * n_epochs
	# calculate the number of samples in half a batch
	half_batch = int(n_batch / 2)
	# prepare lists for storing stats each iteration
	d1_hist, d2_hist, g_hist, a1_hist, a2_hist = list(), list(), list(), list(), list()
	# manually enumerate epochs
	for i in range(n_steps):
		# get randomly selected 'real' samples
		X_real, y_real = generate_real_samples(dataset, half_batch)
		# update discriminator model weights
		d_loss1, d_acc1 = d_model.train_on_batch(X_real, y_real)
		# generate 'fake' examples
		X_fake, y_fake = generate_fake_samples(g_model, latent_dim, half_batch)
		# update discriminator model weights
		d_loss2, d_acc2 = d_model.train_on_batch(X_fake, y_fake)
		# prepare points in latent space as input for the generator
		X_gan = generate_latent_points(latent_dim, n_batch)
		# create inverted labels for the fake samples
		y_gan = ones((n_batch, 1))
		# update the generator via the discriminator's error
		g_loss = gan_model.train_on_batch(X_gan, y_gan)
		# summarize loss on this batch
		print('&gt;%d, d1=%.3f, d2=%.3f g=%.3f, a1=%d, a2=%d' %
			(i+1, d_loss1, d_loss2, g_loss, int(100*d_acc1), int(100*d_acc2)))
		# record history
		d1_hist.append(d_loss1)
		d2_hist.append(d_loss2)
		g_hist.append(g_loss)
		a1_hist.append(d_acc1)
		a2_hist.append(d_acc2)
		# evaluate the model performance every 'epoch'
		if (i+1) % bat_per_epo == 0:
			summarize_performance(i, g_model, latent_dim)
	plot_history(d1_hist, d2_hist, g_hist, a1_hist, a2_hist)

# make folder for results
makedirs('results_collapse', exist_ok=True)
# size of the latent space
latent_dim = 1
# create the discriminator
discriminator = define_discriminator()
# create the generator
generator = define_generator(latent_dim)
# create the gan
gan_model = define_gan(generator, discriminator)
# load image data
dataset = load_real_samples()
print(dataset.shape)
# train model
train(generator, discriminator, gan_model, dataset, latent_dim)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-112">112</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-113">113</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-114">114</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-115">115</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-116">116</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-117">117</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-118">118</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-119">119</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-120">120</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-121">121</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-122">122</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-123">123</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-124">124</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-125">125</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-126">126</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-127">127</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-128">128</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-129">129</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-130">130</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-131">131</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-132">132</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-133">133</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-134">134</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-135">135</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-136">136</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-137">137</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-138">138</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-139">139</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-140">140</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-141">141</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-142">142</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-143">143</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-144">144</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-145">145</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-146">146</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-147">147</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-148">148</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-149">149</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-150">150</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-151">151</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-152">152</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-153">153</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-154">154</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-155">155</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-156">156</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-157">157</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-158">158</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-159">159</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-160">160</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-161">161</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-162">162</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-163">163</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-164">164</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-165">165</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-166">166</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-167">167</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-168">168</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-169">169</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-170">170</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-171">171</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-172">172</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-173">173</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-174">174</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-175">175</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-176">176</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-177">177</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-178">178</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-179">179</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-180">180</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-181">181</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-182">182</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-183">183</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-184">184</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-185">185</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-186">186</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-187">187</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-188">188</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-189">189</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-190">190</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-191">191</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-192">192</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-193">193</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-194">194</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-195">195</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-196">196</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-197">197</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-198">198</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-199">199</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-200">200</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-201">201</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-202">202</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-203">203</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-204">204</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-205">205</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-206">206</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-207">207</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-208">208</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-209">209</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe2493368894-210">210</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-1"><span class="crayon-p"># example of training an unstable gan for generating a handwritten digit</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">makedirs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">expand_dims</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">zeros</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-5"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">ones</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-6"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randn</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-7"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randint</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">datasets</span><span class="crayon-sy">.</span><span class="crayon-e">mnist </span><span class="crayon-e">import </span><span class="crayon-e">load_data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-e">Adam</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-11"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-12"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Reshape</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-13"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-14"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-15"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2DTranspose</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-16"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LeakyReLU</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-17"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">initializers </span><span class="crayon-e">import </span><span class="crayon-e">RandomNormal</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-18"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-i">pyplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-20"><span class="crayon-p"># define the standalone discriminator model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-21"><span class="crayon-e">def </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-v">in_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-22"><span class="crayon-h">	</span><span class="crayon-p"># weight initialization</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-23"><span class="crayon-h">	</span><span class="crayon-v">init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomNormal</span><span class="crayon-sy">(</span><span class="crayon-v">stddev</span><span class="crayon-o">=</span><span class="crayon-cn">0.02</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-24"><span class="crayon-h">	</span><span class="crayon-p"># define model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-25"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-26"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 14x14</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-27"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-v">in_shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-28"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-29"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 7x7</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-30"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-31"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-32"><span class="crayon-h">	</span><span class="crayon-p"># classifier</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-33"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-34"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-35"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-36"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.0002</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta_1</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-37"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-38"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-40"><span class="crayon-p"># define the standalone generator model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-41"><span class="crayon-e">def </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-42"><span class="crayon-h">	</span><span class="crayon-p"># weight initialization</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-43"><span class="crayon-h">	</span><span class="crayon-v">init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomNormal</span><span class="crayon-sy">(</span><span class="crayon-v">stddev</span><span class="crayon-o">=</span><span class="crayon-cn">0.02</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-44"><span class="crayon-h">	</span><span class="crayon-p"># define model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-45"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-46"><span class="crayon-h">	</span><span class="crayon-p"># foundation for 7x7 image</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-47"><span class="crayon-h">	</span><span class="crayon-v">n_nodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-48"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">n_nodes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-49"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-50"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-51"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 14x14</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-52"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-53"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-54"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 28x28</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-55"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-56"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-57"><span class="crayon-h">	</span><span class="crayon-p"># output 28x28x1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-58"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'tanh'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-59"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-60">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-61"><span class="crayon-p"># define the combined generator and discriminator model, for updating the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-62"><span class="crayon-e">def </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-63"><span class="crayon-h">	</span><span class="crayon-p"># make weights in the discriminator not trainable</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-64"><span class="crayon-h">	</span><span class="crayon-v">discriminator</span><span class="crayon-sy">.</span><span class="crayon-v">trainable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-65"><span class="crayon-h">	</span><span class="crayon-p"># connect them</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-66"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-67"><span class="crayon-h">	</span><span class="crayon-p"># add generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-68"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-69"><span class="crayon-h">	</span><span class="crayon-p"># add the discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-70"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-71"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-72"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.0002</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta_1</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-73"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-74"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-75">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-76"><span class="crayon-p"># load mnist images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-77"><span class="crayon-e">def </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-78"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-79"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-80"><span class="crayon-h">	</span><span class="crayon-p"># expand to 3d, e.g. add channels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-81"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-82"><span class="crayon-h">	</span><span class="crayon-p"># select all of the examples for a given class</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-83"><span class="crayon-h">	</span><span class="crayon-v">selected_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-84"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">selected_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-85"><span class="crayon-h">	</span><span class="crayon-p"># convert from ints to floats</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-86"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-87"><span class="crayon-h">	</span><span class="crayon-p"># scale from [0,255] to [-1,1]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-88"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-89"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">X</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-90">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-91"><span class="crayon-p"># # select real samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-92"><span class="crayon-e">def </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-93"><span class="crayon-h">	</span><span class="crayon-p"># choose random instances</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-94"><span class="crayon-h">	</span><span class="crayon-v">ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randint</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-95"><span class="crayon-h">	</span><span class="crayon-p"># select images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-96"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">ix</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-97"><span class="crayon-h">	</span><span class="crayon-p"># generate class labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-98"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-99"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-100">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-101"><span class="crayon-p"># generate points in latent space as input for the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-102"><span class="crayon-e">def </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-103"><span class="crayon-h">	</span><span class="crayon-p"># generate points in the latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-104"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-e ">latent_dim *</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-105"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a batch of inputs for the network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-106"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-107"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">_</span>input</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-108">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-109"><span class="crayon-p"># use the generator to generate n fake examples, with class labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-110"><span class="crayon-e">def </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-111"><span class="crayon-h">	</span><span class="crayon-p"># generate points in latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-112"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-113"><span class="crayon-h">	</span><span class="crayon-p"># predict outputs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-114"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">generator</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-115"><span class="crayon-h">	</span><span class="crayon-p"># create class labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-116"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-117"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-118">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-119"><span class="crayon-p"># generate samples and save as a plot and save the model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-120"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-121"><span class="crayon-h">	</span><span class="crayon-p"># prepare fake examples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-122"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-123"><span class="crayon-h">	</span><span class="crayon-p"># scale from [-1,1] to [0,1]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-124"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-125"><span class="crayon-h">	</span><span class="crayon-p"># plot images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-126"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-127"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-128"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-129"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-130"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-131"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-132"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-s">'gray_r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-133"><span class="crayon-h">	</span><span class="crayon-p"># save plot to file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-134"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'results_collapse/generated_plot_%03d.png'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-135"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-136"><span class="crayon-h">	</span><span class="crayon-p"># save the generator model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-137"><span class="crayon-h">	</span><span class="crayon-v">g_model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">'results_collapse/model_%03d.h5'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-138">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-139"><span class="crayon-p"># create a line plot of loss for the gan and save to file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-140"><span class="crayon-e">def </span><span class="crayon-e">plot_history</span><span class="crayon-sy">(</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2_hist</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-141"><span class="crayon-h">	</span><span class="crayon-p"># plot loss</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-142"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-143"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'d-real'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-144"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'d-fake'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-145"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'gen'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-146"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-147"><span class="crayon-h">	</span><span class="crayon-p"># plot discriminator accuracy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-148"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-149"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'acc-real'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-150"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">a2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'acc-fake'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-151"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-152"><span class="crayon-h">	</span><span class="crayon-p"># save plot to file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-153"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'results_collapse/plot_line_plot_loss.png'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-154"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-155">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-156"><span class="crayon-p"># train the generator and discriminator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-157"><span class="crayon-e">def </span><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-o">=</span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-158"><span class="crayon-h">	</span><span class="crayon-p"># calculate the number of batches per epoch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-159"><span class="crayon-h">	</span><span class="crayon-v">bat_per_epo</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-160"><span class="crayon-h">	</span><span class="crayon-p"># calculate the total iterations based on batch and epoch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-161"><span class="crayon-h">	</span><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">bat_per_epo *</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">_</span>epochs</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-162"><span class="crayon-h">	</span><span class="crayon-p"># calculate the number of samples in half a batch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-163"><span class="crayon-h">	</span><span class="crayon-v">half_batch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-164"><span class="crayon-h">	</span><span class="crayon-p"># prepare lists for storing stats each iteration</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-165"><span class="crayon-h">	</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2_hist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-166"><span class="crayon-h">	</span><span class="crayon-p"># manually enumerate epochs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-167"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-168"><span class="crayon-h">		</span><span class="crayon-p"># get randomly selected 'real' samples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-169"><span class="crayon-h">		</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-170"><span class="crayon-h">		</span><span class="crayon-p"># update discriminator model weights</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-171"><span class="crayon-h">		</span><span class="crayon-v">d_loss1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_acc1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-172"><span class="crayon-h">		</span><span class="crayon-p"># generate 'fake' examples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-173"><span class="crayon-h">		</span><span class="crayon-v">X_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-174"><span class="crayon-h">		</span><span class="crayon-p"># update discriminator model weights</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-175"><span class="crayon-h">		</span><span class="crayon-v">d_loss2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_acc2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-176"><span class="crayon-h">		</span><span class="crayon-p"># prepare points in latent space as input for the generator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-177"><span class="crayon-h">		</span><span class="crayon-v">X_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-178"><span class="crayon-h">		</span><span class="crayon-p"># create inverted labels for the fake samples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-179"><span class="crayon-h">		</span><span class="crayon-v">y_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-180"><span class="crayon-h">		</span><span class="crayon-p"># update the generator via the discriminator's error</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-181"><span class="crayon-h">		</span><span class="crayon-v">g_loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_gan</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_gan</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-182"><span class="crayon-h">		</span><span class="crayon-p"># summarize loss on this batch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-183"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%d, d1=%.3f, d2=%.3f g=%.3f, a1=%d, a2=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-184"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_loss1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_loss2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-o">*</span><span class="crayon-v">d_acc1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-o">*</span><span class="crayon-v">d_acc2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-185"><span class="crayon-h">		</span><span class="crayon-p"># record history</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-186"><span class="crayon-h">		</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_loss1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-187"><span class="crayon-h">		</span><span class="crayon-v">d2_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_loss2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-188"><span class="crayon-h">		</span><span class="crayon-v">g_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">g_loss</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-189"><span class="crayon-h">		</span><span class="crayon-v">a1_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_acc1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-190"><span class="crayon-h">		</span><span class="crayon-v">a2_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_acc2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-191"><span class="crayon-h">		</span><span class="crayon-p"># evaluate the model performance every 'epoch'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-192"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">bat_per_epo</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-193"><span class="crayon-h">			</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-194"><span class="crayon-h">	</span><span class="crayon-e">plot_history</span><span class="crayon-sy">(</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2_hist</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-195">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-196"><span class="crayon-p"># make folder for results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-197"><span class="crayon-e">makedirs</span><span class="crayon-sy">(</span><span class="crayon-s">'results_collapse'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">exist_ok</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-198"><span class="crayon-p"># size of the latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-199"><span class="crayon-v">latent_dim</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-200"><span class="crayon-p"># create the discriminator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-201"><span class="crayon-v">discriminator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-202"><span class="crayon-p"># create the generator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-203"><span class="crayon-v">generator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-204"><span class="crayon-p"># create the gan</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-205"><span class="crayon-v">gan_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-206"><span class="crayon-p"># load image data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-207"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-208"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-209"><span class="crayon-p"># train model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe2493368894-210"><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example will report the loss and accuracy each step of training, as before.</p>
<p>In this case, the loss for the discriminator sits in a sensible 
range, although the loss for the generator jumps up and down. The 
accuracy for the discriminator also shows higher values, many around 
100%, meaning that for many batches, it has perfect skill at identifying
 real or fake examples, a bad sign for image quality or diversity.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fe4280559472" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft">&gt;1, d1=0.963, d2=0.699 g=0.614, a1=28, a2=54
&gt;2, d1=0.185, d2=5.084 g=0.097, a1=96, a2=0
&gt;3, d1=0.088, d2=4.861 g=0.065, a1=100, a2=0
&gt;4, d1=0.077, d2=4.202 g=0.090, a1=100, a2=0
&gt;5, d1=0.062, d2=3.533 g=0.128, a1=100, a2=0
...
&gt;446, d1=0.277, d2=0.261 g=0.684, a1=95, a2=100
&gt;447, d1=0.201, d2=0.247 g=0.713, a1=96, a2=100
&gt;448, d1=0.285, d2=0.285 g=0.728, a1=89, a2=100
&gt;449, d1=0.351, d2=0.467 g=1.184, a1=92, a2=81
&gt;450, d1=0.492, d2=0.388 g=1.351, a1=76, a2=100</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe4280559472-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe4280559472-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe4280559472-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe4280559472-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe4280559472-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe4280559472-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe4280559472-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe4280559472-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe4280559472-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe4280559472-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe4280559472-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe4280559472-1">&gt;1, d1=0.963, d2=0.699 g=0.614, a1=28, a2=54</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe4280559472-2">&gt;2, d1=0.185, d2=5.084 g=0.097, a1=96, a2=0</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe4280559472-3">&gt;3, d1=0.088, d2=4.861 g=0.065, a1=100, a2=0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe4280559472-4">&gt;4, d1=0.077, d2=4.202 g=0.090, a1=100, a2=0</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe4280559472-5">&gt;5, d1=0.062, d2=3.533 g=0.128, a1=100, a2=0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe4280559472-6">...</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe4280559472-7">&gt;446, d1=0.277, d2=0.261 g=0.684, a1=95, a2=100</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe4280559472-8">&gt;447, d1=0.201, d2=0.247 g=0.713, a1=96, a2=100</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe4280559472-9">&gt;448, d1=0.285, d2=0.285 g=0.728, a1=89, a2=100</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe4280559472-10">&gt;449, d1=0.351, d2=0.467 g=1.184, a1=92, a2=81</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe4280559472-11">&gt;450, d1=0.492, d2=0.388 g=1.351, a1=76, a2=100</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>The figure with learning curve and accuracy line plots is created and saved.</p>
<p>In the top subplot, we can see the loss for the generator (green) 
oscillating from sensible to high values over time, with a period of 
about 25 model updates (batches). We can also see some small 
oscillations in the loss for the discriminator on real and fake samples 
(orange and blue).</p>
<p>In the bottom subplot, we can see that the discriminator’s 
classification accuracy for identifying fake images remains high 
throughout the run. This suggests that the generator is poor at 
generating examples in some consistent way that makes it easy for the 
discriminator to identify the fake images.</p>
<div id="attachment_8178" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8178" loading="lazy" class="size-full wp-image-8178" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Line-Plots-of-Loss-and-Accuracy-for-a-Generative-Adversa_002.png" alt="Line Plots of Loss and Accuracy for a Generative Adversarial Network With Mode Collapse" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Line-Plots-of-Loss-and-Accuracy-for-a-Generative-Adversa_002.png 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Line-Plots-of-Loss-and-Accuracy-for-a-Generative-Adversarial.png 300w" sizes="(max-width: 640px) 100vw, 640px" width="640" height="480"><p id="caption-attachment-8178" class="wp-caption-text">Line Plots of Loss and Accuracy for a Generative Adversarial Network With Mode Collapse</p></div>
<p>Reviewing generated images shows the expected feature of mode 
collapse, namely many identical generated examples, regardless of the 
input point in the latent space. It just so happens that we have changed
 the dimensionality of the latent space to be dramatically small to 
force this effect.</p>
<p>I have chosen an example of generated images that helps to make this 
clear. There appear to be only a few types of figure-eights in the 
image, one leaning left, one leaning right, and one sitting up with a 
blur.</p>
<p>I have drawn boxes around some of the similar examples in the image below to make this clearer.</p>
<div id="attachment_8179" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8179" loading="lazy" class="size-full wp-image-8179" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_002.png" alt="Sample of 100 Generated Images of a Handwritten Number 8 at Epoch 315 From a GAN That Has Suffered Mode Collapse." srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_002.png 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_007.png 300w" sizes="(max-width: 640px) 100vw, 640px" width="640" height="480"><p id="caption-attachment-8179" class="wp-caption-text">Sample of 100 Generated Images of a Handwritten Number 8 at Epoch 315 From a GAN That Has Suffered Mode Collapse.</p></div>
<p>A mode collapse is less common during training given the findings from the DCGAN model architecture and training configuration.</p>
<p>In summary, you can identify a mode collapse as follows:</p>
<ul>
<li>The loss for the generator, and probably the discriminator, is expected to oscillate over time.</li>
<li>The generator model is expected to generate identical output images from different points in the latent space.</li>
</ul>
<div id="AdThrive_Content_3_desktop" class="adthrive-ad adthrive-content adthrive-content-1 adthrive-ad-cls" style="min-height: 250px;" data-google-query-id="CI-Yu-PgvvgCFZQMaAgdSHAJIw"><div id="google_ads_iframe_/18190176,22523581566/AdThrive_Content_3/5d4c8ca4693e634b2e5d98cf_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/18190176,22523581566/AdThrive_Content_3/5d4c8ca4693e634b2e5d98cf_0" name="google_ads_iframe_/18190176,22523581566/AdThrive_Content_3/5d4c8ca4693e634b2e5d98cf_0" title="3rd party ad content" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" role="region" aria-label="Advertisement" tabindex="0" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="3" data-load-complete="true" width="728" height="250" frameborder="0"></iframe></div></div><h2>How To Identify Convergence Failure in a Generative Adversarial Network</h2>
<p>Perhaps the most common failure when training a GAN is a failure to converge.</p>
<p>Typically, a neural network fails to converge when the model loss 
does not settle down during the training process. In the case of a GAN, a
 failure to converge refers to not finding an equilibrium between the 
discriminator and the generator.</p>
<p>The likely way that you will identify this type of failure is that 
the loss for the discriminator has gone to zero or close to zero. In 
some cases, the loss of the generator may also rise and continue to rise
 over the same period.</p>
<p>This type of loss is most commonly caused by the generator outputting garbage images that the discriminator can easily identify.</p>
<p>This type of failure might happen at the beginning of the run and 
continue throughout training, at which point you should halt the 
training process. For some unstable GANs, it is possible for the GAN to 
fall into this failure mode for a number of batch updates, or even a 
number of epochs, and then recover.</p>
<p>There are many ways to impair our stable GAN to achieve a convergence
 failure, such as changing one or both models to have insufficient 
capacity, changing the <a href="https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/">Adam optimization algorithm</a> to be too aggressive, and using very large or very small kernel sizes in the models.</p>
<p>In this case, we will update the example to combine the real and fake
 samples when updating the discriminator. This simple change will cause 
the model to fail to converge.</p>
<p>This change is as simple as using the <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.vstack.html">vstack() NumPy function</a> to combine the real and fake samples and then calling the <em>train_on_batch()</em>
 function to update the discriminator model. The result is also a single
 loss and accuracy scores, meaning that the reporting of model 
performance, must also be updated.</p>
<p>The full code listing with these changes is provided below for completeness.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fe6017621622" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># example of training an unstable gan for generating a handwritten digit
from os import makedirs
from numpy import expand_dims
from numpy import zeros
from numpy import ones
from numpy import vstack
from numpy.random import randn
from numpy.random import randint
from keras.datasets.mnist import load_data
from keras.optimizers import Adam
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Reshape
from keras.layers import Flatten
from keras.layers import Conv2D
from keras.layers import Conv2DTranspose
from keras.layers import LeakyReLU
from keras.initializers import RandomNormal
from matplotlib import pyplot

# define the standalone discriminator model
def define_discriminator(in_shape=(28,28,1)):
	# weight initialization
	init = RandomNormal(stddev=0.02)
	# define model
	model = Sequential()
	# downsample to 14x14
	model.add(Conv2D(64, (4,4), strides=(2,2), padding='same', kernel_initializer=init, input_shape=in_shape))
	model.add(LeakyReLU(alpha=0.2))
	# downsample to 7x7
	model.add(Conv2D(64, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# classifier
	model.add(Flatten())
	model.add(Dense(1, activation='sigmoid'))
	# compile model
	opt = Adam(lr=0.0002, beta_1=0.5)
	model.compile(loss='binary_crossentropy', optimizer=opt, metrics=['accuracy'])
	return model

# define the standalone generator model
def define_generator(latent_dim):
	# weight initialization
	init = RandomNormal(stddev=0.02)
	# define model
	model = Sequential()
	# foundation for 7x7 image
	n_nodes = 128 * 7 * 7
	model.add(Dense(n_nodes, kernel_initializer=init, input_dim=latent_dim))
	model.add(LeakyReLU(alpha=0.2))
	model.add(Reshape((7, 7, 128)))
	# upsample to 14x14
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# upsample to 28x28
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# output 28x28x1
	model.add(Conv2D(1, (7,7), activation='tanh', padding='same', kernel_initializer=init))
	return model

# define the combined generator and discriminator model, for updating the generator
def define_gan(generator, discriminator):
	# make weights in the discriminator not trainable
	discriminator.trainable = False
	# connect them
	model = Sequential()
	# add generator
	model.add(generator)
	# add the discriminator
	model.add(discriminator)
	# compile model
	opt = Adam(lr=0.0002, beta_1=0.5)
	model.compile(loss='binary_crossentropy', optimizer=opt)
	return model

# load mnist images
def load_real_samples():
	# load dataset
	(trainX, trainy), (_, _) = load_data()
	# expand to 3d, e.g. add channels
	X = expand_dims(trainX, axis=-1)
	# select all of the examples for a given class
	selected_ix = trainy == 8
	X = X[selected_ix]
	# convert from ints to floats
	X = X.astype('float32')
	# scale from [0,255] to [-1,1]
	X = (X - 127.5) / 127.5
	return X

# # select real samples
def generate_real_samples(dataset, n_samples):
	# choose random instances
	ix = randint(0, dataset.shape[0], n_samples)
	# select images
	X = dataset[ix]
	# generate class labels
	y = ones((n_samples, 1))
	return X, y

# generate points in latent space as input for the generator
def generate_latent_points(latent_dim, n_samples):
	# generate points in the latent space
	x_input = randn(latent_dim * n_samples)
	# reshape into a batch of inputs for the network
	x_input = x_input.reshape(n_samples, latent_dim)
	return x_input

# use the generator to generate n fake examples, with class labels
def generate_fake_samples(generator, latent_dim, n_samples):
	# generate points in latent space
	x_input = generate_latent_points(latent_dim, n_samples)
	# predict outputs
	X = generator.predict(x_input)
	# create class labels
	y = zeros((n_samples, 1))
	return X, y

# generate samples and save as a plot and save the model
def summarize_performance(step, g_model, latent_dim, n_samples=100):
	# prepare fake examples
	X, _ = generate_fake_samples(g_model, latent_dim, n_samples)
	# scale from [-1,1] to [0,1]
	X = (X + 1) / 2.0
	# plot images
	for i in range(10 * 10):
		# define subplot
		pyplot.subplot(10, 10, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(X[i, :, :, 0], cmap='gray_r')
	# save plot to file
	pyplot.savefig('results_convergence/generated_plot_%03d.png' % (step+1))
	pyplot.close()
	# save the generator model
	g_model.save('results_convergence/model_%03d.h5' % (step+1))

# create a line plot of loss for the gan and save to file
def plot_history(d_hist, g_hist, a_hist):
	# plot loss
	pyplot.subplot(2, 1, 1)
	pyplot.plot(d_hist, label='dis')
	pyplot.plot(g_hist, label='gen')
	pyplot.legend()
	# plot discriminator accuracy
	pyplot.subplot(2, 1, 2)
	pyplot.plot(a_hist, label='acc')
	pyplot.legend()
	# save plot to file
	pyplot.savefig('results_convergence/plot_line_plot_loss.png')
	pyplot.close()

# train the generator and discriminator
def train(g_model, d_model, gan_model, dataset, latent_dim, n_epochs=10, n_batch=128):
	# calculate the number of batches per epoch
	bat_per_epo = int(dataset.shape[0] / n_batch)
	# calculate the total iterations based on batch and epoch
	n_steps = bat_per_epo * n_epochs
	# calculate the number of samples in half a batch
	half_batch = int(n_batch / 2)
	# prepare lists for storing stats each iteration
	d_hist, g_hist, a_hist = list(), list(), list()
	# manually enumerate epochs
	for i in range(n_steps):
		# get randomly selected 'real' samples
		X_real, y_real = generate_real_samples(dataset, half_batch)
		# generate 'fake' examples
		X_fake, y_fake = generate_fake_samples(g_model, latent_dim, half_batch)
		# combine into one batch
		X, y = vstack((X_real, X_fake)), vstack((y_real, y_fake))
		# update discriminator model weights
		d_loss, d_acc = d_model.train_on_batch(X, y)
		# prepare points in latent space as input for the generator
		X_gan = generate_latent_points(latent_dim, n_batch)
		# create inverted labels for the fake samples
		y_gan = ones((n_batch, 1))
		# update the generator via the discriminator's error
		g_loss = gan_model.train_on_batch(X_gan, y_gan)
		# summarize loss on this batch
		print('&gt;%d, d=%.3f, g=%.3f, a=%d' % (i+1, d_loss, g_loss, int(100*d_acc)))
		# record history
		d_hist.append(d_loss)
		g_hist.append(g_loss)
		a_hist.append(d_acc)
		# evaluate the model performance every 'epoch'
		if (i+1) % bat_per_epo == 0:
			summarize_performance(i, g_model, latent_dim)
	plot_history(d_hist, g_hist, a_hist)

# make folder for results
makedirs('results_convergence', exist_ok=True)
# size of the latent space
latent_dim = 50
# create the discriminator
discriminator = define_discriminator()
# create the generator
generator = define_generator(latent_dim)
# create the gan
gan_model = define_gan(generator, discriminator)
# load image data
dataset = load_real_samples()
print(dataset.shape)
# train model
train(generator, discriminator, gan_model, dataset, latent_dim)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-112">112</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-113">113</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-114">114</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-115">115</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-116">116</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-117">117</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-118">118</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-119">119</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-120">120</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-121">121</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-122">122</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-123">123</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-124">124</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-125">125</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-126">126</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-127">127</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-128">128</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-129">129</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-130">130</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-131">131</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-132">132</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-133">133</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-134">134</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-135">135</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-136">136</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-137">137</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-138">138</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-139">139</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-140">140</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-141">141</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-142">142</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-143">143</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-144">144</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-145">145</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-146">146</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-147">147</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-148">148</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-149">149</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-150">150</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-151">151</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-152">152</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-153">153</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-154">154</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-155">155</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-156">156</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-157">157</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-158">158</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-159">159</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-160">160</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-161">161</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-162">162</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-163">163</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-164">164</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-165">165</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-166">166</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-167">167</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-168">168</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-169">169</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-170">170</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-171">171</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-172">172</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-173">173</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-174">174</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-175">175</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-176">176</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-177">177</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-178">178</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-179">179</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-180">180</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-181">181</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-182">182</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-183">183</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-184">184</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-185">185</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-186">186</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-187">187</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-188">188</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-189">189</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-190">190</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-191">191</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-192">192</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-193">193</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-194">194</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-195">195</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-196">196</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-197">197</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-198">198</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-199">199</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-200">200</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-201">201</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-202">202</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-203">203</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-204">204</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-205">205</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe6017621622-206">206</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-1"><span class="crayon-p"># example of training an unstable gan for generating a handwritten digit</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">makedirs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">expand_dims</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">zeros</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-5"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">ones</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-6"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">vstack</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-7"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-8"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randint</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">datasets</span><span class="crayon-sy">.</span><span class="crayon-e">mnist </span><span class="crayon-e">import </span><span class="crayon-e">load_data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-e">Adam</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-11"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-12"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-13"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Reshape</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-14"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-15"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-16"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2DTranspose</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-17"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LeakyReLU</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-18"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">initializers </span><span class="crayon-e">import </span><span class="crayon-e">RandomNormal</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-19"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-i">pyplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-20">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-21"><span class="crayon-p"># define the standalone discriminator model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-22"><span class="crayon-e">def </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-v">in_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-23"><span class="crayon-h">	</span><span class="crayon-p"># weight initialization</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-24"><span class="crayon-h">	</span><span class="crayon-v">init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomNormal</span><span class="crayon-sy">(</span><span class="crayon-v">stddev</span><span class="crayon-o">=</span><span class="crayon-cn">0.02</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-25"><span class="crayon-h">	</span><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-26"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-27"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 14x14</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-28"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-v">in_shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-29"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-30"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 7x7</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-31"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-32"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-33"><span class="crayon-h">	</span><span class="crayon-p"># classifier</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-34"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-35"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-36"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-37"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.0002</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta_1</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-38"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-39"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-41"><span class="crayon-p"># define the standalone generator model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-42"><span class="crayon-e">def </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-43"><span class="crayon-h">	</span><span class="crayon-p"># weight initialization</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-44"><span class="crayon-h">	</span><span class="crayon-v">init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomNormal</span><span class="crayon-sy">(</span><span class="crayon-v">stddev</span><span class="crayon-o">=</span><span class="crayon-cn">0.02</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-45"><span class="crayon-h">	</span><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-46"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-47"><span class="crayon-h">	</span><span class="crayon-p"># foundation for 7x7 image</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-48"><span class="crayon-h">	</span><span class="crayon-v">n_nodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-49"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">n_nodes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-50"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-51"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-52"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 14x14</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-53"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-54"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-55"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 28x28</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-56"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-57"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-58"><span class="crayon-h">	</span><span class="crayon-p"># output 28x28x1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-59"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'tanh'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-60"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-61">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-62"><span class="crayon-p"># define the combined generator and discriminator model, for updating the generator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-63"><span class="crayon-e">def </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-64"><span class="crayon-h">	</span><span class="crayon-p"># make weights in the discriminator not trainable</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-65"><span class="crayon-h">	</span><span class="crayon-v">discriminator</span><span class="crayon-sy">.</span><span class="crayon-v">trainable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-66"><span class="crayon-h">	</span><span class="crayon-p"># connect them</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-67"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-68"><span class="crayon-h">	</span><span class="crayon-p"># add generator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-69"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-70"><span class="crayon-h">	</span><span class="crayon-p"># add the discriminator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-71"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-72"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-73"><span class="crayon-h">	</span><span class="crayon-v">opt</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-cn">0.0002</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta_1</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-74"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">opt</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-75"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-76">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-77"><span class="crayon-p"># load mnist images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-78"><span class="crayon-e">def </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-79"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-80"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-81"><span class="crayon-h">	</span><span class="crayon-p"># expand to 3d, e.g. add channels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-82"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-83"><span class="crayon-h">	</span><span class="crayon-p"># select all of the examples for a given class</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-84"><span class="crayon-h">	</span><span class="crayon-v">selected_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-85"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">selected_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-86"><span class="crayon-h">	</span><span class="crayon-p"># convert from ints to floats</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-87"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-88"><span class="crayon-h">	</span><span class="crayon-p"># scale from [0,255] to [-1,1]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-89"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-90"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">X</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-91">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-92"><span class="crayon-p"># # select real samples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-93"><span class="crayon-e">def </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-94"><span class="crayon-h">	</span><span class="crayon-p"># choose random instances</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-95"><span class="crayon-h">	</span><span class="crayon-v">ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randint</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-96"><span class="crayon-h">	</span><span class="crayon-p"># select images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-97"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-98"><span class="crayon-h">	</span><span class="crayon-p"># generate class labels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-99"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-100"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-101">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-102"><span class="crayon-p"># generate points in latent space as input for the generator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-103"><span class="crayon-e">def </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-104"><span class="crayon-h">	</span><span class="crayon-p"># generate points in the latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-105"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-e ">latent_dim *</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-106"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a batch of inputs for the network</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-107"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-108"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">_</span>input</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-109">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-110"><span class="crayon-p"># use the generator to generate n fake examples, with class labels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-111"><span class="crayon-e">def </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-112"><span class="crayon-h">	</span><span class="crayon-p"># generate points in latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-113"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-114"><span class="crayon-h">	</span><span class="crayon-p"># predict outputs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-115"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">generator</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-116"><span class="crayon-h">	</span><span class="crayon-p"># create class labels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-117"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-118"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-119">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-120"><span class="crayon-p"># generate samples and save as a plot and save the model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-121"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-122"><span class="crayon-h">	</span><span class="crayon-p"># prepare fake examples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-123"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-124"><span class="crayon-h">	</span><span class="crayon-p"># scale from [-1,1] to [0,1]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-125"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-126"><span class="crayon-h">	</span><span class="crayon-p"># plot images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-127"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-128"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-129"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-130"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-131"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-132"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-133"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-s">'gray_r'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-134"><span class="crayon-h">	</span><span class="crayon-p"># save plot to file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-135"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'results_convergence/generated_plot_%03d.png'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-136"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-137"><span class="crayon-h">	</span><span class="crayon-p"># save the generator model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-138"><span class="crayon-h">	</span><span class="crayon-v">g_model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">'results_convergence/model_%03d.h5'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-139">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-140"><span class="crayon-p"># create a line plot of loss for the gan and save to file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-141"><span class="crayon-e">def </span><span class="crayon-e">plot_history</span><span class="crayon-sy">(</span><span class="crayon-v">d_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a_hist</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-142"><span class="crayon-h">	</span><span class="crayon-p"># plot loss</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-143"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-144"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">d_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'dis'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-145"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'gen'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-146"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-147"><span class="crayon-h">	</span><span class="crayon-p"># plot discriminator accuracy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-148"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-149"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">a_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'acc'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-150"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-151"><span class="crayon-h">	</span><span class="crayon-p"># save plot to file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-152"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'results_convergence/plot_line_plot_loss.png'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-153"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-154">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-155"><span class="crayon-p"># train the generator and discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-156"><span class="crayon-e">def </span><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-o">=</span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-157"><span class="crayon-h">	</span><span class="crayon-p"># calculate the number of batches per epoch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-158"><span class="crayon-h">	</span><span class="crayon-v">bat_per_epo</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-159"><span class="crayon-h">	</span><span class="crayon-p"># calculate the total iterations based on batch and epoch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-160"><span class="crayon-h">	</span><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">bat_per_epo *</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">_</span>epochs</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-161"><span class="crayon-h">	</span><span class="crayon-p"># calculate the number of samples in half a batch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-162"><span class="crayon-h">	</span><span class="crayon-v">half_batch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-163"><span class="crayon-h">	</span><span class="crayon-p"># prepare lists for storing stats each iteration</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-164"><span class="crayon-h">	</span><span class="crayon-v">d_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a_hist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-165"><span class="crayon-h">	</span><span class="crayon-p"># manually enumerate epochs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-166"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-167"><span class="crayon-h">		</span><span class="crayon-p"># get randomly selected 'real' samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-168"><span class="crayon-h">		</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-169"><span class="crayon-h">		</span><span class="crayon-p"># generate 'fake' examples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-170"><span class="crayon-h">		</span><span class="crayon-v">X_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-171"><span class="crayon-h">		</span><span class="crayon-p"># combine into one batch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-172"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">vstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X_fake</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">vstack</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">y_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-173"><span class="crayon-h">		</span><span class="crayon-p"># update discriminator model weights</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-174"><span class="crayon-h">		</span><span class="crayon-v">d_loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-175"><span class="crayon-h">		</span><span class="crayon-p"># prepare points in latent space as input for the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-176"><span class="crayon-h">		</span><span class="crayon-v">X_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-177"><span class="crayon-h">		</span><span class="crayon-p"># create inverted labels for the fake samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-178"><span class="crayon-h">		</span><span class="crayon-v">y_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-179"><span class="crayon-h">		</span><span class="crayon-p"># update the generator via the discriminator's error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-180"><span class="crayon-h">		</span><span class="crayon-v">g_loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_gan</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_gan</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-181"><span class="crayon-h">		</span><span class="crayon-p"># summarize loss on this batch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-182"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%d, d=%.3f, g=%.3f, a=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-o">*</span><span class="crayon-v">d_acc</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-183"><span class="crayon-h">		</span><span class="crayon-p"># record history</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-184"><span class="crayon-h">		</span><span class="crayon-v">d_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_loss</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-185"><span class="crayon-h">		</span><span class="crayon-v">g_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">g_loss</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-186"><span class="crayon-h">		</span><span class="crayon-v">a_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_acc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-187"><span class="crayon-h">		</span><span class="crayon-p"># evaluate the model performance every 'epoch'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-188"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">bat_per_epo</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-189"><span class="crayon-h">			</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-190"><span class="crayon-h">	</span><span class="crayon-e">plot_history</span><span class="crayon-sy">(</span><span class="crayon-v">d_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a_hist</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-191">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-192"><span class="crayon-p"># make folder for results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-193"><span class="crayon-e">makedirs</span><span class="crayon-sy">(</span><span class="crayon-s">'results_convergence'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">exist_ok</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-194"><span class="crayon-p"># size of the latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-195"><span class="crayon-v">latent_dim</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-196"><span class="crayon-p"># create the discriminator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-197"><span class="crayon-v">discriminator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-198"><span class="crayon-p"># create the generator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-199"><span class="crayon-v">generator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-200"><span class="crayon-p"># create the gan</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-201"><span class="crayon-v">gan_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-202"><span class="crayon-p"># load image data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-203"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-204"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-205"><span class="crayon-p"># train model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe6017621622-206"><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example reports loss and accuracy for each model update.</p>
<p>A clear sign of this type of failure is the rapid drop of the discriminator loss towards zero, where it remains.</p>
<p>This is what we see in this case.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fe8508596490" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft">&gt;1, d=0.514, g=0.969, a=80
&gt;2, d=0.475, g=0.395, a=74
&gt;3, d=0.452, g=0.223, a=69
&gt;4, d=0.302, g=0.220, a=85
&gt;5, d=0.177, g=0.195, a=100
&gt;6, d=0.122, g=0.200, a=100
&gt;7, d=0.088, g=0.179, a=100
&gt;8, d=0.075, g=0.159, a=100
&gt;9, d=0.071, g=0.167, a=100
&gt;10, d=0.102, g=0.127, a=100
...
&gt;446, d=0.000, g=0.001, a=100
&gt;447, d=0.000, g=0.001, a=100
&gt;448, d=0.000, g=0.001, a=100
&gt;449, d=0.000, g=0.001, a=100
&gt;450, d=0.000, g=0.001, a=100</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fe8508596490-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-1">&gt;1, d=0.514, g=0.969, a=80</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-2">&gt;2, d=0.475, g=0.395, a=74</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-3">&gt;3, d=0.452, g=0.223, a=69</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-4">&gt;4, d=0.302, g=0.220, a=85</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-5">&gt;5, d=0.177, g=0.195, a=100</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-6">&gt;6, d=0.122, g=0.200, a=100</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-7">&gt;7, d=0.088, g=0.179, a=100</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-8">&gt;8, d=0.075, g=0.159, a=100</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-9">&gt;9, d=0.071, g=0.167, a=100</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-10">&gt;10, d=0.102, g=0.127, a=100</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-11">...</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-12">&gt;446, d=0.000, g=0.001, a=100</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-13">&gt;447, d=0.000, g=0.001, a=100</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-14">&gt;448, d=0.000, g=0.001, a=100</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-15">&gt;449, d=0.000, g=0.001, a=100</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fe8508596490-16">&gt;450, d=0.000, g=0.001, a=100</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Line plots of learning curves and classification accuracy are created.</p>
<p>The top subplot shows the loss for the discriminator (blue) and 
generator (orange) and clearly shows the drop of both values down 
towards zero over the first 20 to 30 iterations, where it remains for 
the rest of the run.</p>
<p>The bottom subplot shows the discriminator classification accuracy 
sitting on 100% for the same period, meaning the model is perfect at 
identifying real and fake images. The expectation is that there is 
something about fake images that makes them very easy for the 
discriminator to identify.</p>
<div id="attachment_8180" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8180" loading="lazy" class="size-full wp-image-8180" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Line-Plots-of-Loss-and-Accuracy-for-a-Generative-Adversa_003.png" alt="Line Plots of Loss and Accuracy for a Generative Adversarial Network With a Convergence Failure" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Line-Plots-of-Loss-and-Accuracy-for-a-Generative-Adversa_003.png 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Line-Plots-of-Loss-and-Accuracy-for-a-Generative-Adversa_004.png 300w" sizes="(max-width: 640px) 100vw, 640px" width="640" height="480"><p id="caption-attachment-8180" class="wp-caption-text">Line Plots of Loss and Accuracy for a Generative Adversarial Network With a Convergence Failure</p></div>
<p>Finally, reviewing samples of generated images makes it clear why the discriminator is so successful.</p>
<p>Samples of images generated at each epoch are all very low quality, 
showing static, perhaps with a faint figure eight in the background.</p>
<div id="attachment_8181" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8181" loading="lazy" class="size-full wp-image-8181" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_008.png" alt="Sample of 100 Generated Images of a Handwritten Number 8 at Epoch 450 From a GAN That Has a Convergence Failure via Combined Updates to the Discriminator." srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_008.png 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8-at-.png 300w" sizes="(max-width: 640px) 100vw, 640px" width="640" height="480"><p id="caption-attachment-8181" class="wp-caption-text">Sample
 of 100 Generated Images of a Handwritten Number 8 at Epoch 450 From a 
GAN That Has a Convergence Failure via Combined Updates to the 
Discriminator.</p></div>
<p>It is useful to see another example of this type of failure.</p>
<p>In this case, the configuration of the <a href="https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/">Adam optimization algorithm</a>
 can be modified to use the defaults, which in turn makes the updates to
 the models aggressive and causes a failure for the training process to 
find a point of equilibrium between training the two models.</p>
<p>For example, the discriminator can be compiled as follows:</p>
		<div id="urvanov-syntax-highlighter-62b123a238fea031763426" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft">...
# compile model
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fea031763426-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fea031763426-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fea031763426-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fea031763426-1"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fea031763426-2"><span class="crayon-p"># compile model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fea031763426-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>And the composite GAN model can be compiled as follows:</p>
		<div id="urvanov-syntax-highlighter-62b123a238fec277000463" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft">...
# compile model
model.compile(loss='binary_crossentropy', optimizer='adam')</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fec277000463-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fec277000463-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fec277000463-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fec277000463-1"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fec277000463-2"><span class="crayon-p"># compile model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fec277000463-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>The full code listing is provided below for completeness.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fed384504650" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft"># example of training an unstable gan for generating a handwritten digit
from os import makedirs
from numpy import expand_dims
from numpy import zeros
from numpy import ones
from numpy.random import randn
from numpy.random import randint
from keras.datasets.mnist import load_data
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Reshape
from keras.layers import Flatten
from keras.layers import Conv2D
from keras.layers import Conv2DTranspose
from keras.layers import LeakyReLU
from keras.initializers import RandomNormal
from matplotlib import pyplot

# define the standalone discriminator model
def define_discriminator(in_shape=(28,28,1)):
	# weight initialization
	init = RandomNormal(stddev=0.02)
	# define model
	model = Sequential()
	# downsample to 14x14
	model.add(Conv2D(64, (4,4), strides=(2,2), padding='same', kernel_initializer=init, input_shape=in_shape))
	model.add(LeakyReLU(alpha=0.2))
	# downsample to 7x7
	model.add(Conv2D(64, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# classifier
	model.add(Flatten())
	model.add(Dense(1, activation='sigmoid'))
	# compile model
	model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
	return model

# define the standalone generator model
def define_generator(latent_dim):
	# weight initialization
	init = RandomNormal(stddev=0.02)
	# define model
	model = Sequential()
	# foundation for 7x7 image
	n_nodes = 128 * 7 * 7
	model.add(Dense(n_nodes, kernel_initializer=init, input_dim=latent_dim))
	model.add(LeakyReLU(alpha=0.2))
	model.add(Reshape((7, 7, 128)))
	# upsample to 14x14
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# upsample to 28x28
	model.add(Conv2DTranspose(128, (4,4), strides=(2,2), padding='same', kernel_initializer=init))
	model.add(LeakyReLU(alpha=0.2))
	# output 28x28x1
	model.add(Conv2D(1, (7,7), activation='tanh', padding='same', kernel_initializer=init))
	return model

# define the combined generator and discriminator model, for updating the generator
def define_gan(generator, discriminator):
	# make weights in the discriminator not trainable
	discriminator.trainable = False
	# connect them
	model = Sequential()
	# add generator
	model.add(generator)
	# add the discriminator
	model.add(discriminator)
	# compile model
	model.compile(loss='binary_crossentropy', optimizer='adam')
	return model

# load mnist images
def load_real_samples():
	# load dataset
	(trainX, trainy), (_, _) = load_data()
	# expand to 3d, e.g. add channels
	X = expand_dims(trainX, axis=-1)
	# select all of the examples for a given class
	selected_ix = trainy == 8
	X = X[selected_ix]
	# convert from ints to floats
	X = X.astype('float32')
	# scale from [0,255] to [-1,1]
	X = (X - 127.5) / 127.5
	return X

# select real samples
def generate_real_samples(dataset, n_samples):
	# choose random instances
	ix = randint(0, dataset.shape[0], n_samples)
	# select images
	X = dataset[ix]
	# generate class labels
	y = ones((n_samples, 1))
	return X, y

# generate points in latent space as input for the generator
def generate_latent_points(latent_dim, n_samples):
	# generate points in the latent space
	x_input = randn(latent_dim * n_samples)
	# reshape into a batch of inputs for the network
	x_input = x_input.reshape(n_samples, latent_dim)
	return x_input

# use the generator to generate n fake examples, with class labels
def generate_fake_samples(generator, latent_dim, n_samples):
	# generate points in latent space
	x_input = generate_latent_points(latent_dim, n_samples)
	# predict outputs
	X = generator.predict(x_input)
	# create class labels
	y = zeros((n_samples, 1))
	return X, y

# generate samples and save as a plot and save the model
def summarize_performance(step, g_model, latent_dim, n_samples=100):
	# prepare fake examples
	X, _ = generate_fake_samples(g_model, latent_dim, n_samples)
	# scale from [-1,1] to [0,1]
	X = (X + 1) / 2.0
	# plot images
	for i in range(10 * 10):
		# define subplot
		pyplot.subplot(10, 10, 1 + i)
		# turn off axis
		pyplot.axis('off')
		# plot raw pixel data
		pyplot.imshow(X[i, :, :, 0], cmap='gray_r')
	# save plot to file
	pyplot.savefig('results_opt/generated_plot_%03d.png' % (step+1))
	pyplot.close()
	# save the generator model
	g_model.save('results_opt/model_%03d.h5' % (step+1))

# create a line plot of loss for the gan and save to file
def plot_history(d1_hist, d2_hist, g_hist, a1_hist, a2_hist):
	# plot loss
	pyplot.subplot(2, 1, 1)
	pyplot.plot(d1_hist, label='d-real')
	pyplot.plot(d2_hist, label='d-fake')
	pyplot.plot(g_hist, label='gen')
	pyplot.legend()
	# plot discriminator accuracy
	pyplot.subplot(2, 1, 2)
	pyplot.plot(a1_hist, label='acc-real')
	pyplot.plot(a2_hist, label='acc-fake')
	pyplot.legend()
	# save plot to file
	pyplot.savefig('results_opt/plot_line_plot_loss.png')
	pyplot.close()

# train the generator and discriminator
def train(g_model, d_model, gan_model, dataset, latent_dim, n_epochs=10, n_batch=128):
	# calculate the number of batches per epoch
	bat_per_epo = int(dataset.shape[0] / n_batch)
	# calculate the total iterations based on batch and epoch
	n_steps = bat_per_epo * n_epochs
	# calculate the number of samples in half a batch
	half_batch = int(n_batch / 2)
	# prepare lists for storing stats each iteration
	d1_hist, d2_hist, g_hist, a1_hist, a2_hist = list(), list(), list(), list(), list()
	# manually enumerate epochs
	for i in range(n_steps):
		# get randomly selected 'real' samples
		X_real, y_real = generate_real_samples(dataset, half_batch)
		# update discriminator model weights
		d_loss1, d_acc1 = d_model.train_on_batch(X_real, y_real)
		# generate 'fake' examples
		X_fake, y_fake = generate_fake_samples(g_model, latent_dim, half_batch)
		# update discriminator model weights
		d_loss2, d_acc2 = d_model.train_on_batch(X_fake, y_fake)
		# prepare points in latent space as input for the generator
		X_gan = generate_latent_points(latent_dim, n_batch)
		# create inverted labels for the fake samples
		y_gan = ones((n_batch, 1))
		# update the generator via the discriminator's error
		g_loss = gan_model.train_on_batch(X_gan, y_gan)
		# summarize loss on this batch
		print('&gt;%d, d1=%.3f, d2=%.3f g=%.3f, a1=%d, a2=%d' %
			(i+1, d_loss1, d_loss2, g_loss, int(100*d_acc1), int(100*d_acc2)))
		# record history
		d1_hist.append(d_loss1)
		d2_hist.append(d_loss2)
		g_hist.append(g_loss)
		a1_hist.append(d_acc1)
		a2_hist.append(d_acc2)
		# evaluate the model performance every 'epoch'
		if (i+1) % bat_per_epo == 0:
			summarize_performance(i, g_model, latent_dim)
	plot_history(d1_hist, d2_hist, g_hist, a1_hist, a2_hist)

# make folder for results
makedirs('results_opt', exist_ok=True)
# size of the latent space
latent_dim = 50
# create the discriminator
discriminator = define_discriminator()
# create the generator
generator = define_generator(latent_dim)
# create the gan
gan_model = define_gan(generator, discriminator)
# load image data
dataset = load_real_samples()
print(dataset.shape)
# train model
train(generator, discriminator, gan_model, dataset, latent_dim)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-112">112</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-113">113</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-114">114</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-115">115</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-116">116</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-117">117</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-118">118</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-119">119</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-120">120</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-121">121</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-122">122</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-123">123</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-124">124</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-125">125</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-126">126</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-127">127</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-128">128</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-129">129</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-130">130</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-131">131</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-132">132</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-133">133</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-134">134</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-135">135</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-136">136</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-137">137</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-138">138</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-139">139</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-140">140</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-141">141</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-142">142</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-143">143</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-144">144</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-145">145</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-146">146</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-147">147</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-148">148</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-149">149</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-150">150</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-151">151</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-152">152</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-153">153</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-154">154</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-155">155</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-156">156</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-157">157</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-158">158</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-159">159</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-160">160</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-161">161</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-162">162</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-163">163</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-164">164</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-165">165</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-166">166</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-167">167</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-168">168</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-169">169</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-170">170</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-171">171</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-172">172</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-173">173</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-174">174</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-175">175</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-176">176</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-177">177</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-178">178</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-179">179</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-180">180</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-181">181</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-182">182</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-183">183</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-184">184</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-185">185</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-186">186</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-187">187</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-188">188</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-189">189</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-190">190</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-191">191</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-192">192</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-193">193</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-194">194</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-195">195</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-196">196</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-197">197</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-198">198</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-199">199</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-200">200</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-201">201</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-202">202</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-203">203</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-204">204</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-205">205</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-206">206</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fed384504650-207">207</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-1"><span class="crayon-p"># example of training an unstable gan for generating a handwritten digit</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">makedirs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">expand_dims</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">zeros</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-5"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">ones</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-6"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randn</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-7"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randint</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">datasets</span><span class="crayon-sy">.</span><span class="crayon-e">mnist </span><span class="crayon-e">import </span><span class="crayon-e">load_data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-11"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Reshape</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-12"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-13"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-14"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Conv2DTranspose</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-15"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LeakyReLU</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-16"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">initializers </span><span class="crayon-e">import </span><span class="crayon-e">RandomNormal</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-17"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-i">pyplot</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-19"><span class="crayon-p"># define the standalone discriminator model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-20"><span class="crayon-e">def </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-v">in_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-21"><span class="crayon-h">	</span><span class="crayon-p"># weight initialization</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-22"><span class="crayon-h">	</span><span class="crayon-v">init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomNormal</span><span class="crayon-sy">(</span><span class="crayon-v">stddev</span><span class="crayon-o">=</span><span class="crayon-cn">0.02</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-23"><span class="crayon-h">	</span><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-24"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-25"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 14x14</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-26"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-v">in_shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-27"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-28"><span class="crayon-h">	</span><span class="crayon-p"># downsample to 7x7</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-29"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-30"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-31"><span class="crayon-h">	</span><span class="crayon-p"># classifier</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-32"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-33"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-34"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-35"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-36"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-38"><span class="crayon-p"># define the standalone generator model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-39"><span class="crayon-e">def </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-40"><span class="crayon-h">	</span><span class="crayon-p"># weight initialization</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-41"><span class="crayon-h">	</span><span class="crayon-v">init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomNormal</span><span class="crayon-sy">(</span><span class="crayon-v">stddev</span><span class="crayon-o">=</span><span class="crayon-cn">0.02</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-42"><span class="crayon-h">	</span><span class="crayon-p"># define model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-43"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-44"><span class="crayon-h">	</span><span class="crayon-p"># foundation for 7x7 image</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-45"><span class="crayon-h">	</span><span class="crayon-v">n_nodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-46"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">n_nodes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-47"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-48"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-49"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 14x14</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-50"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-51"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-52"><span class="crayon-h">	</span><span class="crayon-p"># upsample to 28x28</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-53"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2DTranspose</span><span class="crayon-sy">(</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strides</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-54"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LeakyReLU</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-55"><span class="crayon-h">	</span><span class="crayon-p"># output 28x28x1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-56"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'tanh'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-57"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-58">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-59"><span class="crayon-p"># define the combined generator and discriminator model, for updating the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-60"><span class="crayon-e">def </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-61"><span class="crayon-h">	</span><span class="crayon-p"># make weights in the discriminator not trainable</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-62"><span class="crayon-h">	</span><span class="crayon-v">discriminator</span><span class="crayon-sy">.</span><span class="crayon-v">trainable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-63"><span class="crayon-h">	</span><span class="crayon-p"># connect them</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-64"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-65"><span class="crayon-h">	</span><span class="crayon-p"># add generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-66"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-67"><span class="crayon-h">	</span><span class="crayon-p"># add the discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-68"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-69"><span class="crayon-h">	</span><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-70"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-71"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-72">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-73"><span class="crayon-p"># load mnist images</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-74"><span class="crayon-e">def </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-75"><span class="crayon-h">	</span><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-76"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-77"><span class="crayon-h">	</span><span class="crayon-p"># expand to 3d, e.g. add channels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-78"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-79"><span class="crayon-h">	</span><span class="crayon-p"># select all of the examples for a given class</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-80"><span class="crayon-h">	</span><span class="crayon-v">selected_ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-81"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">selected_ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-82"><span class="crayon-h">	</span><span class="crayon-p"># convert from ints to floats</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-83"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-84"><span class="crayon-h">	</span><span class="crayon-p"># scale from [0,255] to [-1,1]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-85"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">127.5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-86"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">X</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-87">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-88"><span class="crayon-p"># select real samples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-89"><span class="crayon-e">def </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-90"><span class="crayon-h">	</span><span class="crayon-p"># choose random instances</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-91"><span class="crayon-h">	</span><span class="crayon-v">ix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randint</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-92"><span class="crayon-h">	</span><span class="crayon-p"># select images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-93"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">ix</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-94"><span class="crayon-h">	</span><span class="crayon-p"># generate class labels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-95"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-96"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-97">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-98"><span class="crayon-p"># generate points in latent space as input for the generator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-99"><span class="crayon-e">def </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-100"><span class="crayon-h">	</span><span class="crayon-p"># generate points in the latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-101"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-e ">latent_dim *</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-102"><span class="crayon-h">	</span><span class="crayon-p"># reshape into a batch of inputs for the network</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-103"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_input</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-104"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">_</span>input</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-105">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-106"><span class="crayon-p"># use the generator to generate n fake examples, with class labels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-107"><span class="crayon-e">def </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-108"><span class="crayon-h">	</span><span class="crayon-p"># generate points in latent space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-109"><span class="crayon-h">	</span><span class="crayon-v">x_input</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-110"><span class="crayon-h">	</span><span class="crayon-p"># predict outputs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-111"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">generator</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_input</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-112"><span class="crayon-h">	</span><span class="crayon-p"># create class labels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-113"><span class="crayon-h">	</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_samples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-114"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-115">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-116"><span class="crayon-p"># generate samples and save as a plot and save the model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-117"><span class="crayon-e">def </span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-118"><span class="crayon-h">	</span><span class="crayon-p"># prepare fake examples</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-119"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-120"><span class="crayon-h">	</span><span class="crayon-p"># scale from [-1,1] to [0,1]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-121"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-122"><span class="crayon-h">	</span><span class="crayon-p"># plot images</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-123"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-124"><span class="crayon-h">		</span><span class="crayon-p"># define subplot</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-125"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-126"><span class="crayon-h">		</span><span class="crayon-p"># turn off axis</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-127"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-128"><span class="crayon-h">		</span><span class="crayon-p"># plot raw pixel data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-129"><span class="crayon-h">		</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-s">'gray_r'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-130"><span class="crayon-h">	</span><span class="crayon-p"># save plot to file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-131"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'results_opt/generated_plot_%03d.png'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-132"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-133"><span class="crayon-h">	</span><span class="crayon-p"># save the generator model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-134"><span class="crayon-h">	</span><span class="crayon-v">g_model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">'results_opt/model_%03d.h5'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">step</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-135">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-136"><span class="crayon-p"># create a line plot of loss for the gan and save to file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-137"><span class="crayon-e">def </span><span class="crayon-e">plot_history</span><span class="crayon-sy">(</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2_hist</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-138"><span class="crayon-h">	</span><span class="crayon-p"># plot loss</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-139"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-140"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'d-real'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-141"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'d-fake'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-142"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'gen'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-143"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-144"><span class="crayon-h">	</span><span class="crayon-p"># plot discriminator accuracy</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-145"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-146"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'acc-real'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-147"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">a2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'acc-fake'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-148"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-149"><span class="crayon-h">	</span><span class="crayon-p"># save plot to file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-150"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">savefig</span><span class="crayon-sy">(</span><span class="crayon-s">'results_opt/plot_line_plot_loss.png'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-151"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-152">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-153"><span class="crayon-p"># train the generator and discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-154"><span class="crayon-e">def </span><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-o">=</span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-155"><span class="crayon-h">	</span><span class="crayon-p"># calculate the number of batches per epoch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-156"><span class="crayon-h">	</span><span class="crayon-v">bat_per_epo</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-157"><span class="crayon-h">	</span><span class="crayon-p"># calculate the total iterations based on batch and epoch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-158"><span class="crayon-h">	</span><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">bat_per_epo *</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">_</span>epochs</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-159"><span class="crayon-h">	</span><span class="crayon-p"># calculate the number of samples in half a batch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-160"><span class="crayon-h">	</span><span class="crayon-v">half_batch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-161"><span class="crayon-h">	</span><span class="crayon-p"># prepare lists for storing stats each iteration</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-162"><span class="crayon-h">	</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2_hist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-163"><span class="crayon-h">	</span><span class="crayon-p"># manually enumerate epochs</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-164"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_steps</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-165"><span class="crayon-h">		</span><span class="crayon-p"># get randomly selected 'real' samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-166"><span class="crayon-h">		</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_real_samples</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-167"><span class="crayon-h">		</span><span class="crayon-p"># update discriminator model weights</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-168"><span class="crayon-h">		</span><span class="crayon-v">d_loss1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_acc1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_real</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_real</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-169"><span class="crayon-h">		</span><span class="crayon-p"># generate 'fake' examples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-170"><span class="crayon-h">		</span><span class="crayon-v">X_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_fake_samples</span><span class="crayon-sy">(</span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">half_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-171"><span class="crayon-h">		</span><span class="crayon-p"># update discriminator model weights</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-172"><span class="crayon-h">		</span><span class="crayon-v">d_loss2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_acc2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">d_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_fake</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_fake</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-173"><span class="crayon-h">		</span><span class="crayon-p"># prepare points in latent space as input for the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-174"><span class="crayon-h">		</span><span class="crayon-v">X_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_latent_points</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_batch</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-175"><span class="crayon-h">		</span><span class="crayon-p"># create inverted labels for the fake samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-176"><span class="crayon-h">		</span><span class="crayon-v">y_gan</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-177"><span class="crayon-h">		</span><span class="crayon-p"># update the generator via the discriminator's error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-178"><span class="crayon-h">		</span><span class="crayon-v">g_loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">.</span><span class="crayon-e">train_on_batch</span><span class="crayon-sy">(</span><span class="crayon-v">X_gan</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_gan</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-179"><span class="crayon-h">		</span><span class="crayon-p"># summarize loss on this batch</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-180"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;%d, d1=%.3f, d2=%.3f g=%.3f, a1=%d, a2=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-181"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_loss1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_loss2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-o">*</span><span class="crayon-v">d_acc1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-o">*</span><span class="crayon-v">d_acc2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-182"><span class="crayon-h">		</span><span class="crayon-p"># record history</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-183"><span class="crayon-h">		</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_loss1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-184"><span class="crayon-h">		</span><span class="crayon-v">d2_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_loss2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-185"><span class="crayon-h">		</span><span class="crayon-v">g_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">g_loss</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-186"><span class="crayon-h">		</span><span class="crayon-v">a1_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_acc1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-187"><span class="crayon-h">		</span><span class="crayon-v">a2_hist</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">d_acc2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-188"><span class="crayon-h">		</span><span class="crayon-p"># evaluate the model performance every 'epoch'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-189"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">bat_per_epo</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-190"><span class="crayon-h">			</span><span class="crayon-e">summarize_performance</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-191"><span class="crayon-h">	</span><span class="crayon-e">plot_history</span><span class="crayon-sy">(</span><span class="crayon-v">d1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d2_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">g_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a1_hist</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2_hist</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-192">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-193"><span class="crayon-p"># make folder for results</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-194"><span class="crayon-e">makedirs</span><span class="crayon-sy">(</span><span class="crayon-s">'results_opt'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">exist_ok</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-195"><span class="crayon-p"># size of the latent space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-196"><span class="crayon-v">latent_dim</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-197"><span class="crayon-p"># create the discriminator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-198"><span class="crayon-v">discriminator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_discriminator</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-199"><span class="crayon-p"># create the generator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-200"><span class="crayon-v">generator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_generator</span><span class="crayon-sy">(</span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-201"><span class="crayon-p"># create the gan</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-202"><span class="crayon-v">gan_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">define_gan</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-203"><span class="crayon-p"># load image data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-204"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_real_samples</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-205"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-206"><span class="crayon-p"># train model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fed384504650-207"><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">discriminator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gan_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">latent_dim</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example reports the loss and accuracy for each step during training, as before.</p>
<p>As we expected, the loss for the discriminator rapidly falls to a 
value close to zero, where it remains, and classification accuracy for 
the discriminator on real and fake examples remains at 100%.</p>
		<div id="urvanov-syntax-highlighter-62b123a238fef508647429" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0;" wrap="soft">&gt;1, d1=0.728, d2=0.902 g=0.763, a1=54, a2=12
&gt;2, d1=0.001, d2=4.509 g=0.033, a1=100, a2=0
&gt;3, d1=0.000, d2=0.486 g=0.542, a1=100, a2=76
&gt;4, d1=0.000, d2=0.446 g=0.733, a1=100, a2=82
&gt;5, d1=0.002, d2=0.855 g=0.649, a1=100, a2=46
...
&gt;446, d1=0.000, d2=0.000 g=10.410, a1=100, a2=100
&gt;447, d1=0.000, d2=0.000 g=10.414, a1=100, a2=100
&gt;448, d1=0.000, d2=0.000 g=10.419, a1=100, a2=100
&gt;449, d1=0.000, d2=0.000 g=10.424, a1=100, a2=100
&gt;450, d1=0.000, d2=0.000 g=10.427, a1=100, a2=100</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fef508647429-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fef508647429-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fef508647429-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fef508647429-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fef508647429-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fef508647429-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fef508647429-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fef508647429-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fef508647429-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-62b123a238fef508647429-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-62b123a238fef508647429-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fef508647429-1">&gt;1, d1=0.728, d2=0.902 g=0.763, a1=54, a2=12</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fef508647429-2">&gt;2, d1=0.001, d2=4.509 g=0.033, a1=100, a2=0</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fef508647429-3">&gt;3, d1=0.000, d2=0.486 g=0.542, a1=100, a2=76</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fef508647429-4">&gt;4, d1=0.000, d2=0.446 g=0.733, a1=100, a2=82</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fef508647429-5">&gt;5, d1=0.002, d2=0.855 g=0.649, a1=100, a2=46</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fef508647429-6">...</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fef508647429-7">&gt;446, d1=0.000, d2=0.000 g=10.410, a1=100, a2=100</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fef508647429-8">&gt;447, d1=0.000, d2=0.000 g=10.414, a1=100, a2=100</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fef508647429-9">&gt;448, d1=0.000, d2=0.000 g=10.419, a1=100, a2=100</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-62b123a238fef508647429-10">&gt;449, d1=0.000, d2=0.000 g=10.424, a1=100, a2=100</div><div class="crayon-line" id="urvanov-syntax-highlighter-62b123a238fef508647429-11">&gt;450, d1=0.000, d2=0.000 g=10.427, a1=100, a2=100</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>A plot of the learning curves and accuracy from training the model with this single change is created.</p>
<p>The plot shows that this change causes the loss for the discriminator
 to crash down to a value close to zero and remain there. An important 
difference for this case is that the loss for the generator rises 
quickly and continues to rise for the duration of training.</p>
<div id="attachment_8182" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-8182" loading="lazy" class="wp-image-8182 size-full" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_004.png" alt="Sample of 100 Generated Images of a Handwritten Number 8 at Epoch 450 From a GAN That Has a Convergence Failure via Aggressive Optimization." srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_004.png 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-8_006.png 300w" sizes="(max-width: 640px) 100vw, 640px" width="640" height="480"><p id="caption-attachment-8182" class="wp-caption-text">Line Plots of Loss and Accuracy for a Generative Adversarial Network With a Convergence Failure Due To Aggressive Optimization</p></div>
<p>We can review the properties of a convergence failure as follows:</p>
<ul>
<li>The loss for the discriminator is expected to rapidly decrease to a value close to zero where it remains during training.</li>
<li>The loss for the generator is expected to either decrease to zero or continually decrease during training.</li>
<li>The generator is expected to produce extremely low-quality images that are easily identified as fake by the discriminator.</li>
</ul>
<div id="AdThrive_Content_4_desktop" class="adthrive-ad adthrive-content adthrive-content-1 adthrive-ad-cls" style="min-height: 250px;" data-google-query-id="CNW0uePgvvgCFZAOaAgdiOALBw"><div id="google_ads_iframe_/18190176,22523581566/AdThrive_Content_4/5d4c8ca4693e634b2e5d98cf_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/18190176,22523581566/AdThrive_Content_4/5d4c8ca4693e634b2e5d98cf_0" name="google_ads_iframe_/18190176,22523581566/AdThrive_Content_4/5d4c8ca4693e634b2e5d98cf_0" title="3rd party ad content" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" role="region" aria-label="Advertisement" tabindex="0" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" data-google-container-id="2" data-load-complete="true" width="728" height="90" frameborder="0"></iframe></div></div><h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking to go deeper.</p>
<h3>Papers</h3>
<ul>
<li><a href="https://arxiv.org/abs/1406.2661">Generative Adversarial Networks</a>, 2014.</li>
<li><a href="https://arxiv.org/abs/1701.00160">Tutorial: Generative Adversarial Networks, NIPS</a>, 2016.</li>
<li><a href="https://arxiv.org/abs/1511.06434">Unsupervised Representation Learning with Deep Convolutional Generative Adversarial Networks</a>, 2015.</li>
</ul>
<h3>Articles</h3>
<ul>
<li><a href="https://github.com/soumith/ganhacks">How to Train a GAN? Tips and tricks to make GANs work</a></li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to identify stable and unstable 
GAN training by reviewing examples of generated images and plots of 
metrics recorded during training.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to identify a stable GAN training process from the generator and discriminator loss over time.</li>
<li>How to identify a mode collapse by reviewing both learning curves and generated images.</li>
<li>How to identify a convergence failure by reviewing learning curves of generator and discriminator loss over time.</li>
</ul>
<p>Do you have any questions?<br>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="widget_text awac-wrapper" id="custom_html-6"><div class="widget_text awac widget custom_html-6"><div class="textwidget custom-html-widget"><div style="text-align: center;">
<div class="woo-sc-hr"></div>
<h2>Develop Generative Adversarial Networks Today!</h2>
<a href="https://machinelearningmastery.com/generative_adversarial_networks/" rel="nofollow"><img style="border: 0;" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Generative-Adversarial-Networks-with-Python-220.png" alt="Generative Adversarial Networks with Python" width="220" height="311" align="left"></a>
	
<p></p><h4>Develop Your GAN Models in Minutes</h4>
...with just a few lines of python code<p></p>

<p>Discover how in my new Ebook:<br>
	<a href="https://machinelearningmastery.com/generative_adversarial_networks/" rel="nofollow">Generative Adversarial Networks with Python</a></p>

<p>It provides <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on:<br> 
	<em>DCGAN</em>, <em>conditional GANs</em>, <em>image translation</em>, <em>Pix2Pix</em>, <em>CycleGAN</em><br>
	and much more...</p>

<p></p><h4>Finally Bring GAN Models to your Vision Projects</h4>
Skip the Academics. Just Results.<p></p>

<p><a href="https://machinelearningmastery.com/generative_adversarial_networks/" class="woo-sc-button  red"><span class="woo-">See What's Inside</span></a></p>
<div class="woo-sc-hr"></div>
</div></div></div></div><div class="widget_text awac-wrapper" id="custom_html-108"><div class="widget_text awac widget custom_html-108"><div class="textwidget custom-html-widget"></div></div></div><p></p><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-8173 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Identify+and+Diagnose+GAN+Failure+Modes&amp;url=https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Identify+and+Diagnose+GAN+Failure+Modes&amp;url=https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<div id="AdThrive_Below_Post_1_desktop" class="adthrive-ad adthrive-below-post adthrive-below-post-1 adthrive-ad-cls" style="min-height: 250px;"></div><div class="crp_related  "><h3>More On This Topic</h3><ul><li><a href="https://machinelearningmastery.com/how-to-develop-an-auxiliary-classifier-gan-ac-gan-from-scratch-with-keras/" class="crp_link post-8229"><figure><img loading="lazy" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-100-Photos-of-Sneakers-Generated-by-an-AC-GAN.png" class="crp_thumb crp_featured" alt="How to Develop an Auxiliary Classifier GAN (AC-GAN) From Scratch with Keras" title="How to Develop an Auxiliary Classifier GAN (AC-GAN) From Scratch with Keras" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-100-Photos-of-Sneakers-Generated-by-an-AC-GAN.png 1280w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-100-Photos-of-Sneakers-Generated-by-an-AC-GAN-300.png 300w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-100-Photos-of-Sneakers-Generated-by-an-AC-GAN-768.png 768w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-100-Photos-of-Sneakers-Generated-by-an-AC-GAN-102.png 1024w" sizes="(max-width: 150px) 100vw, 150px" width="150" height="113"></figure><span class="crp_title">How to Develop an Auxiliary Classifier GAN (AC-GAN)…</span></a></li><li><a href="https://machinelearningmastery.com/impressive-applications-of-generative-adversarial-networks/" class="crp_link post-7952"><figure><img loading="lazy" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-GAN-Generated-Images-with-Super-Resolution.png" class="crp_thumb crp_featured" alt="18 Impressive Applications of Generative Adversarial Networks (GANs)" title="18 Impressive Applications of Generative Adversarial Networks (GANs)" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-GAN-Generated-Images-with-Super-Resolution.png 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-GAN-Generated-Images-with-Super-Resolution-300x21.png 300w" sizes="(max-width: 150px) 100vw, 150px" width="150" height="109"></figure><span class="crp_title">18 Impressive Applications of Generative Adversarial…</span></a></li><li><a href="https://machinelearningmastery.com/semi-supervised-generative-adversarial-network/" class="crp_link post-8275"><figure><img loading="lazy" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/How-to-Implement-a-Semi-Supervised-Generative-Adversarial-Ne.jpg" class="crp_thumb crp_featured" alt="How to Implement a Semi-Supervised GAN (SGAN) From Scratch in Keras" title="How to Implement a Semi-Supervised GAN (SGAN) From Scratch in Keras" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/How-to-Implement-a-Semi-Supervised-Generative-Adversarial-Ne.jpg 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/How-to-Implement-a-Semi-Supervised-Generative-Adversaria_002.jpg 300w" sizes="(max-width: 150px) 100vw, 150px" width="150" height="100"></figure><span class="crp_title">How to Implement a Semi-Supervised GAN (SGAN) From…</span></a></li><li><a href="https://machinelearningmastery.com/how-to-train-a-progressive-growing-gan-in-keras-for-synthesizing-faces/" class="crp_link post-8463"><figure><img loading="lazy" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Synthetic-Celebrity-Faces-at-128x128-Resolution-After-Tu_002.png" class="crp_thumb crp_featured" alt="How to Train a Progressive Growing GAN in Keras for Synthesizing Faces" title="How to Train a Progressive Growing GAN in Keras for Synthesizing Faces" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Synthetic-Celebrity-Faces-at-128x128-Resolution-After-Tu_002.png 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Synthetic-Celebrity-Faces-at-128x128-Resolution-After-Tuning.png 300w" sizes="(max-width: 150px) 100vw, 150px" width="150" height="113"></figure><span class="crp_title">How to Train a Progressive Growing GAN in Keras for…</span></a></li><li><a href="https://machinelearningmastery.com/how-to-develop-a-conditional-generative-adversarial-network-from-scratch/" class="crp_link post-8154"><figure><img loading="lazy" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-100-Generated-items-of-Clothing-using-an-Cond_003.png" class="crp_thumb crp_featured" alt="How to Develop a Conditional GAN (cGAN) From Scratch" title="How to Develop a Conditional GAN (cGAN) From Scratch" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-100-Generated-items-of-Clothing-using-an-Cond_003.png 1280w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-100-Generated-items-of-Clothing-using-an-Cond_002.png 300w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-100-Generated-items-of-Clothing-using-an-Cond_004.png 768w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-100-Generated-items-of-Clothing-using-an-Cond_005.png 1024w" sizes="(max-width: 150px) 100vw, 150px" width="150" height="113"></figure><span class="crp_title">How to Develop a Conditional GAN (cGAN) From Scratch</span></a></li><li><a href="https://machinelearningmastery.com/how-to-develop-a-generative-adversarial-network-for-an-mnist-handwritten-digits-from-scratch-in-keras/" class="crp_link post-8099"><figure><img loading="lazy" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Plot-of-100-GAN-Generated-MNIST-Figures-After-100-Epochs.webp" class="crp_thumb crp_featured" alt="How to Develop a GAN for Generating MNIST Handwritten Digits" title="How to Develop a GAN for Generating MNIST Handwritten Digits" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Plot-of-100-GAN-Generated-MNIST-Figures-After-100-Epochs.webp 640w, How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Plot-of-100-GAN-Generated-MNIST-Figures-After-100-Epochs-300.png 300w" sizes="(max-width: 150px) 100vw, 150px" width="150" height="113"></figure><span class="crp_title">How to Develop a GAN for Generating MNIST Handwritten Digits</span></a></li></ul><div class="crp_clear"></div></div>	</section><!-- /.entry -->
	<div class="fix"></div>
	<aside id="post-author">
	<div class="profile-image"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a.png 2x" class="avatar avatar-80 photo" loading="lazy" width="80" height="80"></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches 
developers how to get results with modern machine learning methods via 
hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/how-to-develop-a-conditional-generative-adversarial-network-from-scratch/" rel="prev"><i class="fa fa-angle-left"></i> How to Develop a Conditional GAN (cGAN) From Scratch</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/tour-of-generative-adversarial-network-models/" rel="next">A Tour of Generative Adversarial Network Models <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">105 Responses to <em>How to Identify and Diagnose GAN Failure Modes</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-502800" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-502800" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a3e054eb36e28a94cb50ab00d9be00dd_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a3e054eb36e28a94cb50ab00d9be00dd.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kinn</span>
	                <span class="date">September 24, 2019 at 4:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-502800" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,great article again.<br>
There is my two little questions:<br>
1.In the chapter about Convergence Failure,the first way to mess things 
up that you mentioned is vstacking the real and false examples.<br>
Its quite out of my mind how come training difference types of sample 
will causes such failure,especailly after I followed the other post 
[https://machinelearningmastery.com/how-to-develop-a-generative-adversarial-network-for-an-mnist-handwritten-digits-from-scratch-in-keras/].<br>
In the post linked above you demonstrated vstacking and the results went well.(so as I tried)<br>
2.Maybe the same question with the first one(also happened during trying
 the post linked above).But a curious things happened when I tried add 
BatchNormalization layers to the original code of yours,that Convergence
 Failure happened.<br>
How come harmless-seemed BatchNormalization causes such failure?</p>
<p>Thank you for reading this long questions.Looking forward to hear your reply.<br>
Best Reguards.</p>
<p>By the by,I tried your work in kaggle.link is : <a href="https://www.kaggle.com/jinyongnan/the-basic-2dgans" rel="nofollow ugc">https://www.kaggle.com/jinyongnan/the-basic-2dgans</a><br>
Version 3 is the one with BatchNormalization,Version 4 is the one without.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-502800" data-commentid="502800" data-postid="8173" data-belowelement="comment-502800" data-respondelement="respond" data-replyto="Reply to Kinn" aria-label="Reply to Kinn">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-502871" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-502871" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 25, 2019 at 5:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-502871" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good questions.</p>
<p>It is often better to not stack real/fake images during training. 
Perhaps try both ways and see what works best for your specific problem.</p>
<p>The models are very sensitive and small changes can cause a failure. 
Test changes carefully, and cause and effect (the why) is challenging to
 determine.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-502871" data-commentid="502871" data-postid="8173" data-belowelement="comment-502871" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514021" class="comment even depth-3 parent">

	      	<div id="li-comment-514021" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/219a804e104c5480d3235554de824fdf_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/219a804e104c5480d3235554de824fdf.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">December 7, 2019 at 7:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-514021" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do you know any papers or other sources that analyze in more 
depth why it is better not to stack real and fake images during 
training? That is very unintuitive to me as well, and I’d like to learn 
more about why this is the case.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-514021" data-commentid="514021" data-postid="8173" data-belowelement="comment-514021" data-respondelement="respond" data-replyto="Reply to Eric" aria-label="Reply to Eric">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514137" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-514137" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 8, 2019 at 6:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-514137" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not really, like most of the GAN heuristics it is empirical/tacit knowledge.</p>
<p>This might have something:<br>
<a href="https://github.com/soumith/ganhacks" rel="nofollow ugc">https://github.com/soumith/ganhacks</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-514137" data-commentid="514137" data-postid="8173" data-belowelement="comment-514137" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-530091" class="comment even depth-4 parent">

	      	<div id="li-comment-530091" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/122ea97338775b22907a884a2e270879.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/122ea97338775b22907a884a2e270879_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jamie</span>
	                <span class="date">April 17, 2020 at 6:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-530091" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It seems to be related to batch normalization. My initial trial 
seems to suggest that if you use batch normalization, and you train the 
discriminator with a mixed real/fake batch, it may run into problem. If 
you train with batch containing only real follow by only fake, you may 
still run into problem, but at much later epochs. Also, if you do run 
into problem (i.e. loss goes to 0 or inf), you can stop training, and 
load the parameters from last saved point when the model was still ok. 
When you continue training, you may not fall into the same quagmire.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-530091" data-commentid="530091" data-postid="8173" data-belowelement="comment-530091" data-respondelement="respond" data-replyto="Reply to Jamie" aria-label="Reply to Jamie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-530103" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-530103" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 17, 2020 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-530103" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great observation!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-508585" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-508585" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/09a44d74daef220de11eaae4e92c8be8_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/09a44d74daef220de11eaae4e92c8be8.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Erkin Kamilov</span>
	                <span class="date">November 4, 2019 at 9:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-508585" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you are interested I tested your stable architecture with a few changes:<br>
(Dis is discriminator, gen is generator)</p>
<p>Averagepooling in dis, upsampling in gen, stride = 1×1:<br>
<a href="https://drive.google.com/file/d/1K8CFI1X3CORXBvXKOUaCAI8L0aKobLpa/view?usp=sharing" rel="nofollow ugc">https://drive.google.com/file/d/1K8CFI1X3CORXBvXKOUaCAI8L0aKobLpa/view?usp=sharing</a><br>
(I didn’t detect changes in the quality of the gen output after training
 on MNIST dataset, but on comclicated data it gives better results 
instead stride = 2×2)</p>
<p>++ Filters sizes = 3×3:<br>
<a href="https://drive.google.com/file/d/1nuIKvTleXNBtDdOgL4UQ46YA7I-RJOk9/view?usp=sharing" rel="nofollow ugc">https://drive.google.com/file/d/1nuIKvTleXNBtDdOgL4UQ46YA7I-RJOk9/view?usp=sharing</a><br>
(A little bit worse image generation but everyone recommends using odd filter size)</p>
<p>++ FIlters numer 32-64 in dis and 64-32 in gen instead 64-64 in dis and 128-128 in gen:<br>
<a href="https://drive.google.com/file/d/1QwaUbTw9Fs3hGpYhLE7zTJyJCnmRBKyk/view?usp=sharing" rel="nofollow ugc">https://drive.google.com/file/d/1QwaUbTw9Fs3hGpYhLE7zTJyJCnmRBKyk/view?usp=sharing</a><br>
(Same generated imgs after training, but using mirror-like generator and
 discriminator maximizes network training stability. You’ll not notice 
this on simple datasets like MNIST, but i have seen training crash on 
complicated 3D data just because im using non mirrored GAN)</p>
<p>++ Dis learning rate x2:<br>
<a href="https://drive.google.com/file/d/1IkUuKZNlBCiNJqKkAWHtDvQyw-Tvomlg/view?usp=sharing" rel="nofollow ugc">https://drive.google.com/file/d/1IkUuKZNlBCiNJqKkAWHtDvQyw-Tvomlg/view?usp=sharing</a><br>
(I saw that it is used sometimes but dont know why. I have tested x3, but more smooth loss and training accuracy on x2)</p>
<p>Comprasion (before/after):<br>
iteration 45:<br>
before – <a href="https://drive.google.com/open?id=1uaiSp_OCIlcV79wYfybDMJR3g3xR7O4C" rel="nofollow ugc">https://drive.google.com/open?id=1uaiSp_OCIlcV79wYfybDMJR3g3xR7O4C</a><br>
after – <a href="https://drive.google.com/open?id=1Mu6BInIVnC17jigiTh4L1aOqAnieeitv" rel="nofollow ugc">https://drive.google.com/open?id=1Mu6BInIVnC17jigiTh4L1aOqAnieeitv</a></p>
<p>iteration 450:<br>
before – <a href="https://drive.google.com/open?id=1Bspoo7BwuzyaA7CCYVig1d2qfTyNrHSa" rel="nofollow ugc">https://drive.google.com/open?id=1Bspoo7BwuzyaA7CCYVig1d2qfTyNrHSa</a><br>
after – <a href="https://drive.google.com/open?id=1vwmtinHEGDfkrB-TTU8-XhtVrb30jEPK" rel="nofollow ugc">https://drive.google.com/open?id=1vwmtinHEGDfkrB-TTU8-XhtVrb30jEPK</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-508585" data-commentid="508585" data-postid="8173" data-belowelement="comment-508585" data-respondelement="respond" data-replyto="Reply to Erkin Kamilov" aria-label="Reply to Erkin Kamilov">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-508586" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-508586" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/09a44d74daef220de11eaae4e92c8be8_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/09a44d74daef220de11eaae4e92c8be8.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Erkin Kamilov</span>
	                <span class="date">November 4, 2019 at 9:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-508586" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sorry for my poor English</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-508586" data-commentid="508586" data-postid="8173" data-belowelement="comment-508586" data-respondelement="respond" data-replyto="Reply to Erkin Kamilov" aria-label="Reply to Erkin Kamilov">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-508598" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-508598" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 4, 2019 at 1:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-508598" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not at all, we want results, not great english around here 🙂</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-508598" data-commentid="508598" data-postid="8173" data-belowelement="comment-508598" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-508597" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-508597" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 4, 2019 at 1:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-508597" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-508597" data-commentid="508597" data-postid="8173" data-belowelement="comment-508597" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-515728" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-515728" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/29b79e72db03ee4a3fa7843d38677182.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/29b79e72db03ee4a3fa7843d38677182_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nhan</span>
	                <span class="date">December 19, 2019 at 2:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-515728" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,<br>
First of all, thank you for the article!<br>
I have a question. After training my model for 500 epochs, the acc_real 
and acc_fake remain 0. There is no change during training and generated 
images indicate that the model fails to converge. The loss for 
discriminator and generator oscillates but most remains at 0. Can you 
explain this and how to solve it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-515728" data-commentid="515728" data-postid="8173" data-belowelement="comment-515728" data-respondelement="respond" data-replyto="Reply to Nhan" aria-label="Reply to Nhan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-515731" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-515731" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 19, 2019 at 3:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-515731" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally, GAN models do not converge. I explain more here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-515731" data-commentid="515731" data-postid="8173" data-belowelement="comment-515731" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516084" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-516084" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/29b79e72db03ee4a3fa7843d38677182.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/29b79e72db03ee4a3fa7843d38677182_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nhan</span>
	                <span class="date">December 23, 2019 at 8:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-516084" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the suggestion.<br>
I fixed the problem by removing label smoothing. The loss and acc are 
fluctuating as expected. However, when I looked at the generated images,
 the images look like they are improving and then back to noisy images 
again and repeat that many times during training. Can you help me figure
 out why the situation happened?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516084" data-commentid="516084" data-postid="8173" data-belowelement="comment-516084" data-respondelement="respond" data-replyto="Reply to Nhan" aria-label="Reply to Nhan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516152" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-516152" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 24, 2019 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-516152" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done.</p>
<p>Yes, you must save models frequently during training, then post-hoc 
evaluate them by the images they generate in order to choose a final 
model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516152" data-commentid="516152" data-postid="8173" data-belowelement="comment-516152" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516141" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-516141" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/4895c1a1f4c95b4f4f3abc220026b68b_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/4895c1a1f4c95b4f4f3abc220026b68b.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Frank Zhu</span>
	                <span class="date">December 24, 2019 at 3:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-516141" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That is really great article. Thanks, Jason</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516141" data-commentid="516141" data-postid="8173" data-belowelement="comment-516141" data-respondelement="respond" data-replyto="Reply to Frank Zhu" aria-label="Reply to Frank Zhu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516171" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-516171" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 24, 2019 at 6:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-516171" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I’m happy it helped!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516171" data-commentid="516171" data-postid="8173" data-belowelement="comment-516171" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516458" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-516458" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/0b726ea47c20e268173d1d0e87632bef_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/0b726ea47c20e268173d1d0e87632bef.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dang Tuan Hoang</span>
	                <span class="date">December 27, 2019 at 7:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-516458" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. Thanks for the great article !<br>
I’m training a pix2pix model, my discriminator losses on both real and 
fake sample vary around 0.3 after few iterations, while generator loss 
go down. Do you know what this indicates ?<br>
If you have time, please take a look at my graphs.<br>
<a href="https://drive.google.com/file/d/16NSq5FdKRyIm3oxrVXCXL1-yU9LefGRS/view?usp=sharing" rel="nofollow ugc">https://drive.google.com/file/d/16NSq5FdKRyIm3oxrVXCXL1-yU9LefGRS/view?usp=sharing</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516458" data-commentid="516458" data-postid="8173" data-belowelement="comment-516458" data-respondelement="respond" data-replyto="Reply to Dang Tuan Hoang" aria-label="Reply to Dang Tuan Hoang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516490" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-516490" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 28, 2019 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-516490" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No.</p>
<p>Perhaps try some of the countermeasures here:<br>
<a href="https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516490" data-commentid="516490" data-postid="8173" data-belowelement="comment-516490" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516664" class="comment even depth-3 parent">

	      	<div id="li-comment-516664" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/0b726ea47c20e268173d1d0e87632bef_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/0b726ea47c20e268173d1d0e87632bef.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dang Tuan Hoang</span>
	                <span class="date">December 30, 2019 at 8:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-516664" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I modified your pix2pix implementation, so most of the 
hacks are implemented already. I use mae and log loss for generator. I 
might be wrong but It’s seem that the remaining differences (20×20) is 
too small compare to input size (512,512). Therefor the loss very really
 small and discriminator and generator loss can’t go any lower. Do you 
have any suggestion to make the networks learn low level features better
 ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516664" data-commentid="516664" data-postid="8173" data-belowelement="comment-516664" data-respondelement="respond" data-replyto="Reply to Dang Tuan Hoang" aria-label="Reply to Dang Tuan Hoang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516702" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-516702" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 31, 2019 at 7:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-516702" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work!</p>
<p>Not offhand, explore ideas with controlled experiments.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516702" data-commentid="516702" data-postid="8173" data-belowelement="comment-516702" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-518596" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-518596" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/002ffaf17061fdf287bf5fdd54e532a8.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/002ffaf17061fdf287bf5fdd54e532a8_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdullah Turgay</span>
	                <span class="date">January 21, 2020 at 5:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-518596" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason!</p>
<p>great work as always! I have a little problem with the GAN I am currently training and would love to hear your opinion on this.</p>
<p>So I have input data consisting of 1008 features where each feature 
gets 0/1 and portrays whether or not someone ist at home during a 10min 
interval.<br>
My goal is to make the GAN create those kind of activity profiles. 
However, the problem I face is that my GAN currently creates profiles 
where the shares of single timestep activity durations (a person is 
outside for 10min and then at home again, or the other way: is at home 
for 10min and then goes outside again) are way higher than in the real 
data. The shares of other activity duration (20min, 30min, 40min …) are 
very close to the real data! This really confuses me.. The GAN model 
creates realistic data besides for having too many of these little 
errors.</p>
<p>What do you think about this? What could solve this issue?</p>
<p>Best regards,</p>
<p>Abdullah</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-518596" data-commentid="518596" data-postid="8173" data-belowelement="comment-518596" data-respondelement="respond" data-replyto="Reply to Abdullah Turgay" aria-label="Reply to Abdullah Turgay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-518624" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-518624" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 21, 2020 at 7:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-518624" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You perhaps should use a generative model that allow you to impose constraints to ensure generated data is plausible.</p>
<p>Perhaps look into probabilistic graphical models.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-518624" data-commentid="518624" data-postid="8173" data-belowelement="comment-518624" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-520796" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-520796" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/f58c3352cf347fb18e38c7b4a513bab4_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/f58c3352cf347fb18e38c7b4a513bab4.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">AnithaThomas</span>
	                <span class="date">February 8, 2020 at 1:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-520796" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How to Reduce Noise in Generated image,<br>
Is dropout and Adam possible to use in GAN</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-520796" data-commentid="520796" data-postid="8173" data-belowelement="comment-520796" data-respondelement="respond" data-replyto="Reply to AnithaThomas" aria-label="Reply to AnithaThomas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-520840" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-520840" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 8, 2020 at 7:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-520840" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Some ideas here:<br>
<a href="https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-520840" data-commentid="520840" data-postid="8173" data-belowelement="comment-520840" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-522792" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-522792" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d37e14fdfb0da5de05d1f636d9b106ce.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d37e14fdfb0da5de05d1f636d9b106ce_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">GDR92</span>
	                <span class="date">February 22, 2020 at 8:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-522792" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the very nice article. I have two questions:</p>
<p>Question 1: I have trained a GAN and obtained the log loss shown in 
the image in below URL. How do I interpret this? More specifically, what
 does it tell about the following:</p>
<p><a href="https://drive.google.com/file/d/1F7U8CJoSFEC81B8FyOXwu9LhikUD3-vi/view?usp=sharing" rel="nofollow ugc">https://drive.google.com/file/d/1F7U8CJoSFEC81B8FyOXwu9LhikUD3-vi/view?usp=sharing</a> </p>
<p>(i) Generator convergence<br>
(ii) Discriminator performance<br>
(iii) Which iteration the training should be stopped?<br>
(iv) The generator model produced at which iteration should be used to generate plausible data?</p>
<p>Question 2: After training a GAN, why we are not taking the generator
 model produce at the last training iteration to generate plausible 
data? Isn’t the GAN convergence always improve as the training 
iterations increase?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-522792" data-commentid="522792" data-postid="8173" data-belowelement="comment-522792" data-respondelement="respond" data-replyto="Reply to GDR92" aria-label="Reply to GDR92">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-522854" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-522854" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 23, 2020 at 7:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-522854" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>GANs don’t converge:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging</a></p>
<p>No. You save models throughput the run, test each and pick one that produces results that you like.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-522854" data-commentid="522854" data-postid="8173" data-belowelement="comment-522854" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-522878" class="comment even depth-3 parent">

	      	<div id="li-comment-522878" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d37e14fdfb0da5de05d1f636d9b106ce.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d37e14fdfb0da5de05d1f636d9b106ce_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">GDR92</span>
	                <span class="date">February 23, 2020 at 10:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-522878" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for the answer. Can you please have a look at the 1st question in my post as well?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-522878" data-commentid="522878" data-postid="8173" data-belowelement="comment-522878" data-respondelement="respond" data-replyto="Reply to GDR92" aria-label="Reply to GDR92">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-522967" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-522967" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 24, 2020 at 7:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-522967" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>From the plot, the training process might be stable.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-522967" data-commentid="522967" data-postid="8173" data-belowelement="comment-522967" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-523528" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-523528" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/235a5942e45a3a0d3ce9866ae5c397b2.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/235a5942e45a3a0d3ce9866ae5c397b2_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Denis</span>
	                <span class="date">February 27, 2020 at 11:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-523528" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the great article! It is very useful. </p>
<p>Two interesting questions remain to be dark matter for me. </p>
<p>1. How does latent space size affect a model convergence?</p>
<p>2. What are recomendations for model capacities in general? (total 
number of trainable parameters) and to not to overestimate/underestimate
 required capacity for a given task.</p>
<p>Would you share your intuition on that.</p>
<p>Thanks again for the great article.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-523528" data-commentid="523528" data-postid="8173" data-belowelement="comment-523528" data-respondelement="respond" data-replyto="Reply to Denis" aria-label="Reply to Denis">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-523580" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-523580" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 28, 2020 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-523580" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>GANs don’t converge:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging</a></p>
<p>We don’t have good theories re model size vs capability. The best we can do is controlled experiments.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-523580" data-commentid="523580" data-postid="8173" data-belowelement="comment-523580" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529099" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-529099" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a106fc8bf19771ddbbf1fe05582f0fb7_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a106fc8bf19771ddbbf1fe05582f0fb7.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">wysohn</span>
	                <span class="date">April 10, 2020 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-529099" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello professor!</p>
<p>Fabulous article as always.</p>
<p>It helped me a lot to figure out how my model is doing.</p>
<p>I have a question for you! I realized that you have used random 
normal initialized with std 0.02, and I wonder what was the idea behind 
it.</p>
<p>I just encountered Nan in my gradient, and I suspect that the wrong 
initializer might be the one that caused it. (it was glorot uniform, 
which was the default initializer)</p>
<p>I have gradient clipping enabled so not sure where the gradient could overshoot.</p>
<p>Do you have any suggestions in this case?</p>
<p>Thank you!</p>
<p>Sincerely</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-529099" data-commentid="529099" data-postid="8173" data-belowelement="comment-529099" data-respondelement="respond" data-replyto="Reply to wysohn" aria-label="Reply to wysohn">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529149" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-529149" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 10, 2020 at 8:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-529149" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not a professor.</p>
<p>You can see the reason why here:<br>
<a href="https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-529149" data-commentid="529149" data-postid="8173" data-belowelement="comment-529149" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-531078" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-531078" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/f1723a745d54655b3cfa8c77f515abe9_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/f1723a745d54655b3cfa8c77f515abe9.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Baptiste</span>
	                <span class="date">April 22, 2020 at 8:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-531078" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Thank you so much for you very intuitive and instructive lessons !</p>
<p>Thanks to you, I’ve implemented an auxiliary classifier GAN to produce some medical images.<br>
The architecture is more or less the same as here :<br>
<a href="https://drive.google.com/file/d/1vFcfb9JuBovlfAN4ajBdcTtmMbxOn35z/view?usp=sharing" rel="nofollow ugc">https://drive.google.com/file/d/1vFcfb9JuBovlfAN4ajBdcTtmMbxOn35z/view?usp=sharing</a><br>
found in [1].</p>
<p>After some training, I’ve got always the learning curves as follows :<br>
<a href="https://drive.google.com/file/d/1AbTV41MizaJJaxYEOJSkV2wgKI9G4W9S/view?usp=sharing" rel="nofollow ugc">https://drive.google.com/file/d/1AbTV41MizaJJaxYEOJSkV2wgKI9G4W9S/view?usp=sharing</a></p>
<p>Your tips are very instructive and after implementation and few modifications in the architecture the curves looks like this :<br>
<a href="https://drive.google.com/file/d/1yoH9voIv6xyFKHogg_AnnGMjuEyBm3hu/view?usp=sharing" rel="nofollow ugc">https://drive.google.com/file/d/1yoH9voIv6xyFKHogg_AnnGMjuEyBm3hu/view?usp=sharing</a><br>
Not perfect but still the best training until now by observing the curves and the output images.</p>
<p>However, for each class, the generator produce each time variations of the same image or noisy images.<br>
Do you have any recommandations ?</p>
<p>Thank you again for your lessons !</p>
<p>[1] Madani A. et al., Deep echocardiography: data-efficient 
supervised and semi-supervised deep learning towards automated diagnosis
 of cardiac desease, In: NPJ Digital Medicine vol 1. 2018.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-531078" data-commentid="531078" data-postid="8173" data-belowelement="comment-531078" data-respondelement="respond" data-replyto="Reply to Baptiste" aria-label="Reply to Baptiste">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-531181" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-531181" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 23, 2020 at 6:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-531181" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done!</p>
<p>Sorry, I don’t open attachments.</p>
<p>Perhaps try adjusting the model or training parameters? Experiment.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-531181" data-commentid="531181" data-postid="8173" data-belowelement="comment-531181" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-543914" class="comment even depth-2">

	      	<div id="li-comment-543914" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/2655b61b968a12db63e34f95b6b7dcc7_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/2655b61b968a12db63e34f95b6b7dcc7.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">zahra</span>
	                <span class="date">July 14, 2020 at 12:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-543914" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello<br>
would you please share your code</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-543914" data-commentid="543914" data-postid="8173" data-belowelement="comment-543914" data-respondelement="respond" data-replyto="Reply to zahra" aria-label="Reply to zahra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-533300" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-533300" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/77c9378bf28336a823c5bf47b6376d3c_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/77c9378bf28336a823c5bf47b6376d3c.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Stef</span>
	                <span class="date">May 5, 2020 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-533300" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,<br>
I’ve copy-pasted this code but the results are completely different (aka
 not converging). Would it be possible to  make the code deterministic?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533300" data-commentid="533300" data-postid="8173" data-belowelement="comment-533300" data-respondelement="respond" data-replyto="Reply to Stef" aria-label="Reply to Stef">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-533310" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-533310" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 5, 2020 at 7:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-533310" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>GANs do not converge:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging</a></p>
<p>No, the stochastic nature of the learning algorithm is a feature, not a bug.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533310" data-commentid="533310" data-postid="8173" data-belowelement="comment-533310" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-533468" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-533468" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/77c9378bf28336a823c5bf47b6376d3c_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/77c9378bf28336a823c5bf47b6376d3c.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Stef</span>
	                <span class="date">May 6, 2020 at 12:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-533468" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the reply but I do not agree. Despite I understand the
 stochastic nature of GAN, non-determinism in testing is never a 
feature, especially when it prevents an article to be reproduced: a seed
 shall be provided in order to make it deterministic and reproducible.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533468" data-commentid="533468" data-postid="8173" data-belowelement="comment-533468" data-respondelement="respond" data-replyto="Reply to Stef" aria-label="Reply to Stef">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-533484" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-533484" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 6, 2020 at 1:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-533484" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing your opinion.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533484" data-commentid="533484" data-postid="8173" data-belowelement="comment-533484" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-533656" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-533656" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/32ba2a004751a47a1f8ced29472e1c8c.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/32ba2a004751a47a1f8ced29472e1c8c_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Doudle</span>
	                <span class="date">May 7, 2020 at 2:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-533656" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason,</p>
<p>Thanks for your great post.</p>
<p>I have question, it’s about vstacking the real and fake images to train the discriminator. </p>
<p>I have tried the code, and got the same result as yours. What 
confused me is the loss of G and acc of D. As we observed, the acc of D 
is near 100%, which means D can identify almost every image 
correctly(partially due to the poor quality of the generated fake image,
 it seems they are easy to identify). However, why the loss of G is so 
low, to my intuitive, the generated fake images are easy to be 
identified as fake, the loss of G should be very high. Can you tell me 
where I am wrong, thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533656" data-commentid="533656" data-postid="8173" data-belowelement="comment-533656" data-respondelement="respond" data-replyto="Reply to Doudle" aria-label="Reply to Doudle">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-533765" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-533765" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 8, 2020 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-533765" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome!</p>
<p>Accuracy might be a bad metric to monitor during training.</p>
<p>Also, loss does not give ideas about the skill of the GAN, e.g. GAN’s don’t converge, they are unstable by definition:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533765" data-commentid="533765" data-postid="8173" data-belowelement="comment-533765" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-535235" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-535235" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/896a78097579450d8299b80a30c260be.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/896a78097579450d8299b80a30c260be_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shreyash</span>
	                <span class="date">May 18, 2020 at 2:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-535235" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great Tutorial!! I ran into a problem with my gan where the losses 
were in range and stabilized but my discriminator accuracy does not seem
 to go above 50 for both real and fake images in spite of using a pre 
trained model. What does the error possibly be?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-535235" data-commentid="535235" data-postid="8173" data-belowelement="comment-535235" data-respondelement="respond" data-replyto="Reply to Shreyash" aria-label="Reply to Shreyash">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-535321" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-535321" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 19, 2020 at 5:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-535321" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>
<p>Ignore accuracy, it’s not a reliable metric. Focus on loss.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-535321" data-commentid="535321" data-postid="8173" data-belowelement="comment-535321" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-535236" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-535236" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/896a78097579450d8299b80a30c260be.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/896a78097579450d8299b80a30c260be_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shreyash</span>
	                <span class="date">May 18, 2020 at 2:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-535236" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>And all the output images also just seem to be plain gray images.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-535236" data-commentid="535236" data-postid="8173" data-belowelement="comment-535236" data-respondelement="respond" data-replyto="Reply to Shreyash" aria-label="Reply to Shreyash">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-535322" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-535322" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 19, 2020 at 5:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-535322" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try changing the architecture of the model or the hyperparameters of the learning algorithm:<br>
<a href="https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-535322" data-commentid="535322" data-postid="8173" data-belowelement="comment-535322" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-538376" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-538376" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/5e62004ad79da2a1995e2509f5cad111.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/5e62004ad79da2a1995e2509f5cad111_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vishu</span>
	                <span class="date">June 6, 2020 at 5:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-538376" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the article<br>
my generator loss is showing huge variation from -500 t +500 but 
discrimnator loss is almost constant varying from 0.3 to 0.6.Please help
 me out i m really stuck</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-538376" data-commentid="538376" data-postid="8173" data-belowelement="comment-538376" data-respondelement="respond" data-replyto="Reply to vishu" aria-label="Reply to vishu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-538447" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-538447" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 7, 2020 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-538447" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps focus on the generated images and whether that are good or not.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-538447" data-commentid="538447" data-postid="8173" data-belowelement="comment-538447" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-540184" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-540184" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a49b68fb6e9fb725ea63399d79ada275_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a49b68fb6e9fb725ea63399d79ada275.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Stefanos</span>
	                <span class="date">June 19, 2020 at 9:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-540184" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>I am an MSc Candidate in A.I. </p>
<p>I am employing cGan model in an effort to generate reliable COVID-19 CXR and, I found your post useful. </p>
<p>Thank you for your helpful explanation you provide.<br>
I really appreciate your effort and your passion doing this. </p>
<p>Very Best,<br>
Stefanos</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-540184" data-commentid="540184" data-postid="8173" data-belowelement="comment-540184" data-respondelement="respond" data-replyto="Reply to Stefanos" aria-label="Reply to Stefanos">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-540231" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-540231" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 20, 2020 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-540231" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-540231" data-commentid="540231" data-postid="8173" data-belowelement="comment-540231" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-540725" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-540725" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a61476f0131c67a1c32e56eef23b6a4b.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a61476f0131c67a1c32e56eef23b6a4b_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gassara</span>
	                <span class="date">June 23, 2020 at 7:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-540725" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Very practical and useful guide!<br>
looking forward for StyleGAN implementation.<br>
just a little note: maybe you meant “increase” in the following sentence of the last section: </p>
<p>The loss for the generator is expected to either decrease to zero or continually decrease during training.</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-540725" data-commentid="540725" data-postid="8173" data-belowelement="comment-540725" data-respondelement="respond" data-replyto="Reply to Gassara" aria-label="Reply to Gassara">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-540810" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-540810" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 24, 2020 at 6:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-540810" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>Why would we expect loss increase?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-540810" data-commentid="540810" data-postid="8173" data-belowelement="comment-540810" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-541299" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-541299" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a61476f0131c67a1c32e56eef23b6a4b.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a61476f0131c67a1c32e56eef23b6a4b_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gassara</span>
	                <span class="date">June 27, 2020 at 2:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-541299" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>if I understood it correctly, in the paragraph below, you present
 the properties of convergence failure during GANs training. Among these
 properties we found (as you mentionned): The loss for the generator is 
expected to either decrease to zero or continually “increase” during 
training. </p>
<p>Correct me if I am wrong please.<br>
Thanks!</p>
<p>—————————————————————————————<br>
We can review the properties of a convergence failure as follows:</p>
<p>-)The loss for the discriminator is expected to rapidly decrease to a value close to zero where it remains during training.<br>
-)The loss for the generator is expected to either decrease to zero or continually decrease during training.<br>
-)The generator is expected to produce extremely low-quality images that are easily identified as fake by the discriminator.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-541299" data-commentid="541299" data-postid="8173" data-belowelement="comment-541299" data-respondelement="respond" data-replyto="Reply to Gassara" aria-label="Reply to Gassara">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-541332" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-541332" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 27, 2020 at 5:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-541332" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>As heuristics, these are a good start for a DCGAN.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-541332" data-commentid="541332" data-postid="8173" data-belowelement="comment-541332" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-541120" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-541120" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/4e052ed6b79d111f95803b3720439bae_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/4e052ed6b79d111f95803b3720439bae.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://github.com/frezaeix" rel="external nofollow ugc" class="url">Farzaneh Rezaei</a></span>
	                <span class="date">June 26, 2020 at 1:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-541120" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Very Nice, thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-541120" data-commentid="541120" data-postid="8173" data-belowelement="comment-541120" data-respondelement="respond" data-replyto="Reply to Farzaneh Rezaei" aria-label="Reply to Farzaneh Rezaei">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-541166" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-541166" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 26, 2020 at 5:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-541166" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-541166" data-commentid="541166" data-postid="8173" data-belowelement="comment-541166" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-542264" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-542264" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d8388074b8b268a4d44dba3621cda606.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d8388074b8b268a4d44dba3621cda606_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">blauge</span>
	                <span class="date">July 1, 2020 at 10:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-542264" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, thanks for such a great article. </p>
<p>Here are some problems I’ve faced and doubts I have:</p>
<p>1: </p>
<p>I’ve copied the code exactly as in the article for the stable GAN.<br>
But my plots do not seem to match at all, my plots from your stable GAN 
code seem to match the plots of the code for convergence failure.<br>
Generated images are almost garbage, as expected.</p>
<p>2: </p>
<p>I found the terminology used for ‘epoch’ in this article very confusing.<br>
An epoch is when the model is trained on the entire dataset once, right?<br>
This definition of epoch complies with the one in the code.<br>
However, when you mentioned epoch in the article, you refer to every step trained on a batch.</p>
<p>Could you please clarify on these?<br>
Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-542264" data-commentid="542264" data-postid="8173" data-belowelement="comment-542264" data-respondelement="respond" data-replyto="Reply to blauge" aria-label="Reply to blauge">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-542334" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-542334" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 2, 2020 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-542334" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You might need to try training a GAN a few times until you get a useful model/reliable training process.</p>
<p>Agreed!!! Epoch stops making sense with GANs. It’s really iterations of a single batch.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-542334" data-commentid="542334" data-postid="8173" data-belowelement="comment-542334" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-542455" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-542455" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/98047b0adc3eccc0a52845ba137727a8.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/98047b0adc3eccc0a52845ba137727a8_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mackenzie</span>
	                <span class="date">July 2, 2020 at 7:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-542455" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The GAN used in this post is basically DCGAN? Because it uses convolutional layers?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-542455" data-commentid="542455" data-postid="8173" data-belowelement="comment-542455" data-respondelement="respond" data-replyto="Reply to Mackenzie" aria-label="Reply to Mackenzie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-542543" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-542543" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 3, 2020 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-542543" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, but we concepts are general to most GANs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-542543" data-commentid="542543" data-postid="8173" data-belowelement="comment-542543" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-543915" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-543915" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d921bd55b73b2b29201b68f44e9f5195_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d921bd55b73b2b29201b68f44e9f5195.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">mahdi</span>
	                <span class="date">July 14, 2020 at 12:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-543915" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi<br>
thanks for your article<br>
I have a question<br>
I am working on 3D image and i use adam optimizer.I set learning rate=1e-04 for Dis and 1.1e-05 for Gen<br>
the loss of my Disc goes around 0.4-0.6 but the loss of Gen rise<br>
would you please help me?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-543915" data-commentid="543915" data-postid="8173" data-belowelement="comment-543915" data-respondelement="respond" data-replyto="Reply to mahdi" aria-label="Reply to mahdi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-543968" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-543968" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 14, 2020 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-543968" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try using SGD directly and explore different learning rates.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-543968" data-commentid="543968" data-postid="8173" data-belowelement="comment-543968" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-563432" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-563432" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/06f944a4cb508266b839ff167fd54b42_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/06f944a4cb508266b839ff167fd54b42.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Klaus</span>
	                <span class="date">September 16, 2020 at 5:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-563432" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for the great tutorial! What would you do if you
 found the d-real loss to be at a good range (around 0.5) but both 
d-fake and g are going to zero? This has made me quite unsure about if 
the generator or the discriminator is too weak/too strong, because 
d-fake going to zero would suggest that the discriminator is too strong,
 clearly identifying fake images, but g going to zero would suggest that
 the generator is too strong… Any idea what I should change in this 
case? Thanks a lot!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-563432" data-commentid="563432" data-postid="8173" data-belowelement="comment-563432" data-respondelement="respond" data-replyto="Reply to Klaus" aria-label="Reply to Klaus">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-563482" class="comment even depth-2 parent">

	      	<div id="li-comment-563482" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/06f944a4cb508266b839ff167fd54b42_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/06f944a4cb508266b839ff167fd54b42.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Klaus</span>
	                <span class="date">September 17, 2020 at 12:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-563482" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Solved this by removing BatchNormalization layers!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-563482" data-commentid="563482" data-postid="8173" data-belowelement="comment-563482" data-respondelement="respond" data-replyto="Reply to Klaus" aria-label="Reply to Klaus">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-563529" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-563529" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 17, 2020 at 6:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-563529" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-563529" data-commentid="563529" data-postid="8173" data-belowelement="comment-563529" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-563517" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-563517" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 17, 2020 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-563517" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>
<p>There’s no good loss values for GANs, instead there are dynamics for 
the two models to focus on/watch. Zero loss is probably a bad sign – 
meaning one model is dominating.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-563517" data-commentid="563517" data-postid="8173" data-belowelement="comment-563517" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-563481" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-563481" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/cdd2acc3d6a122e0d5066529a693eb37_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/cdd2acc3d6a122e0d5066529a693eb37.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anna</span>
	                <span class="date">September 17, 2020 at 12:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-563481" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, you say: “A stable GAN will have a discriminator loss 
around 0.5, typically between 0.5 and maybe as high as 0.7 or 0.8. The 
generator loss is typically higher and may hover around 1.0, 1.5, 2.0, 
or even higher.”</p>
<p>Is there anything you can direct me to that explains a bit more in 
detail why these values are ideal? I’m trying to understand the math 
behind binary cross entropy and why these are the most optimal values, 
is there any paper/article that goes more in depth on that? Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-563481" data-commentid="563481" data-postid="8173" data-belowelement="comment-563481" data-respondelement="respond" data-replyto="Reply to Anna" aria-label="Reply to Anna">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-563528" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-563528" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 17, 2020 at 6:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-563528" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, it from experience. We don’t have good theories of GANs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-563528" data-commentid="563528" data-postid="8173" data-belowelement="comment-563528" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-564340" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-564340" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d10944b421af5e6c5f37a93ea1230152.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d10944b421af5e6c5f37a93ea1230152_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Caspar</span>
	                <span class="date">September 22, 2020 at 8:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-564340" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for a very nice article! I have an additional question. I’m 
training a Wasserstein GAN myself. As you may know, these don’t have a 
softmax activation at the end, and correspondingly the ‘discriminator’ 
is not really a discriminator, but a ‘critic’. This means that I don’t 
have an accuracy, and my loss is very different.</p>
<p>Do you know if for Wasserstein GANs there are similar ways to 
identify convergence failure or mode collapse from the loss function (or
 any other metric I could potentially compute)?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-564340" data-commentid="564340" data-postid="8173" data-belowelement="comment-564340" data-respondelement="respond" data-replyto="Reply to Caspar" aria-label="Reply to Caspar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-564395" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-564395" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 23, 2020 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-564395" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It does not as far as I know. Instead, watch the generated images every n epochs to get an idea of how well the model is going.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-564395" data-commentid="564395" data-postid="8173" data-belowelement="comment-564395" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-565187" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-565187" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d948d6b6936bcf2d9fc6e8f1e3e14c1b_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d948d6b6936bcf2d9fc6e8f1e3e14c1b.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dhruv</span>
	                <span class="date">September 29, 2020 at 9:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-565187" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, it was a wonderful tutorial! I had a question. I saw
 that my gan was mode collapsed . How can I fix this? How can we fix a 
gan that is going through mode collapse?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-565187" data-commentid="565187" data-postid="8173" data-belowelement="comment-565187" data-respondelement="respond" data-replyto="Reply to Dhruv" aria-label="Reply to Dhruv">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-565188" class="comment even depth-2 parent">

	      	<div id="li-comment-565188" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d948d6b6936bcf2d9fc6e8f1e3e14c1b_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/d948d6b6936bcf2d9fc6e8f1e3e14c1b.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dhruv</span>
	                <span class="date">September 29, 2020 at 9:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-565188" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The discriminator real loss was around 0.6, discriminator fake 
loss was around 0.7, and the generator loss was around 0.55 the whole 
time (these values changes sometimes, but most of time these values were
 present). How can I fix a gan going through Mode Collapse?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-565188" data-commentid="565188" data-postid="8173" data-belowelement="comment-565188" data-respondelement="respond" data-replyto="Reply to Dhruv" aria-label="Reply to Dhruv">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-565229" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-565229" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 30, 2020 at 6:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-565229" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Remember to focus on the generated images, not the loss values.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-565229" data-commentid="565229" data-postid="8173" data-belowelement="comment-565229" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-565228" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-565228" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 30, 2020 at 6:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-565228" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>Perhaps try some of these methods:<br>
<a href="https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-565228" data-commentid="565228" data-postid="8173" data-belowelement="comment-565228" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-566381" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-566381" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/03800bf42ad6db643fb7819c84e265bc.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/03800bf42ad6db643fb7819c84e265bc_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tushar</span>
	                <span class="date">October 10, 2020 at 4:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-566381" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have adapted quite of your model and from the paper you have 
implemented and fitted on blurr data of motion and defocused after 100 
epochs the pics which i got as an output where almost accurate but too 
much pixelated ..i have not created checkpoints and  have just the lats 
100th model ..so could you give me a way so i could train once again 
several time from the 100th model…..and any other suggestion to have in 
model to increase the clarity of pic</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-566381" data-commentid="566381" data-postid="8173" data-belowelement="comment-566381" data-respondelement="respond" data-replyto="Reply to Tushar" aria-label="Reply to Tushar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-566420" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-566420" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 10, 2020 at 7:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-566420" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, these tips will give you ideas of things to try:<br>
<a href="https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-566420" data-commentid="566420" data-postid="8173" data-belowelement="comment-566420" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-567603" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-567603" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/402cbf6a9de894dcd5fc1b566fa0da6f_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/402cbf6a9de894dcd5fc1b566fa0da6f.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">REFAEL VIVANTI</span>
	                <span class="date">October 15, 2020 at 4:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-567603" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, great article!</p>
<p>1. I didn’t understand why in the first example of failure to converge both losses went to 0.<br>
Isn’t is a zero-sum game? Shouldn’t the GANloss go up as the discriminator goes to 0?</p>
<p>2. What should I do when the second described problem, failure to converge, occur? </p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-567603" data-commentid="567603" data-postid="8173" data-belowelement="comment-567603" data-respondelement="respond" data-replyto="Reply to REFAEL VIVANTI" aria-label="Reply to REFAEL VIVANTI">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-567759" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-567759" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 16, 2020 at 5:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-567759" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The losses can’t go to zero, one model will have zero loss, e.g. 
the discriminator and the other will be close to zero but not zero.</p>
<p>GANs’ don’t converge.</p>
<p>These tips will help improve GAN performance:<br>
<a href="https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-567759" data-commentid="567759" data-postid="8173" data-belowelement="comment-567759" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-568328" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-568328" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/b5de4e6d5f4b4c444820781028bbde05.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/b5de4e6d5f4b4c444820781028bbde05_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tamar Levy</span>
	                <span class="date">October 17, 2020 at 11:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-568328" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great article!<br>
I created very similar version of GAN like yours in pytorch.<br>
I used it to predict temperature maps, not real RGB or binary images.<br>
for some reason my Discriminator in the beginning stuck on the same loss
 0.693 from the first iteration, and does not go up or down, do you have
 any idea what to do in that situation?<br>
also can I changes the last layer in the Generator to be ReLU and not Tanh, because my maps are normalized to be between 0-1.</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-568328" data-commentid="568328" data-postid="8173" data-belowelement="comment-568328" data-respondelement="respond" data-replyto="Reply to Tamar Levy" aria-label="Reply to Tamar Levy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-568394" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-568394" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 18, 2020 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-568394" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done.</p>
<p>Perhaps some of the suggestions here will help:<br>
<a href="https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-568394" data-commentid="568394" data-postid="8173" data-belowelement="comment-568394" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-584175" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-584175" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/667f094cea0dc97a5a307b5347fde698_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/667f094cea0dc97a5a307b5347fde698.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">SanaKH</span>
	                <span class="date">December 14, 2020 at 6:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-584175" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Good article!<br>
I have built a GAN for text line image denoising. However, during 
training, I noticed that the PSNR evaluated on avalidation data every 4 
epochs is not stable as following :<br>
epoch       psnr<br>
0	11.23549198<br>
1	11.06054743<br>
2	13.47806442<br>
3	15.43679847<br>
4	16.32856713<br>
5	16.41565544<br>
8	5.565504805<br>
12	17.37565203<br>
16	17.53865563<br>
Especially at epoch 8, is that behaviour is normal??<br>
Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-584175" data-commentid="584175" data-postid="8173" data-belowelement="comment-584175" data-respondelement="respond" data-replyto="Reply to SanaKH" aria-label="Reply to SanaKH">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-584503" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-584503" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 15, 2020 at 6:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-584503" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t think there is a “normal” when it comes to training GANs.</p>
<p>Perhaps focus on the capability of the model instead of loss – unless you get a mode failure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-584503" data-commentid="584503" data-postid="8173" data-belowelement="comment-584503" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-588040" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-588040" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/8264fca4074721acbc5ae0ddfc00d7cf.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/8264fca4074721acbc5ae0ddfc00d7cf_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Younis Ali</span>
	                <span class="date">December 23, 2020 at 8:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-588040" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sir, the last layer of the discriminator model and generator 
model is sigmoid and tanh activations respectively. The range of sigmoid
 function is [0 to 1] and that of tanh is [-1  to  0]. But the d loss 
and g loss is going beyond these ranges both in stable GAN and unstable 
GAN.<br>
Please reply the needful as soon as possible.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-588040" data-commentid="588040" data-postid="8173" data-belowelement="comment-588040" data-respondelement="respond" data-replyto="Reply to Younis Ali" aria-label="Reply to Younis Ali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-588150" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-588150" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 24, 2020 at 5:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-588150" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Reviewing the loss of a GAN is not helpful in determining whether it has a good fit, e.g. GAN’s don’t converge:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-588150" data-commentid="588150" data-postid="8173" data-belowelement="comment-588150" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-593825" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-593825" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/7f94ac8749108f00ad57c584d47265a4.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/7f94ac8749108f00ad57c584d47265a4_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kaleab</span>
	                <span class="date">January 21, 2021 at 1:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-593825" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi ii have tried this code and  after some epochs trained this error is occurred<br>
TypeError: unsupported operand type(s) for *: ‘Sequential’ and ‘int’ at line 3 x_input =rand(latent *)</p>
<p>def generate_latent_points(latent_dim, n_samples):<br>
  # generate points in the latent space<br>
  x_input = randn(latent_dim * n_samples)<br>
  # reshape into a batch of inputs for the network<br>
  x_input = x_input.reshape(n_samples, latent_dim)<br>
  print(x_input)<br>
  return x_input</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-593825" data-commentid="593825" data-postid="8173" data-belowelement="comment-593825" data-respondelement="respond" data-replyto="Reply to kaleab" aria-label="Reply to kaleab">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-593826" class="comment even depth-2 parent">

	      	<div id="li-comment-593826" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/7f94ac8749108f00ad57c584d47265a4.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/7f94ac8749108f00ad57c584d47265a4_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kaleab</span>
	                <span class="date">January 21, 2021 at 1:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-593826" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sorry accidentally  sequential data pass through summurization function</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-593826" data-commentid="593826" data-postid="8173" data-belowelement="comment-593826" data-respondelement="respond" data-replyto="Reply to kaleab" aria-label="Reply to kaleab">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-593856" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-593856" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 21, 2021 at 6:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-593856" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-593856" data-commentid="593856" data-postid="8173" data-belowelement="comment-593856" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-593855" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-593855" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 21, 2021 at 6:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-593855" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, this may help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-593855" data-commentid="593855" data-postid="8173" data-belowelement="comment-593855" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-594993" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-594993" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/ed76d5c5986ff3ca125a1bde81cccd0d.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/ed76d5c5986ff3ca125a1bde81cccd0d_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Stylianos Charalampous</span>
	                <span class="date">January 28, 2021 at 9:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-594993" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br>
I managed to fix gan failure mode by removing Batch Norm layer in the 
discriminator in my Semi Supervised GAN. I am now noticing though that 
the generator is not able to fool the discriminator at all so the 
discriminator accuracy is 100%</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-594993" data-commentid="594993" data-postid="8173" data-belowelement="comment-594993" data-respondelement="respond" data-replyto="Reply to Stylianos Charalampous" aria-label="Reply to Stylianos Charalampous">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-595099" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-595099" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 29, 2021 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-595099" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can ignore accuracy.</p>
<p>Focus on the generated images.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-595099" data-commentid="595099" data-postid="8173" data-belowelement="comment-595099" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-598823" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-598823" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/e4e0a45c95e4c3aa9d64b3d384b2ee19.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/e4e0a45c95e4c3aa9d64b3d384b2ee19_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Assandra Falls</span>
	                <span class="date">February 25, 2021 at 11:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-598823" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Brilliant article, thank you for posting it.<br>
I have a question on the relationship between the size of a dataset and whether this can impact the stability of the GAN.<br>
I.e. if you had a small dataset would this take longer to reach 
equilibrium in theory, is there a cut off to minimum size of the dataset
 where a GAN will just never to able to reach equilibrium?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-598823" data-commentid="598823" data-postid="8173" data-belowelement="comment-598823" data-respondelement="respond" data-replyto="Reply to Assandra Falls" aria-label="Reply to Assandra Falls">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-598871" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-598871" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 26, 2021 at 4:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-598871" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>I’m sure there is, I don’t think it’s an easy relationship to describe at this stage.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-598871" data-commentid="598871" data-postid="8173" data-belowelement="comment-598871" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-602345" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-602345" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/dc6653fe797d9a40cddf713298ae9051.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/dc6653fe797d9a40cddf713298ae9051_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harry Garrison</span>
	                <span class="date">March 28, 2021 at 7:07 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-602345" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Excellent as always, thank you for posting this!</p>
<p>I get discriminator losses that are close to zero (e.g. 0.032) and at
 the same time I get generator loss somewhere around 3.988. This happens
 around epoch 20 and goes on until epoch 40 (that is as far as I have 
tried training the model for). Is that a sign that I should give up 
training? Looking at the resulting images is rather inconclusive, as I 
am trying this on spectrograms and their appearance does not give me a 
clue as to how well the GAN is doing. It might improve after many epochs
 or maybe not. I wouldn’t like to wait in vain, though.</p>
<p>Also, how can I resume training with this model? How do I load the weights and which model do I load them on?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-602345" data-commentid="602345" data-postid="8173" data-belowelement="comment-602345" data-respondelement="respond" data-replyto="Reply to Harry Garrison" aria-label="Reply to Harry Garrison">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-602474" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-602474" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2021 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-602474" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Image quality is the main way to decide, also it can come good later.</p>
<p>You can save/load images any time, e.g.:<br>
<a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow ugc">https://machinelearningmastery.com/save-load-keras-deep-learning-models/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-602474" data-commentid="602474" data-postid="8173" data-belowelement="comment-602474" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-609170" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-609170" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/fcdc335df176d449636590564eee216c.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/fcdc335df176d449636590564eee216c_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Madalina</span>
	                <span class="date">May 15, 2021 at 12:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-609170" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>Can you explain why if a GAN does not converge then both 
discriminator and generator losses are close to zero? If the 
discriminator is good at identifying which images are real and which 
images are fake, then why is it fooled by the generator?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-609170" data-commentid="609170" data-postid="8173" data-belowelement="comment-609170" data-respondelement="respond" data-replyto="Reply to Madalina" aria-label="Reply to Madalina">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-609208" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-609208" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a0942b56b07831ac15d4a168a750e34a_003.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 15, 2021 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-609208" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, see this:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-is-my-gan-not-converging</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-609208" data-commentid="609208" data-postid="8173" data-belowelement="comment-609208" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-621135" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-621135" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/f59a0b4266434cef0de1530c1b1220ba.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/f59a0b4266434cef0de1530c1b1220ba_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rui Guo</span>
	                <span class="date">August 10, 2021 at 6:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-621135" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I found the fake images you trained, such as 8, have some 
artifacts around the number 8. So how to reduce the artifacts in the 
generated images when we train the GAN?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-621135" data-commentid="621135" data-postid="8173" data-belowelement="comment-621135" data-respondelement="respond" data-replyto="Reply to Rui Guo" aria-label="Reply to Rui Guo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-621181" class="comment byuser comment-author-adriantam even depth-2">

	      	<div id="li-comment-621181" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/73a7f07e8fec40c74d091917c1108f7b_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/73a7f07e8fec40c74d091917c1108f7b.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">August 11, 2021 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-621181" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Probably you can try some of the GAN hacks here: <a href="https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-code-generative-adversarial-network-hacks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-621181" data-commentid="621181" data-postid="8173" data-belowelement="comment-621181" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label="Reply to Adrian Tam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-624896" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-624896" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/adbe16f67d7d29705be0b0bb65ad5a33.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/adbe16f67d7d29705be0b0bb65ad5a33_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Joe</span>
	                <span class="date">August 30, 2021 at 5:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-624896" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for your great article first!<br>
And have you experienced a sudden model failure after like 20 epochs? At
 beginning everything is fine, and suddenly at a certain epoch, the 
model totally fail and create garbage pics.<br>
I put generated pics and loss curve pics here:<br>
<a href="https://docs.google.com/document/d/1EGNLhIbN2PS91vx93rDG54IPBGgPoova/edit?usp=sharing&amp;ouid=105449882848905790783&amp;rtpof=true&amp;sd=true" rel="nofollow ugc">https://docs.google.com/document/d/1EGNLhIbN2PS91vx93rDG54IPBGgPoova/edit?usp=sharing&amp;ouid=105449882848905790783&amp;rtpof=true&amp;sd=true</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-624896" data-commentid="624896" data-postid="8173" data-belowelement="comment-624896" data-respondelement="respond" data-replyto="Reply to Joe" aria-label="Reply to Joe">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-625330" class="comment byuser comment-author-adriantam even depth-2">

	      	<div id="li-comment-625330" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/73a7f07e8fec40c74d091917c1108f7b_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/73a7f07e8fec40c74d091917c1108f7b.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">September 1, 2021 at 7:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-625330" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That is possible. Hence you need to monitor the loss and stop the training.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-625330" data-commentid="625330" data-postid="8173" data-belowelement="comment-625330" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label="Reply to Adrian Tam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-629083" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-629083" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/4d30f1b048a19210dcb5a70f841cf718_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/4d30f1b048a19210dcb5a70f841cf718.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">archit</span>
	                <span class="date">October 8, 2021 at 6:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-629083" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generator weights NAN while training:-</p>
<p>I am using skin cancer datasets (<a href="https://challenge.isic-archive.com/data" rel="nofollow ugc">https://challenge.isic-archive.com/data</a>
 – 2016, melanoma only) for training GAN. After multiple epochs the 
generator weights become NaN (I think too large for float32).<br>
I have tried with DCGAN (Adam and SGD -&gt; optimiser), bigGAN, custom model made by me.<br>
I have tried adding/removing spectral norm layer, batch norm layer and regularizers but none help me out.<br>
I have also check for null values in my data (not found any). </p>
<p>I my last few experiments i have done -&gt;<br>
           #   batch size -&gt; 128, dis-lr : 1E-4, gen-lr :  4E-4, no-null till apprx. 1650 epochs<br>
           #   batch size -&gt; 256, dis-lr : 1E-4, gen-lr :  4E-4, null at epoch 162<br>
           #   batch size -&gt; 512, dis-lr : 1E-4, gen-lr : 16E-4, null at epoch 1439 </p>
<p>with optimiser -&gt; SGD; momentum -&gt; 0.9; target image size 64 x 64 x 3;   </p>
<p>What is the real cause behind this ? </p>
<p>I have read various github / stack overflow pages, but still all they did not help me out.<br>
Pages link -&gt;<br>
             1. <a href="https://stackoverflow.com/questions/33962226/common-causes-of-nans-during-training" rel="nofollow ugc">https://stackoverflow.com/questions/33962226/common-causes-of-nans-during-training</a><br>
             2. <a href="https://stackoverflow.com/questions/52211665/why-do-i-get-nan-loss-value-in-training-discriminator-and-generator-of-gan" rel="nofollow ugc">https://stackoverflow.com/questions/52211665/why-do-i-get-nan-loss-value-in-training-discriminator-and-generator-of-gan</a><br>
             3. <a href="https://github.com/eriklindernoren/Keras-GAN/issues/87" rel="nofollow ugc">https://github.com/eriklindernoren/Keras-GAN/issues/87</a><br>
             4. <a href="https://github.com/tensorflow/tensorflow/issues/38416" rel="nofollow ugc">https://github.com/tensorflow/tensorflow/issues/38416</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-629083" data-commentid="629083" data-postid="8173" data-belowelement="comment-629083" data-respondelement="respond" data-replyto="Reply to archit" aria-label="Reply to archit">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-629549" class="comment byuser comment-author-adriantam even depth-2">

	      	<div id="li-comment-629549" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/73a7f07e8fec40c74d091917c1108f7b_002.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/73a7f07e8fec40c74d091917c1108f7b.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian Tam</span>
	                <span class="date">October 13, 2021 at 5:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-629549" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If your weights are NaN, that’s because of the gradient blow up 
likely. You may need to tune your optimizer. See this for an example in 
SGD: <a href="https://stackoverflow.com/questions/52000103/weights-of-keras-model-are-nan" rel="nofollow ugc">https://stackoverflow.com/questions/52000103/weights-of-keras-model-are-nan</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-629549" data-commentid="629549" data-postid="8173" data-belowelement="comment-629549" data-respondelement="respond" data-replyto="Reply to Adrian Tam" aria-label="Reply to Adrian Tam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-652564" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-652564" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/91542f2d405699396ad9666d4d3a87ea_002.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/91542f2d405699396ad9666d4d3a87ea.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aditi</span>
	                <span class="date">January 30, 2022 at 5:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-652564" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I am running my model for 3000 epochs, but the discriminator loss went to 0 in the 5th epoch and accuracy also is 100.<br>
Generator loss is close to 1 after 10 epochs.<br>
Using Pix2Pix GAN.<br>
What are your thoughts on it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-652564" data-commentid="652564" data-postid="8173" data-belowelement="comment-652564" data-respondelement="respond" data-replyto="Reply to Aditi" aria-label="Reply to Aditi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-652716" class="comment byuser comment-author-jamespcarmichael even depth-2">

	      	<div id="li-comment-652716" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/7179260f38a32b3594550e7baddc86b6.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/7179260f38a32b3594550e7baddc86b6_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">January 31, 2022 at 10:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-652716" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Aditi…You may be working on a regression problem and achieve zero prediction errors.</p>
<p>Alternately, you may be working on a classification problem and achieve 100% accuracy.</p>
<p>This is unusual and there are many possible reasons for this, including:</p>
<p>You are evaluating model performance on the training set by accident.<br>
Your hold out dataset (train or validation) is too small or unrepresentative.<br>
You have introduced a bug into your code and it is doing something different from what you expect.<br>
Your prediction problem is easy or trivial and may not require machine learning.<br>
The most common reason is that your hold out dataset is too small or not representative of the broader problem.</p>
<p>This can be addressed by:</p>
<p>Using k-fold cross-validation to estimate model performance instead of a train/test split.<br>
Gather more data.<br>
Use a different split of data for train and test, such as 50/50.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-652716" data-commentid="652716" data-postid="8173" data-belowelement="comment-652716" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-656607" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-656607" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/88a87957b06ead33d8a869e15fb81b7f.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/88a87957b06ead33d8a869e15fb81b7f_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nandini</span>
	                <span class="date">February 25, 2022 at 5:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-656607" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello!</p>
<p>Still learning GANs</p>
<p>What does it mean when my discriminator accuracy oscillates between 0 and 1 throughout?</p>
<p>TIA!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-656607" data-commentid="656607" data-postid="8173" data-belowelement="comment-656607" data-respondelement="respond" data-replyto="Reply to Nandini" aria-label="Reply to Nandini">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-656831" class="comment byuser comment-author-jamespcarmichael even depth-2">

	      	<div id="li-comment-656831" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/7179260f38a32b3594550e7baddc86b6.png" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/7179260f38a32b3594550e7baddc86b6_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">James Carmichael</span>
	                <span class="date">February 26, 2022 at 12:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#comment-656831" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Nandini…The following may be of interest to you:</p>
<p><a href="https://neptune.ai/blog/gan-loss-functions" rel="nofollow ugc">https://neptune.ai/blog/gan-loss-functions</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-656831" data-commentid="656831" data-postid="8173" data-belowelement="comment-656831" data-respondelement="respond" data-replyto="Reply to James Carmichael" aria-label="Reply to James Carmichael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://machinelearningmastery.com/practical-guide-to-gan-failure-modes/#respond" style="display:none;">Click here to cancel reply.</a></small></h3><form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form"><p class="comment-form-comment"><label class="hide" for="comment">Comment <span class="required" aria-hidden="true">*</span></label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" size="30" aria-required="true"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" size="30" aria-required="true"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>

<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="8173" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="514fd55992"></p><p style="display: none !important;"><label>Δ<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="1655821720886"><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><span class="left"><img alt="" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/1d75d46040c28497f0dee5d8e100db37_002.jpeg 2x" class="avatar avatar-88 photo" loading="lazy" width="88" height="88"></span>
<p><strong>Welcome!</strong><br>
I'm <em>Jason Brownlee</em> PhD <br>
and I <strong>help developers</strong> get results with <strong>machine learning</strong>.<br>
<a href="https://machinelearningmastery.com/about">Read more</a></p>
<div class="fix"></div>
</div><div style="position: static; margin-bottom: 30px; margin-top: 0px; padding: 0px; height: 69px; width: 303.717px; display: block;"></div><div id="custom_html-89" class="widget_text widget widget_custom_html FixedWidget__fixed_widget" style="top: 10px; position: fixed; transition: transform 0.5s ease 0s; width: 303.717px; padding: 0px;"><div class="textwidget custom-html-widget"><h4>Never miss a tutorial:</h4>
<br>
<div style="text-align: left;">
<a href="https://www.linkedin.com/company/machine-learning-mastery/"><img src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/small_icon_blue_linkedin3.webp" alt="LinkedIn" width="30" height="30"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://twitter.com/TeachTheMachine"><img src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/small_icon_blue_twitter3.webp" alt="Twitter" width="30" height="30"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://www.facebook.com/MachineLearningMastery/"><img src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/small_icon_blue_facebook3.webp" alt="Facebook" width="30" height="30"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/newsletter/"><img src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/small_icon_blue_email3.webp" alt="Email Newsletter" width="30" height="30"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/rss-feed/"><img src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/small_icon_blue_rss3.webp" alt="RSS Feed" width="30" height="30"></a>
</div></div></div><div id="custom_html-103" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="height:260px;">
<div class="machi-0cef8d8338947f6c57de13c9d0da625a machi-right-sidebar" id="machi-0cef8d8338947f6c57de13c9d0da625a"><div class="machi-right-sidebar" id="machi-1636618423"><div data-advadstrackid="13576" data-advadstrackbid="1" class="machi-target" id="machi-1109995475"><a href="https://sigopt.com/signup?utm_source=mlm&amp;utm_medium=display&amp;utm_campaign=mlm-try-sigopt&amp;utm_content=anchor-mlops" rel="noopener nofollow sponsored" class="adv-link" target="_blank"><p><img src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/mlm-s1-sigopt-a.jpg" alt="Anchor your MLOps Strategy with SigOpt." width="300"><br>
Anchor your MLOps Strategy with SigOpt.</p>
</a></div></div></div>	
</div></div></div><div style="position: static; margin-bottom: 30px; margin-top: 0px; padding: 0px; height: 474px; width: 303.717px; display: block;"></div><div id="custom_html-27" class="widget_text widget widget_custom_html FixedWidget__fixed_widget" style="top: 108.7px; position: fixed; transition: transform 0.5s ease 0s; width: 303.717px; padding: 0px;"><div class="textwidget custom-html-widget"><h4>Picked for you:</h4>
<br>
<div class="display-posts-listing image-left"><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-a-pix2pix-gan-for-image-to-image-translation/"><img src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Plot-of-Satellite-to-Google-Map-Translated-Images-Using-Pix2.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Plot of Satellite to Google Map Translated Images Using Pix2Pix After 100 Training Epochs" loading="lazy" width="150" height="150"></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-a-pix2pix-gan-for-image-to-image-translation/" rel="nofollow">How to Develop a Pix2Pix GAN for Image-to-Image Translation</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-a-generative-adversarial-network-for-a-1-dimensional-function-from-scratch-in-keras/"><img src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Scatter-Plot-of-Real-and-Generated-Examples-for-the-Target-F.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Scatter Plot of Real and Generated Examples for the Target Function After 10,000 Iterations." loading="lazy" width="150" height="150"></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-a-generative-adversarial-network-for-a-1-dimensional-function-from-scratch-in-keras/" rel="nofollow">How to Develop a 1D Generative Adversarial Network From Scratch in Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/cyclegan-tutorial-with-keras/"><img src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Plot-of-a-Real-Photo-of-a-Horse-Translation-to-Zebra-and-Rec.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Plot of a Real Photo of a Horse, Translation to Zebra, and Reconstructed Photo of a Horse Using CycleGAN." loading="lazy" width="150" height="150"></a> <a class="title" href="https://machinelearningmastery.com/cyclegan-tutorial-with-keras/" rel="nofollow">How to Develop a CycleGAN for Image-to-Image Translation with Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-a-conditional-generative-adversarial-network-from-scratch/"><img src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Example-of-100-Generated-items-of-Clothing-using-an-Conditio.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Example of 100 Generated items of Clothing using a Conditional GAN." loading="lazy" width="150" height="150"></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-a-conditional-generative-adversarial-network-from-scratch/" rel="nofollow">How to Develop a Conditional GAN (cGAN) From Scratch</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-code-a-wasserstein-generative-adversarial-network-wgan-from-scratch/"><img src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/Sample-of-100-Generated-Images-of-a-Handwritten-Number-7-at.webp" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Sample of 100 Generated Images of a Handwritten Number 7 at Epoch 970 from a Wasserstein GAN." loading="lazy" width="150" height="150"></a> <a class="title" href="https://machinelearningmastery.com/how-to-code-a-wasserstein-generative-adversarial-network-wgan-from-scratch/" rel="nofollow">How to Develop a Wasserstein Generative Adversarial Network (WGAN) From Scratch</a></div></div></div></div><div style="position: static; margin-bottom: 30px; margin-top: 0px; padding: 0px; height: 169px; width: 303.717px; display: block;"></div><div id="custom_html-5" class="widget_text widget widget_custom_html FixedWidget__fixed_widget" style="top: 612.9px; position: fixed; transition: transform 0.5s ease 0s; width: 303.717px; padding: 0px;"><div class="textwidget custom-html-widget"><div style="text-align: center;">
	<p></p><h4>Loving the Tutorials?</h4><p></p>

<p>The <a href="https://machinelearningmastery.com/generative_adversarial_networks/" rel="nofollow">GANs with Python</a> EBook is<br> where you'll find the <strong><i>Really Good</i></strong> stuff.</p>

<p>
<a href="https://machinelearningmastery.com/generative_adversarial_networks/" class="woo-sc-button  red"><span class="woo-">&gt;&gt; See What's Inside</span></a>
</p>

</div></div></div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2022 Machine Learning Mastery. All Rights Reserved.<br>
<a href="https://www.linkedin.com/company/machine-learning-mastery/">LinkedIn</a> |
<a href="https://twitter.com/TeachTheMachine">Twitter</a> |
<a href="https://www.facebook.com/MachineLearningMastery/">Facebook</a> |
<a href="https://machinelearningmastery.com/newsletter/">Newsletter</a> |
<a href="https://machinelearningmastery.com/rss-feed/">RSS</a></p>		</div>

		<div id="credit" class="col-right">
			<p><a href="https://machinelearningmastery.com/privacy/">Privacy</a> | 
<a href="https://machinelearningmastery.com/disclaimer/">Disclaimer</a> | 
<a href="https://machinelearningmastery.com/terms-of-service/">Terms</a> | 
<a href="https://machinelearningmastery.com/contact/">Contact</a> |
<a href="https://machinelearningmastery.com/sitemap.xml">Sitemap</a> |
<a href="https://machinelearningmastery.com/site-search/">Search</a></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<script id="cls-insertion-5fc9f28" type="text/javascript">!function(){"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var n=function(){return n=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};function i(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function r(t,e,n){if(n||2===arguments.length)for(var i,o=0,r=e.length;o<r;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))}var a,l=function(t){function n(e){var n=t.call(this)||this;return n._probability=e,n}return e(n,t),n.prototype.get=function(){if(this._probability<0||this._probability>1)throw new Error("Invalid probability");return Math.random()<this._probability},n}((function(){})),s=function(t,e){return null==t||t!=t?e:t},c=function(t){var e=t.offsetHeight,n=t.offsetWidth,i=t.getBoundingClientRect(),o=document.body,r=document.documentElement,a=window.pageYOffset||r.scrollTop||o.scrollTop,l=window.pageXOffset||r.scrollLeft||o.scrollLeft,s=r.clientTop||o.clientTop||0,c=r.clientLeft||o.clientLeft||0,u=Math.round(i.top+a-s),d=Math.round(i.left+l-c);return{top:u,left:d,bottom:u+e,right:d+n,width:n,height:e}},u=function(t){try{return{valid:!0,elements:document.querySelectorAll(t)}}catch(t){return n({valid:!1},t)}},d=function(t){return""===t?{valid:!0}:u(t)},p=function(){function t(){this._clsGlobalData=window.adthriveCLS}return Object.defineProperty(t.prototype,"enabled",{get:function(){return this._clsGlobalData&&this._clsGlobalData.siteAds},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"siteAds",{get:function(){return this._clsGlobalData.siteAds},set:function(t){this._clsGlobalData.siteAds=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disableAds",{get:function(){return this._clsGlobalData.disableAds},set:function(t){this._clsGlobalData.disableAds=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"enabledLocations",{get:function(){return this._clsGlobalData.enabledLocations},set:function(t){this._clsGlobalData.enabledLocations=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"injectedFromPlugin",{get:function(){return this._clsGlobalData.injectedFromPlugin},set:function(t){this._clsGlobalData.injectedFromPlugin=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"injectedFromSiteAds",{get:function(){return this._clsGlobalData.injectedFromSiteAds},set:function(t){this._clsGlobalData.injectedFromSiteAds=t},enumerable:!1,configurable:!0}),t.prototype.overwriteInjectedSlots=function(t){this._clsGlobalData.injectedSlots=t},t.prototype.setInjectedSlots=function(t){this._clsGlobalData.injectedSlots.push(t)},Object.defineProperty(t.prototype,"injectedSlots",{get:function(){return this._clsGlobalData.injectedSlots},enumerable:!1,configurable:!0}),t.prototype.setInjectedScripts=function(t){this._clsGlobalData.injectedScripts=this._clsGlobalData.injectedScripts||[],this._clsGlobalData.injectedScripts.push(t)},Object.defineProperty(t.prototype,"getInjectedScripts",{get:function(){return this._clsGlobalData.injectedScripts},enumerable:!1,configurable:!0}),t.prototype.setExperiment=function(t,e){this._clsGlobalData.experiments=this._clsGlobalData.experiments||[],this._clsGlobalData.experiments[t]=e},t.prototype.getExperiment=function(t){return this._clsGlobalData.experiments&&this._clsGlobalData.experiments[t]},Object.defineProperty(t.prototype,"branch",{get:function(){return this._clsGlobalData.branch},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._clsGlobalData.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"videoDisabledFromPlugin",{get:function(){return this._clsGlobalData.videoDisabledFromPlugin},set:function(t){this._clsGlobalData.videoDisabledFromPlugin=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetDensityLog",{get:function(){return this._clsGlobalData.targetDensityLog},set:function(t){this._clsGlobalData.targetDensityLog=t},enumerable:!1,configurable:!0}),t}(),h=function(){function t(){this._clsOptions=new p}return t.prototype.setExperimentKey=function(){this._clsOptions.setExperiment(this.key,this.result)},t}(),y=function(){function t(){}return t.prototype.info=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];this.call.apply(this,r([console.info,t,e],o(n),!1))},t.prototype.warn=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];this.call.apply(this,r([console.warn,t,e],o(n),!1))},t.prototype.error=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];this.call.apply(this,r([console.error,t,e],o(n),!1)),this.sendErrorLogToCommandQueue.apply(this,r([t,e],o(n),!1))},t.prototype.event=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];this.info(t,e)},t.prototype.sendErrorLogToCommandQueue=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];window.adthrive=window.adthrive||{},window.adthrive.cmd=window.adthrive.cmd||[],window.adthrive.cmd.push(function(){void 0!==window.adthrive.logError&&"function"==typeof window.adthrive.logError&&window.adthrive.logError(t,e,n)}.bind(t,e,n))},t.prototype.call=function(t,e,n){for(var i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];var l=["%c".concat(e,"::").concat(n," ")],s=["color: #999; font-weight: bold;"];i.length>0&&"string"==typeof i[0]&&l.push(i.shift()),s.push.apply(s,r([],o(i),!1));try{Function.prototype.apply.call(t,console,r([l.join("")],o(s),!1))}catch(t){return void console.error(t)}},t}(),f=new y,m=function(t){function n(){var e=t.call(this)||this;e._result=!1,e._choices=[{choice:!0},{choice:!1}],e.key="adsp7";var n=e._clsOptions.siteAds,i=s(n.adDensityEnabled,!0);return n.adDensityLayout&&i&&(e._result=e.run(),e.setExperimentKey()),e}return e(n,t),Object.defineProperty(n.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0}),n.prototype.run=function(){return new l(1).get()},n}(h),g=function(){function t(){}return t.getScrollTop=function(){return(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0)},t.shufflePlaylist=function(t){for(var e,n,i=t.length;0!==i;)n=Math.floor(Math.random()*t.length),e=t[i-=1],t[i]=t[n],t[n]=e;return t},t.playerInView=function(t){var e=t.getBoundingClientRect();return window.innerHeight>e.top+e.height/2},t.createQueryString=function(t){return Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])})).join("&")},t.createEncodedQueryString=function(t){return Object.keys(t).map((function(e){return"".concat(e,"=").concat(encodeURIComponent(t[e]))})).join("&")},t.setMobileLocation=function(t){var e,n;return"top-left"===(t=t||"bottom-right")?t="adthrive-collapse-top-left":"top-right"===t?t="adthrive-collapse-top-right":"bottom-left"===t?t="adthrive-collapse-bottom-left":"bottom-right"===t?t="adthrive-collapse-bottom-right":"top-center"===t&&(e=navigator.userAgent,n=/Tablet|iPad|Playbook|Nook|webOS|Kindle|Android (?!.*Mobile).*Safari/i.test(e),t=/Mobi|iP(hone|od)|Opera Mini/i.test(e)&&!n?"adthrive-collapse-top-center":"adthrive-collapse-bottom-right"),t},t}(),_=function(t){this._clsOptions=t,this.removeVideoTitleWrapper=s(this._clsOptions.siteAds.adOptions.removeVideoTitleWrapper,!1);var e=this._clsOptions.siteAds.videoPlayers;this.footerSelector=s(e&&e.footerSelector,""),this.players=s(e&&e.players.map((function(t){return t.mobileLocation=g.setMobileLocation(t.mobileLocation),t})),[]),this.contextualSettings=e&&e.contextual},v=function(t){this.mobileStickyPlayerOnPage=!1,this.playlistPlayerAdded=!1,this.contextualPlayerAdded=!1,this.sekindoPlayerAdded=!1,this.footerSelector="",this.removeVideoTitleWrapper=!1,this.videoAdOptions=new _(t),this.players=this.videoAdOptions.players,this.contextualSettings=this.videoAdOptions.contextualSettings,this.removeVideoTitleWrapper=this.videoAdOptions.removeVideoTitleWrapper,this.footerSelector=this.videoAdOptions.footerSelector},b=function(t){this.clsOptions=t,this.enabledLocations=["Below_Post","Content","Recipe","Sidebar"]};!function(t){t.Desktop="desktop",t.Mobile="mobile"}(a||(a={}));var P,S,E=function(t){function n(){var e=t.call(this)||this;return e._result=!1,e._choices=[{choice:!0},{choice:!1}],e.key="smhd100",e._result=e.run(),e.setExperimentKey(),e}return e(n,t),Object.defineProperty(n.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0}),n.prototype.run=function(){return new l(.1).get()},n}(h),A=[[728,90],[300,250],[300,600],[320,50],[970,250],[160,600],[300,1050],[336,280],[970,90],[300,50],[320,100],[468,60],[250,250],[120,240],[1,1],[300,300],[552,334],[300,420],[728,250],[320,300],[300,390]],O=new Map([["Footer",1],["Header",2],["Sidebar",3],["Content",4],["Recipe",5],["Sidebar_sticky",6],["Below Post",7]]),w=function(t,e){var n=function(t){var e=t.clientWidth;if(getComputedStyle){var n=getComputedStyle(t,null);e-=parseFloat(n.paddingLeft||"0")+parseFloat(n.paddingRight||"0")}return e}(e),i=t.sticky&&"Sidebar"===t.location;return t.sizes.filter((function(e){var o=!t.autosize||(e[0]<=n||e[0]<=320),r=!i||e[1]<=window.innerHeight-100;return o&&r}))},D=function(t){return A.filter((function(e){var n=o(e,2),i=n[0],r=n[1];return t.some((function(t){var e=o(t,2),n=e[0],a=e[1];return i===n&&r===a}))}))},C=function(t,e,n,i){var r=o(e,2),a=r[0],l=r[1];return!("Footer"===t&&"phone"===n&&320===a&&100===l||"Header"===t&&l>100&&i.result)},k="250px",x=function(){function t(t,e){this._clsOptions=t,this.targetDensityExperiment=e,this._totalContentInserted=0,this._recipeCount=0,this._mainContentHeight=0,this._mainContentDiv=null,this._firstContentDiv=null,this._totalAvailableElements=0,this._minDivHeight=250,this._densityDevice=a.Desktop,this._pubLog={onePerViewport:!1,targetDensity:0,targetDensityUnits:0,combinedMax:0},this._densityMax=.99,this._infPageEndOffset=0,this.locationMaxLazySequence=new Map([["Recipe",5]]),this.locationToMinHeight={Below_Post:k,Content:k,Recipe:k,Sidebar:k};var n=this._clsOptions.siteAds.breakpoints,i=n.tablet,o=n.desktop;this._device=function(t,e){var n=window.innerWidth;return n>=e?"desktop":n>=t?"tablet":"phone"}(i,o),this._config=new b(t),this._clsOptions.enabledLocations=this._config.enabledLocations}return t.prototype.start=function(){var t,e,n,i=this;try{!function(t){var e=document.body,n="adthrive-device-".concat(t);if(!e.classList.contains(n))try{e.classList.add(n)}catch(t){document.createElement("_")}}(this._device);var a=(t=this._device,e=this._clsOptions.siteAds.adUnits,n=new E,e.filter((function(t){return void 0!==t.dynamic&&t.dynamic.enabled})).map((function(e){var i=e.location.replace(/\s+/g,"_");return{auctionPriority:O.get(i)||8,location:i,sequence:s(e.sequence,1),sizes:D(e.adSizes).filter((function(i){return C(e.location,i,t,n)})),devices:e.devices,pageSelector:s(e.dynamic.pageSelector,"").trim(),elementSelector:s(e.dynamic.elementSelector,"").trim(),position:s(e.dynamic.position,"beforebegin"),max:Math.floor(s(e.dynamic.max,0)),spacing:s(e.dynamic.spacing,0),skip:Math.floor(s(e.dynamic.skip,0)),every:Math.max(Math.floor(s(e.dynamic.every,1)),1),classNames:e.dynamic.classNames||[],sticky:"Footer"===e.location||e.sticky,stickyOverlapSelector:s(e.stickyOverlapSelector,"").trim(),autosize:e.autosize,special:s(e.targeting,[]).filter((function(t){return"special"===t.key})).reduce((function(t,e){return t.concat.apply(t,r([],o(e.value),!1))}),[]),lazy:s(e.dynamic.lazy,!1),lazyMax:s(e.dynamic.lazyMax,2),lazyMaxDefaulted:0!==e.dynamic.lazyMax&&!e.dynamic.lazyMax}}))).filter((function(t){return i._locationEnabled(t)})).filter((function(t){return function(t,e){return-1!==t.devices.indexOf(e)}(t,i._device)})).filter((function(t){return 0===(e=t).pageSelector.length||null!==document.querySelector(e.pageSelector);var e}));this.inject(a).forEach((function(t){return i._clsOptions.setInjectedSlots(t)}))}catch(t){}},t.prototype.inject=function(t,e){void 0===e&&(e=document);var n=this.targetDensityExperiment.result,i=t.filter((function(t){return n?"Content"!==t.location:t})),a=t.filter((function(t){return n?"Content"===t.location:null}));return r(r([],o(i.length?this._injectNonDensitySlots(i,e):[]),!1),o(a.length?this._injectDensitySlots(a,e):[]),!1)},t.prototype._injectNonDensitySlots=function(t,e){var n,a,l=this;void 0===e&&(e=document);var s=[],u=[];try{for(var d=i(t),p=d.next();!p.done;p=d.next()){var h=p.value,y=0,f=0,m=0;h.spacing>0&&(y=window.innerHeight*h.spacing,f=y);var g=this._repeatDynamicAds(h),_=this.getElements(h.elementSelector,e);h.skip;for(var v=function(t){if(m+1>g.length)return"break";var n=_[t];if(y>0){var i=c(n).bottom;if(i<=f)return"continue";f=i+y}var a=g[m],l="".concat(a.location,"_").concat(a.sequence);s.some((function(t){return t.name===l}))&&(m+=1);var d=b.getDynamicElementId(a),p="adthrive-".concat(h.location.replace("_","-").toLowerCase()),v=r([p,"".concat(p,"-").concat(h.sequence)],o(h.classNames),!1),P=b.addAd(n,d,h.position,v);if(P){var S=w(a,P);if(S.length){var E={clsDynamicAd:h,dynamicAd:a,element:P,sizes:S,name:l,infinite:e!==document};s.push(E),u.push({location:a.location,element:P}),"Recipe"===h.location&&++b._recipeCount,m+=1}n=P}},b=this,P=h.skip;P<_.length;P+=h.every){if("break"===v(P))break}}}catch(t){n={error:t}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}return u.forEach((function(t){var e=t.location;t.element.style.minHeight=l.locationToMinHeight[e]})),s},t.prototype._shouldTargetAllElgibile=function(t){return t===this._densityMax},t.prototype._injectDensitySlots=function(t,e){var n,l,s=this;void 0===e&&(e=document);try{this._calculateMainContentHeightAndAllElements(t)}catch(t){return[]}this._densityDevice="desktop"===this._device?a.Desktop:a.Mobile;var c=[],u=this._getDensitySettings(),d=u.adDensity,p=u.onePerViewport,h=this._shouldTargetAllElgibile(d),y=this._getTargetDensityUnits(d),f=this._getCombinedMax(t),m=Math.min.apply(Math,r([],o(r([this._totalAvailableElements,y],o(f>0?[f]:[]),!1)),!1));if(this._pubLog={onePerViewport:p,targetDensity:d,targetDensityUnits:y,combinedMax:f},!m)return[];var g=0,_=0,v=function(t){var n=b.getElements(t.elementSelector,e),i=b._getInsertEvery(m,p);b._logDensityInfo(n,t.elementSelector,i);var o=function(n){var o,r,a=null;o=s._attemptInsertion({dynamicAd:t,element:n,insertNext:_,onePerViewport:p,contentInsertedThisPage:g,target:e,insertEvery:i,targetAll:h}),_=o.insertNext,r=o.slot,a=o.adElement,r&&a&&(c.push(r),++g,a.style.minHeight=s.locationToMinHeight[t.location])};t.skip;for(var r=t.skip;r<n.length;r++){var a=n[r];if(!(a.offsetHeight>=b._mainContentHeight&&b._totalAvailableElements>1)){if(!(g<f&&g<y))break;o(a)}}},b=this;try{for(var P=i(t),S=P.next();!S.done;S=P.next()){v(S.value)}}catch(t){n={error:t}}finally{try{S&&!S.done&&(l=P.return)&&l.call(P)}finally{if(n)throw n.error}}return c},t.prototype._getInsertEvery=function(t,e){var n=.43*this._mainContentHeight/t;return e&&window.innerHeight>n?window.innerHeight:n},t.prototype._getDensitySettings=function(){var t=this._clsOptions.siteAds.adDensityLayout,e=this._determineOverrides(t.pageOverrides);return e.length?e[0]:t[this._densityDevice]},t.prototype._determineOverrides=function(t){var e=this;return t.filter((function(t){var e=d(t.pageSelector);return""===t.pageSelector||e.elements&&e.elements.length})).map((function(t){return t[e._densityDevice]}))},t.prototype._getTargetDensityUnits=function(t){return Math.floor(t*this._mainContentHeight/(1-t)/this._minDivHeight)-this._recipeCount},t.prototype._getCombinedMax=function(t){return s(t.filter((function(t){var e;try{e=document.querySelector(t.elementSelector)}catch(t){}return e})).map((function(t){return t.max+(t.lazyMaxDefaulted?0:t.lazyMax)})).sort((function(t,e){return e-t}))[0],0)},t.prototype._logDensityInfo=function(t,e,n){var i=this._pubLog,o=i.onePerViewport,r=i.targetDensity,a=i.targetDensityUnits,l=i.combinedMax;this._totalAvailableElements,this._clsOptions.targetDensityLog={onePerViewport:o,combinedMax:l,targetDensityUnits:a,targetDensityPercentage:r,mainContentHeight:this._mainContentHeight,recipeCount:this._recipeCount,numberOfEls:t.length}},t.prototype._attemptInsertion=function(t){var e,i=t.dynamicAd,o=t.element,r=t.insertNext,a=t.onePerViewport,l=t.contentInsertedThisPage,s=t.target,c=t.insertEvery,u=t.targetAll,d=null,p=null;if(this._isElementSpacedCorrectly(o,r,a,i,u,c)){var h=n(n({},i),{sequence:this._totalContentInserted+1,lazy:i.lazy&&l>=i.max});d=(e=this._addContentAd(o,i,h,s,c)).insertedSlot,r=e.insertNext,p=e.adElement}return{insertNext:r,slot:d,adElement:p}},t.prototype._isElementSpacedCorrectly=function(t,e,n,i,o,r){var a="beforebegin"===i.position||"afterbegin"===i.position,l="beforeend"===i.position||"afterbegin"===i.position,s=o||this._isElementFarEnough(n,t,e,a,r),c=l||this._isElementNotInRow(t,a),u=s&&c;return u&&(this._lastElement=t,this._lastAdPosition="beforebegin"===i.position||"afterbegin"===i.position?"top":"bottom"),u},t.prototype._getMinimumSpacingByLastInjection=function(t){return this._lastAdPosition&&"bottom"===this._lastAdPosition&&t<this._minDivHeight?this._minDivHeight:0},t.prototype._isElementFarEnough=function(t,e,n,i,o){var r=c(e),a=this._getMinimumSpacingByLastInjection(o),l=this._lastElement?c(this._lastElement).bottom:0,s=i?r.top:r.bottom;return s>n&&(0===l||s-l>=o+a)},t.prototype._isElementNotInRow=function(t,e){var n=t.previousElementSibling,i=t.nextElementSibling,o=e?!n&&i||n&&t.tagName!==n.tagName?i:n:i;return!(!o||0!==t.getBoundingClientRect().height)||(!o||t.getBoundingClientRect().top!==o.getBoundingClientRect().top)},t.prototype._calculateMainContentHeightAndAllElements=function(t){var e=this._setMainContentAndElements(t),n=e.mainContentDiv,i=e.firstContentDiv;this._mainContentDiv=n,this._firstContentDiv=i;var o=this._mainContentDiv.querySelector("div #comments, section .comments");this._mainContentHeight=o?this._mainContentDiv.offsetHeight-o.offsetHeight:this._mainContentDiv.offsetHeight},t.prototype._setMainContentAndElements=function(t){var e=this._getPotentialElements(t);if(0===e.length)throw Error("No Main Content Elements Found");return{mainContentDiv:Array.from(e).reduce((function(t,e){return e.offsetHeight>t.offsetHeight?e:t}))||document.body,firstContentDiv:Array.from(e).reduce((function(t,e){return c(e).top<c(t).top?e:t}))}},t.prototype._getPotentialElements=function(t){var e=this,n=this._attemptArticleLookup(),i=n?[n]:[];return t.forEach((function(t){return e._getSelectors(t.elementSelector).forEach((function(t){for(var n=document.querySelectorAll(t),o=0;o<n.length;o++)n[o]&&n[o].parentElement&&n[o].parentElement!==document.body?i.push(n[o].parentElement):i.push(n[o]),++e._totalAvailableElements}))})),i},t.prototype._attemptArticleLookup=function(){var t=document.querySelectorAll("article");if(0===t.length)return null;var e=Array.from(t).reduce((function(t,e){return e.offsetHeight>t.offsetHeight?e:t}));return e&&e.offsetHeight>1.5*window.innerHeight?e:null},t.prototype._getSelectors=function(t){return t.indexOf(",")>-1?t.split(","):[t]},t.prototype._addContentAd=function(t,e,n,i,a){void 0===i&&(i=document);var l=null,s="adthrive-".concat(e.location.replace("_","-").toLowerCase()),c="".concat(s,"-").concat(e.sequence),u=this.addAd(t,this.getDynamicElementId(n),n.position,r([s,c],o(e.classNames),!1)),d=this._getNextInsertPosition(n.position,u,a);if(u){var p=w(n,u);if(p.length)l={clsDynamicAd:e,dynamicAd:n,element:u,sizes:p,name:"".concat(n.location,"_").concat(n.sequence),infinite:i!==document},++this._totalContentInserted}return{insertedSlot:l,insertNext:d,adElement:u}},t.prototype._getNextInsertPosition=function(t,e,n){var i=e.getBoundingClientRect(),o=window.pageYOffset;return("beforebegin"===t||"afterbegin"===t?i.top:i.bottom)+o+n+this._minDivHeight},t.prototype.getDynamicElementId=function(t){return"".concat("AdThrive","_").concat(t.location,"_").concat(t.sequence,"_").concat(this._device)},t.prototype.getElements=function(t,e){return void 0===e&&(e=document),e.querySelectorAll(t)},t.prototype.addAd=function(t,e,n,i){if(void 0===i&&(i=[]),!document.getElementById(e)){var o='<div id="'.concat(e,'" class="adthrive-ad ').concat(i.join(" "),'"></div>');t.insertAdjacentHTML(n,o)}return document.getElementById(e)},t.prototype._repeatDynamicAds=function(t){for(var e=[],i=t.lazy?s(this.locationMaxLazySequence.get(t.location),0):0,o=t.max,r=0===i&&t.lazy?o+t.lazyMax:Math.min(Math.max(i-t.sequence+1,0),o+t.lazyMax),a=Math.max(o,r),l=0;l<a;l++){var c=t.sequence+l,u=t.lazy&&l>=o;e.push(n(n({},t),{sequence:c,lazy:u}))}return e},t.prototype._locationEnabled=function(t){var e=-1!==this._clsOptions.enabledLocations.indexOf(t.location),n=this._clsOptions.disableAds&&this._clsOptions.disableAds.all||document.body.classList.contains("adthrive-disable-all"),i=!document.body.classList.contains("adthrive-disable-content")&&!this._clsOptions.disableAds.reasons.has("content_plugin");return e&&!n&&i},t}();!function(t){t.Video_Collapse_Autoplay_SoundOff="Video_Collapse_Autoplay_SoundOff",t.Video_Individual_Autoplay_SOff="Video_Individual_Autoplay_SOff",t.Video_Coll_SOff_Smartphone="Video_Coll_SOff_Smartphone",t.Video_In_Post_ClicktoPlay_SoundOn="Video_In-Post_ClicktoPlay_SoundOn"}(P||(P={})),function(t){t.StickySekindo="stickySekindo",t.StaticSekindo="staticSekindo",t.None="none"}(S||(S={}));var M,I=function(t){function n(){var e=t.call(this)||this;return e.key="sekho",e._result=!1,e._choices=[{choice:!0},{choice:!1}],e._result=e.run(),e.setExperimentKey(),e}return e(n,t),Object.defineProperty(n.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0}),n.prototype.run=function(){return new l(.05).get()},n}(h),j=function(t){function i(e,n){var i=t.call(this,e,(new I).result,"ClsVideoInsertion")||this;return i._videoConfig=e,i._clsOptions=n,i._IN_POST_SELECTOR=".adthrive-video-player",i._WRAPPER_BAR_HEIGHT=36,i._playersAddedFromPlugin=[],i}return e(i,t),i.prototype.init=function(){this._initializePlayers()},i.prototype._wrapJWPlayerWithCLS=function(t,e,n){if(void 0===n&&(n=0),t.parentNode){var i=t.offsetWidth*(9/16),o=this._createGenericCLSWrapper(i,e,n);t.parentNode.insertBefore(o,t),o.appendChild(t)}},i.prototype._createSekindoCLSWrapper=function(t,e){var n=this._getTitleHeight(document.createElement("h4"));return this._createGenericCLSWrapper(t,e,n)},i.prototype._createGenericCLSWrapper=function(t,e,n){var i=document.createElement("div");return i.id="cls-video-container-".concat(e),i.className="adthrive",i.style.minHeight="".concat(t+n,"px"),i},i.prototype._getTitleHeight=function(t){t.innerText="Title",t.style.visibility="hidden",document.body.appendChild(t);var e=window.getComputedStyle(t),n=parseInt(e.height,10),i=parseInt(e.marginTop,10),o=parseInt(e.marginBottom,10);return document.body.removeChild(t),Math.min(n+o+i,50)},i.prototype._initializePlayers=function(){var t=document.querySelectorAll(this._IN_POST_SELECTOR);t.length&&this._initializeRelatedPlayers(t),this._shouldRunAutoplayPlayers()&&this._determineAutoplayPlayers()},i.prototype._createStationaryRelatedPlayer=function(t,e){this._device,P.Video_In_Post_ClicktoPlay_SoundOn,e&&t.mediaId&&(this._wrapJWPlayerWithCLS(e,t.mediaId),this._playersAddedFromPlugin.push(t.mediaId))},i.prototype._createStickyRelatedPlayer=function(t,e){if(this._device,P.Video_Individual_Autoplay_SOff,this._stickyRelatedOnPage=!0,this._videoConfig.mobileStickyPlayerOnPage="mobile"===this._device,e&&t.position&&t.mediaId){var n=document.createElement("div");e.insertAdjacentElement(t.position,n);var i=document.createElement("h3");i.style.margin="10px 0";var o=this._getTitleHeight(i);this._wrapJWPlayerWithCLS(n,t.mediaId,this._WRAPPER_BAR_HEIGHT+o),this._playersAddedFromPlugin.push(t.mediaId)}},i.prototype._createSekindoPlayer=function(t,e){var i=t.playlistId;n(n({},t),{classNames:[]});var o="mobile"===this._device?{width:340,height:260}:{width:320,height:250},r=this._createSekindoCLSWrapper(o.height,i);e.insertAdjacentElement(t.position,r),this._playersAddedFromPlugin.push(i)},i.prototype._createPlaylistPlayer=function(t,e){var n=t.playlistId;this._videoConfig.mobileStickyPlayerOnPage=!0;var i=document.createElement("div");e.insertAdjacentElement(t.position,i),this._wrapJWPlayerWithCLS(i,n,this._WRAPPER_BAR_HEIGHT),this._playersAddedFromPlugin.push("playlist-".concat(n))},i.prototype._isVideoAllowedOnPage=function(){var t=this._clsOptions.disableAds;return t&&t.video?(t.reasons.has("video_tag")||t.reasons.has("video_plugin")||t.reasons.has("video_page"),!1):!this._clsOptions.videoDisabledFromPlugin},i}(function(t){function i(e,n,i){var o=t.call(this)||this;o._videoConfig=e,o._component=i,o._stickyRelatedOnPage=!1,o._contextualMediaIds=[];var r=o._videoConfig.players||[];o._device=/Windows NT|Macintosh/i.test(navigator.userAgent)?"desktop":"mobile",o._potentialPlayerMap=o._setPotentialPlayerMap(n);var a=r.filter((function(t){return"stationaryRelated"===t.type&&t.enabled}));return o._potentialPlayerMap.stationaryRelated=a,o}return e(i,t),i.prototype._setPotentialPlayerMap=function(t){var e=this,n=this._videoConfig.players,i={stickyRelated:[],stickyPlaylist:[],sekindo:[],stationaryRelated:[]};return n&&n.length?n.filter((function(t){var n;return(null===(n=t.devices)||void 0===n?void 0:n.indexOf(e._device))>-1})).reduce((function(n,i){return n[i.type]||(f.event(e._component,"constructor","Unknown Video Player Type detected",i.type),n[i.type]=[]),i.enabled&&(t&&"sekindo"===i.type||n[i.type].push(i)),n}),i):i},i.prototype._checkPlayerSelectorOnPage=function(t){var e=this,n=this._potentialPlayerMap[t].map((function(t){return{player:t,playerElement:e._getPlacementElement(t)}}));return n.length?n[0]:{player:null,playerElement:null}},i.prototype._getOverrideElement=function(t,e,n){if(t&&e){var i=document.createElement("div");e.insertAdjacentElement(t.position,i),n=i}else{var o=this._checkPlayerSelectorOnPage("stickyPlaylist"),r=o.player,a=o.playerElement;if(r&&a){i=document.createElement("div");a.insertAdjacentElement(r.position,i),n=i}}return n},i.prototype._shouldOverrideElement=function(t){var e=t.getAttribute("override-embed");return"true"===e||"false"===e?"true"===e:!!this._videoConfig.contextualSettings&&this._videoConfig.contextualSettings.overrideEmbedLocation},i.prototype._getPlacementElement=function(t){var e=d(t.pageSelector),n=u(t.elementSelector);return e.valid?t.pageSelector&&!e.elements.length?(f.event("VideoUtils","getPlacementElement",new Error("PSNF: ".concat(t.pageSelector," does not exist on the page"))),null):n.valid?n.elements.length>t.skip?n.elements[t.skip]:(f.event("VideoUtils","getPlacementElement",new Error("ESNF: ".concat(t.elementSelector," does not exist on the page"))),null):null:null},i.prototype._getEmbeddedPlayerType=function(t){var e=t.getAttribute("data-player-type");return e&&"default"!==e||(e=this._videoConfig.contextualSettings?this._videoConfig.contextualSettings.defaultPlayerType:"static"),this._stickyRelatedOnPage&&(e="static"),e},i.prototype._getUnusedMediaId=function(t){var e=t.getAttribute("data-video-id");return!(!e||-1!==this._contextualMediaIds.indexOf(e))&&(this._contextualMediaIds.push(e),e)},i.prototype._createRelatedPlayer=function(t,e,n){"collapse"===e?this._createCollapsePlayer(t,n):"static"===e&&this._createStaticPlayer(t,n)},i.prototype._createCollapsePlayer=function(t,e){var i=this._checkPlayerSelectorOnPage("stickyRelated"),o=i.player,r=i.playerElement,a=o||this._potentialPlayerMap.stationaryRelated[0];a&&a.playerId&&(this._shouldOverrideElement(e)&&(e=this._getOverrideElement(o,r,e)),e=document.querySelector("#cls-video-container-".concat(t," > div"))||e,this._createStickyRelatedPlayer(n(n({},a),{mediaId:t}),e))},i.prototype._createStaticPlayer=function(t,e){if(this._potentialPlayerMap.stationaryRelated.length&&this._potentialPlayerMap.stationaryRelated[0].playerId){var i=this._potentialPlayerMap.stationaryRelated[0];this._createStationaryRelatedPlayer(n(n({},i),{mediaId:t}),e)}},i.prototype._shouldRunAutoplayPlayers=function(){return!(!this._isVideoAllowedOnPage()||!(this._potentialPlayerMap.stickyRelated.length||this._potentialPlayerMap.stickyPlaylist.length||this._potentialPlayerMap.sekindo.length))},i.prototype._determineAutoplayPlayers=function(){var t=this._component,e="VideoManagerComponent"===t,n=this._config;if(this._stickyRelatedOnPage)f.event(t,"stickyRelatedOnPage",e&&{device:n&&n.context.device,isDesktop:this._device}||{});else{var i=this._checkPlayerSelectorOnPage("stickyPlaylist"),o=i.player,r=i.playerElement,a=this._checkPlayerSelectorOnPage("sekindo"),l=a.player,s=a.playerElement;o&&o.playerId&&o.playlistId&&r?this._createPlaylistPlayer(o,r):l&&l.playlistId&&s?this._createSekindoPlayer(l,s):f.event(t,"noStickyPlaylistOrSekindo",e&&{vendor:"none",device:n&&n.context.device,isDesktop:this._device}||{})}},i.prototype._initializeRelatedPlayers=function(t){for(var e=0;e<t.length;e++){var n=t[e],i=this._getEmbeddedPlayerType(n),o=this._getUnusedMediaId(n);o&&this._createRelatedPlayer(o,i,n)}},i}(function(){function t(){}return Object.defineProperty(t.prototype,"enabled",{get:function(){return!0},enumerable:!1,configurable:!0}),t}()));(M=new p)&&M.enabled&&(new x(M,new m).start(),new j(new v(M),M).init())}();
</script><script type="text/javascript">(function () {var clsElements = document.querySelectorAll("script[id^='cls-']"); window.adthriveCLS && clsElements && clsElements.length === 0 ? window.adthriveCLS.injectedFromPlugin = false : ""; })();</script><script>window.advanced_ads_check_adblocker=function(t){var n=[],e=null;function i(t){(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return setTimeout(t,16)}).call(window,t)}return i((function(){var t=document.createElement("div");t.innerHTML="&nbsp;",t.setAttribute("class","ad_unit ad-unit text-ad text_ad pub_300x250"),t.setAttribute("style","width: 1px !important; height: 1px !important; position: absolute !important; left: 0px !important; top: 0px !important; overflow: hidden !important;"),document.body.appendChild(t),i((function(){var i=window.getComputedStyle&&window.getComputedStyle(t),o=i&&i.getPropertyValue("-moz-binding");e=i&&"none"===i.getPropertyValue("display")||"string"==typeof o&&-1!==o.indexOf("about:");for(var a=0,r=n.length;a<r;a++)n[a](e);n=[]}))})),function(t){null!==e?t(e):n.push(t)}}();</script><!-- Drip -->
<script data-cfasync="false" type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/comment-reply.js" id="comment-reply-js" defer="defer"></script>
<script data-minify="1" type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/tex-chtml.js" id="mathjax-js" defer="defer"></script>
<script type="text/javascript" id="rocket-browser-checker-js-after">
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var RocketBrowserCompatibilityChecker=function(){function RocketBrowserCompatibilityChecker(options){_classCallCheck(this,RocketBrowserCompatibilityChecker),this.passiveSupported=!1,this._checkPassiveOption(this),this.options=!!this.passiveSupported&&options}return _createClass(RocketBrowserCompatibilityChecker,[{key:"_checkPassiveOption",value:function(self){try{var options={get passive(){return!(self.passiveSupported=!0)}};window.addEventListener("test",null,options),window.removeEventListener("test",null,options)}catch(err){self.passiveSupported=!1}}},{key:"initRequestIdleCallback",value:function(){!1 in window&&(window.requestIdleCallback=function(cb){var start=Date.now();return setTimeout(function(){cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})},1)}),!1 in window&&(window.cancelIdleCallback=function(id){return clearTimeout(id)})}},{key:"isDataSaverModeOn",value:function(){return"connection"in navigator&&!0===navigator.connection.saveData}},{key:"supportsLinkPrefetch",value:function(){var elem=document.createElement("link");return elem.relList&&elem.relList.supports&&elem.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype}},{key:"isSlowConnection",value:function(){return"connection"in navigator&&"effectiveType"in navigator.connection&&("2g"===navigator.connection.effectiveType||"slow-2g"===navigator.connection.effectiveType)}}]),RocketBrowserCompatibilityChecker}();
</script>
<script type="text/javascript" id="rocket-preload-links-js-extra">
/* <![CDATA[ */
var RocketPreloadLinksConfig = {"excludeUris":"\/register\/machine-learning-university\/|\/courses\/\/lessons\/holding-back-goals\/|\/courses\/course-get-started\/|\/courses\/course-get-started\/lessons\/holding-back-goals\/|\/courses\/course-get-started\/lessons\/why-machine-learning-does-not-have-to-be-so-hard\/|\/courses\/course-get-started\/lessons\/how-to-think-about-machine-learning\/|\/courses\/course-get-started\/lessons\/find-your-machine-learning-tribe\/|\/courses\/step-by-step-process\/|\/courses\/probability-for-machine-learning\/|\/account\/|\/register\/|\/courses\/|\/machine-learning-mastery-university-registration\/|\/register\/|\/newsletter\/|\/(?:.+\/)?feed(?:\/(?:.+\/?)?)?$|\/(?:.+\/)?embed\/|\/(index\\.php\/)?wp\\-json(\/.*|$)|\/wp-admin\/|\/logout\/|\/wp-login.php|\/refer\/|\/go\/|\/recommend\/|\/recommends\/","usesTrailingSlash":"1","imageExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|pdf|doc|docx|xls|xlsx|php","fileExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|pdf|doc|docx|xls|xlsx|php|html|htm","siteUrl":"https:\/\/machinelearningmastery.com","onHoverDelay":"100","rateThrottle":"3"};
/* ]]> */
</script>
<script type="text/javascript" id="rocket-preload-links-js-after">
(function() {
"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function n(e,t){i(this,n),this.browser=e,this.config=t,this.options=this.browser.options,this.prefetched=new Set,this.eventTime=null,this.threshold=1111,this.numOnHover=0}return e(n,[{key:"init",value:function(){!this.browser.supportsLinkPrefetch()||this.browser.isDataSaverModeOn()||this.browser.isSlowConnection()||(this.regex={excludeUris:RegExp(this.config.excludeUris,"i"),images:RegExp(".("+this.config.imageExt+")$","i"),fileExt:RegExp(".("+this.config.fileExt+")$","i")},this._initListeners(this))}},{key:"_initListeners",value:function(e){-1<this.config.onHoverDelay&&document.addEventListener("mouseover",e.listener.bind(e),e.listenerOptions),document.addEventListener("mousedown",e.listener.bind(e),e.listenerOptions),document.addEventListener("touchstart",e.listener.bind(e),e.listenerOptions)}},{key:"listener",value:function(e){var t=e.target.closest("a"),n=this._prepareUrl(t);if(null!==n)switch(e.type){case"mousedown":case"touchstart":this._addPrefetchLink(n);break;case"mouseover":this._earlyPrefetch(t,n,"mouseout")}}},{key:"_earlyPrefetch",value:function(t,e,n){var i=this,r=setTimeout(function(){if(r=null,0===i.numOnHover)setTimeout(function(){return i.numOnHover=0},1e3);else if(i.numOnHover>i.config.rateThrottle)return;i.numOnHover++,i._addPrefetchLink(e)},this.config.onHoverDelay);t.addEventListener(n,function e(){t.removeEventListener(n,e,{passive:!0}),null!==r&&(clearTimeout(r),r=null)},{passive:!0})}},{key:"_addPrefetchLink",value:function(i){return this.prefetched.add(i.href),new Promise(function(e,t){var n=document.createElement("link");n.rel="prefetch",n.href=i.href,n.onload=e,n.onerror=t,document.head.appendChild(n)}).catch(function(){})}},{key:"_prepareUrl",value:function(e){if(null===e||"object"!==(void 0===e?"undefined":r(e))||!1 in e||-1===["http:","https:"].indexOf(e.protocol))return null;var t=e.href.substring(0,this.config.siteUrl.length),n=this._getPathname(e.href,t),i={original:e.href,protocol:e.protocol,origin:t,pathname:n,href:t+n};return this._isLinkOk(i)?i:null}},{key:"_getPathname",value:function(e,t){var n=t?e.substring(this.config.siteUrl.length):e;return n.startsWith("/")||(n="/"+n),this._shouldAddTrailingSlash(n)?n+"/":n}},{key:"_shouldAddTrailingSlash",value:function(e){return this.config.usesTrailingSlash&&!e.endsWith("/")&&!this.regex.fileExt.test(e)}},{key:"_isLinkOk",value:function(e){return null!==e&&"object"===(void 0===e?"undefined":r(e))&&(!this.prefetched.has(e.href)&&e.origin===this.config.siteUrl&&-1===e.href.indexOf("?")&&-1===e.href.indexOf("#")&&!this.regex.excludeUris.test(e.href)&&!this.regex.images.test(e.href))}}],[{key:"run",value:function(){"undefined"!=typeof RocketPreloadLinksConfig&&new n(new RocketBrowserCompatibilityChecker({capture:!0,passive:!0}),RocketPreloadLinksConfig).init()}}]),n}();t.run();
}());
</script>
<script data-minify="1" type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/4.js" id="advanced-ads-pro/front-js"></script>
<script type="text/javascript" id="q2w3_fixed_widget-js-extra">
/* <![CDATA[ */
var q2w3_sidebar_options = [{"sidebar":"primary","use_sticky_position":false,"margin_top":10,"margin_bottom":0,"stop_elements_selectors":"","screen_max_width":400,"screen_max_height":0,"widgets":["#custom_html-89","#custom_html-50","#custom_html-90","#custom_html-100","#custom_html-91","#custom_html-58","#custom_html-60","#custom_html-59","#custom_html-84","#custom_html-51","#custom_html-56","#custom_html-55","#custom_html-57","#custom_html-53","#custom_html-54","#custom_html-52","#custom_html-48","#custom_html-49","#custom_html-80","#custom_html-47","#custom_html-85","#custom_html-105","#custom_html-104","#custom_html-30","#custom_html-29","#custom_html-28","#custom_html-27","#custom_html-3","#custom_html-24","#custom_html-23","#custom_html-22","#custom_html-21","#custom_html-107","#custom_html-101","#custom_html-20","#custom_html-19","#custom_html-18","#custom_html-17","#custom_html-16","#custom_html-15","#custom_html-14","#custom_html-13","#custom_html-11","#custom_html-10","#custom_html-5","#custom_html-9","#custom_html-61","#custom_html-81","#custom_html-86","#custom_html-92","#custom_html-97"]}];
/* ]]> */
</script>
<script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/frontend.js" id="q2w3_fixed_widget-js" defer="defer"></script>
<script type="text/javascript" id="advanced-ads-pro/cache_busting-js-extra">
/* <![CDATA[ */
var advanced_ads_pro_ajax_object = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","lazy_load_module_enabled":"","lazy_load":{"default_offset":0,"offsets":[]},"moveintohidden":"","wp_timezone_offset":"36000"};
/* ]]> */
</script>
<script data-minify="1" type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/577.js" id="advanced-ads-pro/cache_busting-js"></script>
<script type="text/javascript" id="advadsTrackingScript-js-extra">
/* <![CDATA[ */
var advadsTracking = {"impressionActionName":"aatrack-records","clickActionName":"aatrack-click","targetClass":"machi-target","blogId":"1"};
/* ]]> */
</script>
<script data-minify="1" type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/437.js" id="advadsTrackingScript-js"></script>
<script type="text/javascript" id="advadsTrackingGAFront-js-extra">
/* <![CDATA[ */
var advadsGALocale = {"Impressions":"Impressions","Clicks":"Clicks"};
/* ]]> */
</script>
<script data-minify="1" type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/512.js" id="advadsTrackingGAFront-js"></script>
<!--noptimize--><script>window.advads_admin_bar_items = [{"title":"Header","type":"placement"}];</script><!--/noptimize--><!--noptimize--><script type="text/javascript">window.advads_ajax_queries = [{"id":"right-sidebar","method":"placement","params":{"previous_method":"placement","previous_id":"right-sidebar","post":"r0","url_parameter":"\/practical-guide-to-gan-failure-modes\/","placement_type":"default","inline-css":"","placement_conditions":{"visitors":[{"type":"mobile","operator":"is_not"}]},"cache-busting":"auto","output":{"class":["machi-right-sidebar"],"placement_id":"right-sidebar"}},"elementid":"machi-0cef8d8338947f6c57de13c9d0da625a","blog_id":1}];
window.advads_ajax_queries_args = {"r0":{"id":8173,"author":"1","post_type":"post"}};
( window.advanced_ads_ready || jQuery( document ).ready ).call( null, function() {if ( !window.advanced_ads_pro ) {console.log("Advanced Ads Pro: cache-busting can not be initialized");} });</script><!--/noptimize--><script type="text/javascript">function initTwitCount(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://static1.twitcount.com/js/twitcount.js';fjs.parentNode.insertBefore(js,fjs)}}
        var ssb_twit_count_init=!1;addEventListener('mouseover',function(event){if(!ssb_twit_count_init){initTwitCount(document,'script','twitcount_plugins')
        ssb_twit_count_init=!0}})</script><!--noptimize--><script type="text/javascript">!function(){window.advanced_ads_ready_queue=window.advanced_ads_ready_queue||[],advanced_ads_ready_queue.push=window.advanced_ads_ready;for(var d=0,a=advanced_ads_ready_queue.length;d<a;d++)advanced_ads_ready(advanced_ads_ready_queue[d])}();</script><!--/noptimize--><script>!function(){"use strict";!function(e){if(-1===e.cookie.indexOf("__adblocker")){e.cookie="__adblocker=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/";var t=new XMLHttpRequest;t.open("GET","https://www.npttech.com/advertising.js",!0),t.onreadystatechange=function(){if(XMLHttpRequest.DONE===t.readyState)if(200===t.status){var n=e.createElement("script");n.innerHTML=t.responseText,e.getElementsByTagName("head")[0].appendChild(n)}else{var a=new Date;a.setTime(a.getTime()+3e5),e.cookie="__adblocker=true; expires="+a.toUTCString()+"; path=/"}},t.send()}}(document)}();
</script><script id="machi-tracking" type="text/javascript">var advads_tracking_ads = {};var advads_tracking_urls = {"1":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php"};var advads_tracking_methods = {"1":"ga"};var advads_tracking_parallel = {"1":false};var advads_tracking_linkbases = {"1":"https:\/\/machinelearningmastery.com\/linkout\/"};var advads_gatracking_uids = {"1":"UA-44039733-3"};var advads_gatracking_allads = {"1":{"13588":{"title":"Adsense 300 Backfill","target":"","impression":true,"click":true},"13577":{"title":"mlm-s1-sigopt-2205-b","target":"https:\/\/sigopt.com\/signup?utm_source=mlm&utm_medium=display&utm_campaign=mlm-try-sigopt&utm_content=experiment-design","impression":true,"click":true},"13576":{"title":"mlm-s1-sigopt-2205-a","target":"https:\/\/sigopt.com\/signup?utm_source=mlm&utm_medium=display&utm_campaign=mlm-try-sigopt&utm_content=anchor-mlops","impression":true,"click":true},"13572":{"title":"Test 300","target":"","impression":true,"click":true}}};var advads_gatracking_anonym = false;var advads_gatracking_transmitpageqs = {};</script><script>!function(){"use strict";var e;e=document,function(){var t,n;function r(){var t=e.createElement("script");t.src="https://cafemedia-com.videoplayerhub.com/galleryplayer.js",e.head.appendChild(t)}function a(){var t=e.cookie.match("(^|[^;]+)\\s*__adblocker\\s*=\\s*([^;]+)");return t&&t.pop()}function c(){clearInterval(n)}return{init:function(){var e;"true"===(t=a())?r():(e=0,n=setInterval((function(){100!==e&&"false"!==t||c(),"true"===t&&(r(),c()),t=a(),e++}),50))}}}().init()}();
</script><script type="text/javascript">window.lazyLoadOptions={elements_selector:"iframe[data-lazy-src]",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}};window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(var i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){continue}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){continue}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script async="" data-no-minify="1" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/lazyload.js" type="text/javascript"></script>

<script src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/js.js" async=""></script><div class="ad_unit ad-unit text-ad text_ad pub_300x250" style="width: 1px !important; height: 1px !important; position: absolute !important; left: 0px !important; top: 0px !important; overflow: hidden !important;">&nbsp;</div><div class="drip-tab-container">
  <div id="drip-2211" class="drip-tab bottom right no-image classic">
    <div id="drip-header-2211" class="drip-header drip-hidden">
      <a href="#" id="drip-toggle-2211" class="drip-toggle">
        <h2 id="drip-teaser-2211">Start Machine Learning</h2>
        <span id="drip-tab-up-2211" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-2211" class="drip-arrow down" style="display: none"></span>
      </a>
    </div>

    <div id="drip-content-2211" class="drip-content drip-clearfix" style="height: auto; bottom: 0px;">
      <div id="drip-form-panel-2211" class="drip-panel" style="display: block;">
        <a id="drip-close-2211" class="drip-close">×</a>
        <h3 id="drip-content-header-2211">Start Machine Learning</h3>
        <div id="drip-scroll-2211" class="drip-scroll">
          <div class="drip-clearfix">
            <div class="drip-description">You can master applied Machine Learning&nbsp;<br>
<strong>without math or fancy degrees</strong>.<br>
Find out how in this <em>free</em>&nbsp;and <em>practical</em>&nbsp;course.</div>
          </div>
          <form id="drip-form-2211">
            <div style="display: none">
              <input type="hidden" name="form_id" value="2211">
              
            </div>
            <dl class="no-labels">
                  <dt class="label-for-type-email">
    Email Address
      <span title="Required"> *</span>
  </dt>
  <dd>
    <input type="email" name="fields[email]" placeholder="Email Address" class="drip-text-field" id="drip-email-field-2211" tabindex="0">
<div id="drip-errors-for-email-2211" class="drip-errors"></div>

  </dd>

                  <dt class="label-for-type-eu_consent">
    
  </dt>
  <dd>
      <div class="classic--checkbox show" data-container="eu-checkbox">
    <input type="hidden" name="fields[eu_consent]" id="drip-field-eu_consent-2211-denied" value="denied" disabled="disabled">
    <input type="checkbox" name="fields[eu_consent]" id="drip-field-eu_consent-2211" value="granted" disabled="disabled">
    <label for="drip-field-eu_consent-2211">I consent to receive information about services and special offers by email. For more information, see the <a href="https://machinelearningmastery.com/privacy/">Privacy Policy</a>.</label>
  </div>

  </dd>

                <input type="hidden" name="fields[eu_consent_message]" value="I consent to receive information about services and special offers by email. For more information, see the Privacy Policy (https://machinelearningmastery.com/privacy/)." tabindex="-1">

              <div style="display: none;" aria-hidden="true">
  <dt for="website">Website</dt>
  <dd>
    <input type="text" id="website" name="website" placeholder="Website" class="drip-text-field" tabindex="-1" autocomplete="false">
  </dd>
</div>

            </dl>
            <div class="form-controls">
              <input type="submit" name="submit" value="Start My Email Course" id="drip-submit-2211" class="drip-submit-button">
            </div>
            <div id="drip-errors-for-base-2211" class="drip-errors dfwid-error"></div>

          </form>
        </div>
      </div>

      <div id="drip-success-panel-2211" class="drip-success drip-panel drip-clearfix drip-form-success-message" style="display: none">
        <a id="drip-hide-2211" class="drip-close">×</a>
        <h3>Thank you for signing up!</h3>
        <p class="drip-description">Please check your email and click the link provided to confirm your subscription.</p>
      </div>
    </div>
  </div>
</div><div class="lp-popup__iframe-wrapper" style="width: 100%;
  height: 100%;
  position: fixed;
  display: none;
  right: 0;
  bottom: 0;
  left: 0;
  top: 0;
  z-index: 999999999;
  box-sizing: border-box;"><iframe class="lp-popup__iframe" scrolling="no" style="width: 100%;
  height: 100%;
  border: none;
  margin: 0;
  padding: 0;" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a_007.html" data-leadbox-frame-id="Hu8QegaSVPUonXe7k9JFu6" data-leadbox-frame-params-key="NO_PARAMS_20160921"></iframe></div><div class="lp-popup__iframe-wrapper" style="width: 100%;
  height: 100%;
  position: fixed;
  display: none;
  right: 0;
  bottom: 0;
  left: 0;
  top: 0;
  z-index: 999999999;
  box-sizing: border-box;"><iframe class="lp-popup__iframe" scrolling="no" style="width: 100%;
  height: 100%;
  border: none;
  margin: 0;
  padding: 0;" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/a_008.html" data-leadbox-frame-id="gccVwqnxKjFwG4uJPQpXwM" data-leadbox-frame-params-key="NO_PARAMS_20160921"></iframe></div><iframe style="display: none;" id="__uspapiLocator" name="__uspapiLocator"></iframe><iframe src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/syncframe.html" style="border-width: 0px; margin: 0px; display: none;" title="Criteo GUM iframe" width="0" height="0" frameborder="0"></iframe><div id="confiant_tag_holder" style="display:none"></div><script type="text/javascript" async="true" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/65568.js"></script><iframe src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/container.html" style="visibility: hidden; display: none;"></iframe><iframe src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/aframe.html" style="display: none;" width="0" height="0"></iframe><iframe src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/tag.html" style="display: none;" width="0" height="0" frameborder="0"></iframe><script type="text/javascript" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/pandg-sdk.js"></script><iframe scrolling="no" allowtransparency="true" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/widget_iframe.html" title="Twitter settings iframe" style="display: none;" frameborder="0"></iframe><iframe id="rufous-sandbox" scrolling="no" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: medium none;" title="Twitter analytics iframe" frameborder="0"></iframe></body><iframe sandbox="allow-scripts allow-same-origin" id="1562f0926a89ed4f8" allowtransparency="true" marginheight="0" marginwidth="0" hspace="0" vspace="0" style="height:0px;width:0px;display:none;" scrolling="no" src="https://eb2.3lift.com/sync?gdpr=&amp;cmp_cs=&amp;us_privacy=1---&amp;redir=https%3A%2F%2Fprebid-server.rubiconproject.com%2Fsetuid%3Fbidder%3Dtriplelift%26gdpr%3D%26gdpr_consent%3D%26us_privacy%3D1---%26f%3Db%26uid%3D%24UID" width="0" height="0" frameborder="0">
    </iframe><iframe sandbox="allow-scripts allow-same-origin" id="15717d764bbacf0c8" allowtransparency="true" marginheight="0" marginwidth="0" hspace="0" vspace="0" style="height:0px;width:0px;display:none;" scrolling="no" src="How%20to%20Identify%20and%20Diagnose%20GAN%20Failure%20Modes_files/user_sync.html" width="0" height="0" frameborder="0">
    </iframe><iframe sandbox="allow-scripts allow-same-origin" id="159348b5ac5530ac" allowtransparency="true" marginheight="0" marginwidth="0" hspace="0" vspace="0" style="height:0px;width:0px;display:none;" scrolling="no" src="https://ssc-cms.33across.com/ps/?m=xch&amp;rt=html&amp;gdpr=&amp;gdpr_consent=&amp;us_privacy=1---&amp;id=zzz000000000002zzz&amp;ru=https%3A%2F%2Fprebid-server.rubiconproject.com%2Fsetuid%3Fbidder%3D33across%26gdpr%3D%26gdpr_consent%3D%26us_privacy%3D1---%26f%3Db%26uid%3D33XUSERID33X" width="0" height="0" frameborder="0">
    </iframe></html>
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me -->